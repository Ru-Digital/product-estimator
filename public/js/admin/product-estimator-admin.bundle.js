(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function r(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,a,o,r,s=[],d=!0,l=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;d=!1}else for(;!(d=(n=o.call(i)).done)&&(s.push(n.value),s.length!==e);d=!0);}catch(t){l=!0,a=t}finally{try{if(!d&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(l)throw a}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e,i){return(e=a(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}t.r(e),t.d(e,{clearFieldError:()=>T,showFieldError:()=>E,showNotice:()=>k,validateEmail:()=>w,validateForm:()=>P,validateNumber:()=>_,validateRequired:()=>S});var c=!1;function u(){var t,e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!c&&null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug?(i?console.groupCollapsed("[ProductEstimator] Logs"):console.group("[ProductEstimator] Logs"),c=!0):null!==(e=window.productEstimatorVars)&&void 0!==e&&e.debug}function g(t){var e="[".concat(t,"]");return{log:function(){var t;if(null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug){var i;u();for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];(i=console).log.apply(i,[e].concat(a)),window.debug&&window.debug.trace&&console.trace()}},warn:function(){var t;if(null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug){var i;u();for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];(i=console).warn.apply(i,[e].concat(a)),window.debug&&window.debug.trace&&console.trace()}},error:function(){var t;if(null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug){var i;u(!1);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];(i=console).error.apply(i,[e].concat(a)),window.debug&&window.debug.trace&&console.trace()}},group:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Details",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug){u();var a="".concat(e," ").concat(i);n?console.groupCollapsed(a):console.group(a)}},groupEnd:function(){var t;null!==(t=window.productEstimatorVars)&&void 0!==t&&t.debug&&c&&console.groupEnd()}}}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var m=g("UtilsAjax");function p(t){var e,i=jQuery,n=f(f({},{url:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.ajax_url)||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),type:"POST",dataType:"json"}),t);return new Promise((function(t,e){i.ajax(f(f({},n),{},{success:function(i){if(i.success)t(i.data);else{var n,a=new Error((null===(n=i.data)||void 0===n?void 0:n.message)||"Unknown error");a.data=i.data,e(a)}},error:function(t,i,n){m.error("AJAX error:",i,n),e(new Error(n))}}))}))}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=document.createElement(t);return Object.entries(e).forEach((function(t){var e=d(t,2),i=e[0],o=e[1];"className"===i?a.className=o:"dataset"===i?Object.entries(o).forEach((function(t){var e=d(t,2),i=e[0],n=e[1];a.dataset[i]=n})):"style"===i&&"object"===n(o)?Object.entries(o).forEach((function(t){var e=d(t,2),i=e[0],n=e[1];a.style[i]=n})):a.setAttribute(i,o)})),"string"==typeof i?a.textContent=i:Array.isArray(i)&&i.forEach((function(t){"string"==typeof t?a.appendChild(document.createTextNode(t)):t instanceof Node&&a.appendChild(t)})),a}function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function w(t){return!!t&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())}function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.min,n=e.max,a=e.integer,o=void 0!==a&&a,r="string"==typeof t?parseFloat(t):t;return!(isNaN(r)||o&&!Number.isInteger(r)||void 0!==i&&r<i||void 0!==n&&r>n)}function S(t){return null!=t&&("string"==typeof t?""!==t.trim():!Array.isArray(t)||t.length>0)}function E(t,e){var i=jQuery;if(t){var n=t instanceof jQuery?t:i(t);T(n);var a=i('<span class="field-error">'.concat(e,"</span>"));n.after(a),n.addClass("error")}}function T(t){var e=jQuery;if(t){var i=t instanceof jQuery?t:e(t);i.next(".field-error").remove(),i.removeClass("error")}}function k(t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,i=jQuery;if(i){for(var n=i('<div class="notice notice-'.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",' is-dismissible"><p>').concat(t,"</p></div>")),a=[i(".wrap h1"),i(".product-estimator-form-container"),i("#wpbody-content")],o=null,r=0;r<a.length;r++)if(a[r].length){o=a[r];break}if(o?o.after(n):i("body").prepend(n),window.wp&&window.wp.notices)window.wp.notices.init();else{var s=i('<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button>');n.append(s),s.on("click",(function(){n.fadeOut(100,(function(){n.remove()}))}))}setTimeout((function(){n.fadeOut(500,(function(){return n.remove()}))}),e)}else alert(t)}function P(t,e){var i=jQuery,n=t instanceof jQuery?t:i(t),a=!0;return Object.entries(e).forEach((function(t){var e=d(t,2),i=e[0],o=e[1],r=n.find(i);if(r.length){var s=o(r.val(),r);s.valid?T(r):(E(r,s.message),a=!1)}})),a}g("UtilsDom");var C=function(t){var e;if(null!==(e=window.productEstimatorVars)&&void 0!==e&&e.debug){var i;u();for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];(i=console).log.apply(i,["[".concat(t,"]")].concat(a))}},j=g,I=w,x=E,F=T,D=j("CustomerEstimatesAdmin"),M=function(){return r((function t(){var e,n,a,o=this;i(this,t),this.settings={ajaxUrl:(null===(e=window.customerEstimatesAdmin)||void 0===e?void 0:e.ajax_url)||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:(null===(n=window.customerEstimatesAdmin)||void 0===n?void 0:n.nonce)||"",i18n:(null===(a=window.customerEstimatesAdmin)||void 0===a?void 0:a.i18n)||{}},jQuery(document).ready((function(){return o.init()}))}),[{key:"init",value:function(){this.bindEvents(),this.initializeActions(),D.log("Initialized")}},{key:"bindEvents",value:function(){var t=this,e=jQuery;e("#doaction, #doaction2").on("click",this.handleBulkAction.bind(this)),e(".email-estimate").on("click",this.handleEmailEstimate.bind(this)),e('select[name="status_filter"]').on("change",(function(){e(this).closest("form").submit()})),e(".wp-list-table tbody tr").hover((function(){e(this).addClass("row-hover")}),(function(){e(this).removeClass("row-hover")})),"function"==typeof e.fn.tooltip&&e(".tooltip-trigger").tooltip(),e("#export-estimates-btn").on("click",this.exportEstimates.bind(this)),e(".print-estimate-btn").on("click",(function(i){i.preventDefault();var n=e(i.currentTarget).data("estimate-id");n&&t.printEstimate(n)}))}},{key:"initializeActions",value:function(){this.addResponsiveTableLabels(),this.handleSearchField(),this.handleAdminNotices()}},{key:"handleBulkAction",value:function(t){var e=jQuery;if("delete"===e(t.target).prev("select").val()){if(0===e('tbody th.check-column input[type="checkbox"]:checked').length)return t.preventDefault(),alert("Please select at least one estimate to delete."),!1;if(!confirm(this.settings.i18n.confirmBulkDelete))return t.preventDefault(),!1}}},{key:"handleEmailEstimate",value:function(t){var e=this;t.preventDefault();var i=jQuery(t.currentTarget),n=i.data("estimate-id"),a=i.text();i.text(this.settings.i18n.emailSending).prop("disabled",!0),p({url:this.settings.ajaxUrl,data:{action:"email_estimate",estimate_id:n,nonce:this.settings.nonce}}).then((function(t){k(e.settings.i18n.emailSuccess,"success")})).catch((function(t){var i;k(e.settings.i18n.emailError+(null!==(i=t.data)&&void 0!==i&&i.message?": "+t.data.message:""),"error")})).finally((function(){i.text(a).prop("disabled",!1)}))}},{key:"addResponsiveTableLabels",value:function(){var t=jQuery;t(window).width()<=782&&t(".wp-list-table td").each((function(){var e=t(this),i=e.closest("table").find("th").eq(e.index());i.length&&e.attr("data-label",i.text())}))}},{key:"handleSearchField",value:function(){var t=jQuery("#estimate-search-input");t.length&&!t.val()&&t.focus()}},{key:"handleAdminNotices",value:function(){var t=new URLSearchParams(window.location.search).get("message");if(t){var e="",i="success";switch(t){case"email_sent":e="Email sent successfully!";break;case"email_failed":e="Failed to send email.",i="error";break;case"deleted":e="Estimate deleted successfully!";break;case"delete_failed":e="Failed to delete estimate.",i="error";break;case"duplicated":e="Estimate duplicated successfully!";break;case"duplicate_failed":e="Failed to duplicate estimate.",i="error"}e&&k(e,i)}}},{key:"showNotice",value:function(t){k(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success")}},{key:"exportEstimates",value:function(){var t={},e=jQuery('select[name="status_filter"]').val(),i=jQuery("#estimate-search-input").val();e&&(t.status=e),i&&(t.search=i);var n=new URL(this.settings.ajaxUrl);for(var a in n.searchParams.append("action","export_estimates"),n.searchParams.append("nonce",this.settings.nonce),t)n.searchParams.append(a,t[a]);window.location.href=n.toString()}},{key:"printEstimate",value:function(t){jQuery;var e=window.open("","_blank");e.document.write("<html><head><title>Printing Estimate...</title></head>"),e.document.write("<body><p>Loading estimate for printing...</p></body></html>"),p({url:this.settings.ajaxUrl,data:{action:"get_estimate_print_view",estimate_id:t,nonce:this.settings.nonce}}).then((function(t){e.document.write(t.html),e.document.close(),e.onload=function(){e.print()}})).catch((function(t){var i;e.document.write("<p>Error loading estimate: "+((null===(i=t.data)||void 0===i?void 0:i.message)||"Unknown error")+"</p>"),e.document.close()}))}},{key:"duplicateEstimate",value:function(t){var e=this;t&&confirm(this.settings.i18n.duplicateConfirm)&&function(t){var e,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.nonce)||"",r=new FormData;return r.append("action",t),r.append("nonce",o),Object.entries(a).forEach((function(t){var e=d(t,2),i=e[0],a=e[1];null!=a&&("object"===n(a)?r.append(i,JSON.stringify(a)):r.append(i,a))})),fetch((null===(i=window.productEstimatorVars)||void 0===i?void 0:i.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",credentials:"same-origin",body:r}).then((function(t){if(!t.ok)throw new Error("Network response was not ok: ".concat(t.status));return t.json()})).then((function(t){if(t.success)return t.data;var e,i=new Error((null===(e=t.data)||void 0===e?void 0:e.message)||"Unknown error");throw i.data=t.data,i}))}("duplicate_estimate",{estimate_id:t}).then((function(t){e.showNotice(t.message||"Estimate duplicated successfully!"),window.location.reload()})).catch((function(t){e.showNotice(t.message||"Failed to duplicate estimate","error")}))}},{key:"formatDate",value:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=y(y({},{year:"numeric",month:"short",day:"numeric"}),e),n="string"==typeof t?new Date(t):t;return isNaN(n.getTime())?"Invalid date":new Intl.DateTimeFormat(navigator.language,i).format(n)}(t,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}},{key:"formatPrice",value:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(null==t)return"".concat(e,"0.00");var n="string"==typeof t?parseFloat(t):t;return isNaN(n)?"".concat(e,"0.00"):e+n.toFixed(i)}(t,"$")}},{key:"truncateText",value:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return t?t.length<=e?t:t.substring(0,e-i.length)+i:""}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:50)}}])}();jQuery(document).ready((function(){var t=new M;window.CustomerEstimatesAdmin=t}));var A=j("ProductEstimatorAdmin");new(function(){return r((function t(){var e=this;i(this,t),jQuery(document).ready((function(){e.initializeVariables(),e.bindEvents(),e.isSettingsPage()||e.initializeTabs()}))}),[{key:"isSettingsPage",value:function(){var t=new URLSearchParams(window.location.search).get("page");return t&&t.indexOf("-settings")>-1}},{key:"initializeVariables",value:function(){this.formChanged=!1,this.currentTab="",this.reportData=null,this.chart=null}},{key:"bindEvents",value:function(){var t=jQuery;this.isSettingsPage()||t(".nav-tab-wrapper").on("click",".nav-tab",this.handleTabClick.bind(this)),this.initializeValidation(),t(window).on("beforeunload",this.handleBeforeUnload.bind(this))}},{key:"initializeTabs",value:function(){var t=jQuery,e=t(".nav-tab:first"),i=e.data("tab")||"tab-1";t(".tab-content").hide(),t("#".concat(i)).show(),e.addClass("nav-tab-active"),this.currentTab=i;var n=new URLSearchParams(window.location.search).get("tab");n&&this.switchTab(n)}},{key:"handleTabClick",value:function(t){t.preventDefault();var e=jQuery(t.currentTarget).data("tab");this.formChanged?confirm(productEstimatorAdmin.i18n.unsavedChanges)&&this.switchTab(e):this.switchTab(e)}},{key:"switchTab",value:function(t){var e=jQuery;e(".nav-tab").removeClass("nav-tab-active"),e('.nav-tab[data-tab="'.concat(t,'"]')).addClass("nav-tab-active"),e(".tab-content").hide(),e("#".concat(t)).show(),this.currentTab=t;var i=new URL(window.location);i.searchParams.set("tab",t),window.history.pushState({},"",i),"reports"!==t||this.reportData||this.loadInitialReport()}},{key:"initializeValidation",value:function(){if(!this.isSettingsPage()){var t=jQuery,e=t(".product-estimator-form");e.find('input[type="email"]').on("change",(function(e){var i=t(e.currentTarget),n=i.val();n&&!I(n)?x(i,productEstimatorAdmin.i18n.invalidEmail):F(i)})),e.find('input[type="number"]').on("change",(function(e){var i=t(e.currentTarget),n=parseInt(i.val()),a=parseInt(i.attr("min")),o=parseInt(i.attr("max"));n<a||n>o?x(i,productEstimatorAdmin.i18n.numberRange.replace("%min%",a).replace("%max%",o)):F(i)}))}}},{key:"handleBeforeUnload",value:function(t){if(this.formChanged)return t.preventDefault(),productEstimatorAdmin.i18n.unsavedChanges}},{key:"loadInitialReport",value:function(){A.log("Loading initial report data")}}])}());var N=function(){return r((function t(){i(this,t),this.formChanged=!1,this.currentTab="",this.formChangeTrackers={},this.ensureGlobalVariables(),this.init()}),[{key:"ensureGlobalVariables",value:function(){window.featureSwitchesSettings=window.featureSwitchesSettings||{tab_id:"feature_switches",i18n:{}},window.generalSettings=window.generalSettings||{tab_id:"general",i18n:{}},window.netsuiteSettings=window.netsuiteSettings||{tab_id:"netsuite",i18n:{}},window.notificationSettings=window.notificationSettings||{tab_id:"notifications",i18n:{}},window.pricingRulesSettings=window.pricingRulesSettings||{tab_id:"pricing_rules",i18n:{}},window.productAdditionsSettings=window.productAdditionsSettings||{tab_id:"product_additions",i18n:{}},window.productUpgradesSettings=window.productUpgradesSettings||{tab_id:"product_upgrades",i18n:{}},window.similarProductsSettings=window.similarProductsSettings||{tab_id:"similar_products",i18n:{}},window.labelSettings=window.labelSettings||{tab_id:"labels",i18n:{}},window.productEstimatorSettings=window.productEstimatorSettings||{ajax_url:"undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",nonce:"",i18n:{unsavedChanges:"You have unsaved changes. Are you sure you want to leave this tab?",saveSuccess:"Settings saved successfully.",saveError:"Error saving settings."}}}},{key:"init",value:function(){var t=this.getTabFromUrl();this.currentTab=null!==t?t:"general",jQuery(".tab-content").hide(),jQuery("#".concat(this.currentTab)).show(),jQuery(".nav-tab").removeClass("nav-tab-active"),jQuery('.nav-tab[data-tab="'.concat(this.currentTab,'"]')).addClass("nav-tab-active"),this.bindEvents(),this.initFormChangeTracking(),this.initializeValidation(),C("ProductEstimatorSettings","Settings manager initialized with tab:",this.currentTab)}},{key:"bindEvents",value:function(){var t=this,e=jQuery,i=window.createLogger?window.createLogger("ProductEstimatorSettings"):console;e(".nav-tab-wrapper").on("click",".nav-tab",this.handleTabClick.bind(this)),e(document).on("submit","form.product-estimator-form",(function(n){var a=e(n.currentTarget);a.hasClass("pe-vtabs-tab-form")&&a.attr("data-tab")?i.log("Generic handler (ProductEstimatorSettings.js): Form has .pe-vtabs-tab-form and data-tab. Letting VerticalTabbedModule handle it.",a[0]):(i.log("Generic handler (ProductEstimatorSettings.js): Processing form submission.",a[0]),n.preventDefault(),t.handleAjaxFormSubmit(n,a))})),e(window).on("beforeunload",this.handleBeforeUnload.bind(this)),i.log("ProductEstimatorSettings: Events bound")}},{key:"handleAjaxFormSubmit",value:function(t,e){var i=this,n=jQuery,a=(e=e||n(t.target)).closest(".tab-content").attr("id")||e.data("tab"),o=e.serialize(),r=window.createLogger?window.createLogger("PES:".concat(a||"unknown_tab")):console;r.log("Serialized form data (generic handler):",o),e.find('input[type="checkbox"]').each((function(){var t=n(this);if(!t.is(":checked")){var e=t.attr("name");if(e){var i=new RegExp("(^|&)".concat(encodeURIComponent(e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"(?:=[^&]*)?"));null===o.match(i)&&(o+="&".concat(encodeURIComponent(e),"=0"))}}})),o=o.replace(/^&+/,"").replace(/&&+/g,"&"),this.showFormLoading(e),r.log("Submitting form for tab: ".concat(a));var s="save_".concat(a,"_settings"),d=window.productEstimatorSettings||{nonce:"",ajax_url:ajaxurl,i18n:{}},l={action:s,nonce:d.nonce,form_data:o};r.log("Generic handler (ProductEstimatorSettings.js) sending AJAX with payload:",l),p({url:d.ajax_url,type:"POST",data:l}).then((function(t){k(t.message||d.i18n.saveSuccess,"success"),i.formChangeTrackers[a]=!1,a===i.currentTab&&(i.formChanged=!1),r.log("Settings saved successfully for tab: ".concat(a," (via generic handler)"))})).catch((function(t){k(t.message||d.i18n.saveError,"error"),r.error("Error saving settings for tab ".concat(a," (via generic handler):"),t)})).finally((function(){i.hideFormLoading(e)}))}},{key:"showFormLoading",value:function(t){var e=t.find(":submit");e.prop("disabled",!0).addClass("loading"),e.data("original-text",e.val()),e.val(productEstimatorSettings.i18n.saving||"Saving...")}},{key:"hideFormLoading",value:function(t){var e=t.find(":submit");e.prop("disabled",!1).removeClass("loading"),e.val(e.data("original-text"))}},{key:"initFormChangeTracking",value:function(){var t=jQuery,e=this;t(".tab-content").each((function(){var i=t(this).attr("id");e.formChangeTrackers[i]=!1,t("#".concat(i," :input")).on("change input",(function(){e.formChangeTrackers[i]=!0,i===e.currentTab&&(e.formChanged=!0)}))})),C("ProductEstimatorSettings","Form change tracking initialized")}},{key:"initializeValidation",value:function(){var t=jQuery;t(".product-estimator-form").each((function(){var e=t(this);e.find('input[type="email"]').on("change",(function(e){var i=t(this),n=i.val();n&&!w(n)?E(i,productEstimatorSettings.i18n.invalidEmail||"Invalid email address"):T(i)})),e.find('input[type="number"]').on("change",(function(e){var i=t(this),n=parseInt(i.val()),a=parseInt(i.attr("min")||0),o=parseInt(i.attr("max")||9999);isNaN(n)||n<a||n>o?E(i,productEstimatorSettings.i18n.numberRange?productEstimatorSettings.i18n.numberRange.replace("%min%",a).replace("%max%",o):"Value must be between ".concat(a," and ").concat(o)):T(i)}))})),C("ProductEstimatorSettings","Form validation initialized")}},{key:"getTabFromUrl",value:function(){return new URLSearchParams(window.location.search).get("tab")}},{key:"handleTabClick",value:function(t){t.preventDefault();var e=jQuery(t.currentTarget).data("tab");this.formChanged&&!confirm(productEstimatorSettings.i18n.unsavedChanges)||this.switchTab(e)}},{key:"switchTab",value:function(t){var e=jQuery,i=new URL(window.location);i.searchParams.set("tab",t),window.history.pushState({},"",i),e(".nav-tab").removeClass("nav-tab-active"),e('.nav-tab[data-tab="'.concat(t,'"]')).addClass("nav-tab-active"),e(".tab-content").hide(),e("#".concat(t)).show();var n=this.currentTab;this.currentTab=t,this.formChanged=this.formChangeTrackers[t]||!1,e(document).trigger("product_estimator_tab_changed",[t,n]),C("ProductEstimatorSettings","Switched to tab: ".concat(t," from ").concat(n))}},{key:"handleBeforeUnload",value:function(t){var e=!1;for(var i in this.formChangeTrackers)if(this.formChangeTrackers[i]){e=!0;break}if(e){var n=productEstimatorSettings.i18n.unsavedChanges;return t.returnValue=n,n}}},{key:"showFieldError",value:function(t,e){E(t,e)}},{key:"clearFieldError",value:function(t){T(t)}},{key:"showNotice",value:function(t){k(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success")}}])}();jQuery(document).ready((function(){window.ProductEstimatorSettings=new N}));var R=g("UtilsTinyMCEPreserver");var O=j("GeneralSettings"),Q=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.generalSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce||"",i18n:n.i18n||{},tab_id:n.tab_id||"genaral"},$(document).ready((function(){var t=window.generalSettings||{};t.nonce&&(e.settings.nonce=t.nonce),e.validateMarkup=e.validateMarkup.bind(e),e.validateExpiryDays=e.validateExpiryDays.bind(e),e.showFieldError=e.showFieldError.bind(e),e.clearFieldError=e.clearFieldError.bind(e),e.handleTabChanged=e.handleTabChanged.bind(e),e.saveEditorContent=e.saveEditorContent.bind(e),e.validateAllFields=e.validateAllFields.bind(e),e.init()}))}),[{key:"init",value:function(){this.mediaFrame=null,this.bindEvents(),this.setupValidation(),this.setupWpEditors(),O.log("Initialized")}},{key:"bindEvents",value:function(){var t=jQuery;t(document).on("product_estimator_tab_changed",this.handleTabChanged),t(".select-file-button").on("click",this.handleFileUpload.bind(this)),t(".remove-file-button").on("click",this.handleFileRemove.bind(this))}},{key:"setupWpEditors",value:function(){!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",i=jQuery;if(0!==i(e).length){R.log("Setting up rich text editors with <br> tag preservation"),window._originalEditorContent=window._originalEditorContent||{};var n=function(t){return t.replace(/<br\s*\/?>/gi,"<br>â€‹")},a=function(t){return t.replace(/\u200B/g,"")},o=function(){if("undefined"!=typeof tinyMCE&&tinyMCE.editors){var e=!0;return t.forEach((function(t){(function(t){if(!tinyMCE||!tinyMCE.get(t))return!1;var e=tinyMCE.get(t);e.settings.wpautop=!1,e.settings.forced_root_block="",e.settings.valid_elements="*[*]",e.settings.entity_encoding="raw",e.settings.verify_html=!1,e.settings.br_in_pre=!1,e.settings.keep_styles=!0,e.settings.remove_linebreaks=!1,e.settings.convert_newlines_to_brs=!0,e.settings.remove_redundant_brs=!1;var o=i("#".concat(t));if(o.length){var r=o.val();window._originalEditorContent[t]=r,setTimeout((function(){var t=n(r);e.setContent(t,{format:"raw"})}),100)}return e.on("BeforeSetContent",(function(e){e.content&&(e.content=n(e.content)),(e.initial||e.source_view)&&(window._originalEditorContent[t]=e.content)})),e.on("GetContent",(function(t){t.content&&(t.content=a(t.content))})),e.on("init",(function(){var i=e.getContent({format:"raw"});window._originalEditorContent[t]=a(i),R.log("Editor ".concat(t," initialized with content length: ").concat(i.length))})),i('.wp-editor-tabs button[data-wp-editor-id="'.concat(t,'"]')).on("click",(function(){var e=i(this).hasClass("switch-html"),o=i(this).hasClass("switch-tmce");if(e&&tinyMCE.get(t)){var r=tinyMCE.get(t).getContent({format:"raw"}),s=a(r);window._originalEditorContent[t]=s,i("#".concat(t)).val(s)}o&&setTimeout((function(){if(tinyMCE.get(t)&&window._originalEditorContent[t]){var e=n(window._originalEditorContent[t]);tinyMCE.get(t).setContent(e,{format:"raw"})}}),100)})),R.log("Editor ".concat(t," configured with <br> tag protection")),!0})(t)||(e=!1)})),e}return!1};if(!o())var r=0,s=setInterval((function(){r++,(o()||r>20)&&clearInterval(s)}),300);t.forEach((function(t){i("#".concat(t)).on("input change",(function(){window._originalEditorContent[t]=i(this).val()}))})),i("".concat(e," form")).off("submit.htmlPreservation").on("submit.htmlPreservation",(function(){return t.forEach((function(t){var e="";if(tinyMCE.get(t)&&tinyMCE.get(t).isHidden()){var n=i("#".concat(t));n.length&&(e=n.val())}else if(tinyMCE.get(t)){var o=tinyMCE.get(t).getContent({format:"raw"});e=a(o)}!e&&window._originalEditorContent[t]&&(e=window._originalEditorContent[t]),e&&(i("#".concat(t)).val(e),R.log("Form submission: Updated ".concat(t," with content length: ").concat(e.length)))})),!0}))}}(["pdf_footer_text","pdf_footer_contact_details_content"],"#general")}},{key:"handleFileUpload",value:function(t){var e=this;t.preventDefault();var i=jQuery,n=i(t.currentTarget),a=n.data("field-id"),o=n.data("accept")||"";this.mediaFrame||(this.mediaFrame=wp.media({title:"Select or Upload PDF Template",button:{text:"Use this file"},multiple:!1,library:{type:o?[o.split("/")[0]]:null}}),this.mediaFrame.on("select",(function(){var t=e.mediaFrame.state().get("selection").first().toJSON();console.log("Selected attachment:",t),t&&t.id?(console.log("Setting # ".concat(a," to value: ").concat(t.id)),i("#".concat(a)).val(t.id).trigger("change"),console.log("Value of #".concat(a," after setting:"),i("#".concat(a)).val())):console.error("Attachment or attachment.id is missing!",t),n.siblings(".file-preview-wrapper").html('<p class="file-preview"><a href="'.concat(t.url,'" target="_blank">').concat(t.filename,"</a></p>")),n.siblings(".remove-file-button").removeClass("hidden")}))),this.mediaFrame.open()}},{key:"handleFileRemove",value:function(t){t.preventDefault();var e=jQuery,i=e(t.currentTarget),n=i.data("field-id");e("#".concat(n)).val("").trigger("change"),i.siblings(".file-preview-wrapper").empty(),i.addClass("hidden")}},{key:"setupValidation",value:function(){var t=jQuery;t("#default_markup").on("change input",this.validateMarkup),t("#estimate_expiry_days").on("change input",this.validateExpiryDays)}},{key:"validateMarkup",value:function(t){var e=jQuery(t.currentTarget),i=parseInt(e.val()),n=parseInt(e.attr("min")||0),a=parseInt(e.attr("max")||100);return isNaN(i)||i<n||i>a?(this.showFieldError(e,generalSettingsData.i18n.validationErrorMarkup||"Value must be between ".concat(n," and ").concat(a)),!1):(this.clearFieldError(e),!0)}},{key:"validateExpiryDays",value:function(t){var e=jQuery(t.currentTarget),i=parseInt(e.val()),n=parseInt(e.attr("min")||1),a=parseInt(e.attr("max")||365);return isNaN(i)||i<n||i>a?(this.showFieldError(e,generalSettingsData.i18n.validationErrorExpiry||"Value must be between ".concat(n," and ").concat(a)),!1):(this.clearFieldError(e),!0)}},{key:"showFieldError",value:function(t,e){if("undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.showFieldError)ProductEstimatorSettings.showFieldError(t,e);else if("undefined"!=typeof validation&&"function"==typeof validation.showFieldError)validation.showFieldError(t,e);else{t.addClass("error"),this.clearFieldError(t);var i=jQuery('<span class="field-error">'.concat(e,"</span>"));t.after(i)}}},{key:"clearFieldError",value:function(t){"undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.clearFieldError?ProductEstimatorSettings.clearFieldError(t):"undefined"!=typeof validation&&"function"==typeof validation.clearFieldError?validation.clearFieldError(t):(t.removeClass("error"),t.next(".field-error").remove())}},{key:"handleTabChanged",value:function(t,e){"general"===e&&(this.setupWpEditors(),O.log("Tab changed to General Settings, refreshing editors"))}},{key:"saveEditorContent",value:function(){"undefined"!=typeof tinyMCE&&["pdf_footer_text","pdf_footer_contact_details_content"].forEach((function(t){var e=tinyMCE.get(t);e&&e.save()}))}},{key:"validateAllFields",value:function(){var t=!0;return this.saveEditorContent(),this.validateMarkup({currentTarget:jQuery("#default_markup")})||(t=!1),this.validateExpiryDays({currentTarget:jQuery("#estimate_expiry_days")})||(t=!1),t}},{key:"showNotice",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";if("undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.showNotice)ProductEstimatorSettings.showNotice(t,e);else if("undefined"!=typeof validation&&"function"==typeof validation.showNotice)validation.showNotice(t,e);else{var i=jQuery,n=i('<div class="notice notice-'.concat(e,' is-dismissible"><p>').concat(t,"</p></div>"));i(".wrap h1").after(n),setTimeout((function(){n.fadeOut(500,(function(){return n.remove()}))}),5e3)}}}])}();jQuery(document).ready((function(){window.GeneralSettingsModule=new Q}));var U=j("NetSuiteSettings"),z=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.netsuiteSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce||"",i18n:n.i18n||{},tab_id:n.tab_id||"netsuite"},$(document).ready((function(){var t=window.netsuiteSettings||{};t.nonce&&(e.settings.nonce=t.nonce),e.init()}))}),[{key:"init",value:function(){U.log("Initializing NetSuite settings module"),this.bindEvents(),this.setupDependentFields()}},{key:"bindEvents",value:function(){var t=jQuery;t("#test-netsuite-connection").on("click",this.testNetsuiteConnection.bind(this)),t("#netsuite_enabled").on("change",this.toggleNetsuiteFields.bind(this)),t("#netsuite_api_url, #netsuite_token_url").on("change",this.validateUrl.bind(this)),t("#netsuite_request_limit").on("change",this.validateRequestLimit.bind(this)),t("#netsuite_cache_time").on("change",this.validateCacheTime.bind(this)),t(document).on("product_estimator_tab_changed",this.handleTabChanged.bind(this)),t(".product-estimator-form").on("submit",this.handleFormSubmit.bind(this))}},{key:"handleFormSubmit",value:function(t){var e=jQuery,i=e(t.currentTarget);if(0!==i.closest("#netsuite").length){t.preventDefault();var n=i.serialize();i.find('input[type="checkbox"]').each((function(){var t=e(this).attr("name");e(this).is(":checked")||n.includes(t)||(n+="&"+t+"=0")}));var a=i.find(":submit");a.prop("disabled",!0),a.data("original-text",a.val()),a.val("Saving..."),p({url:netsuiteSettings.ajax_url,type:"POST",data:{action:"save_netsuite_settings",nonce:netsuiteSettings.nonce,form_data:n}}).then((function(t){"undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.showNotice?ProductEstimatorSettings.showNotice(t.message||"Settings saved successfully","success"):showNotice(t.message||"Settings saved successfully","success"),"undefined"!=typeof ProductEstimatorSettings&&(ProductEstimatorSettings.formChanged=!1,ProductEstimatorSettings.formChangeTrackers&&(ProductEstimatorSettings.formChangeTrackers.netsuite=!1))})).catch((function(t){"undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.showNotice?ProductEstimatorSettings.showNotice(t.message||"Error saving settings","error"):showNotice(t.message||"Error saving settings","error")})).finally((function(){a.prop("disabled",!1),a.val(a.data("original-text"))}))}}},{key:"setupDependentFields",value:function(){this.toggleNetsuiteFields(),U.log("Dependent fields setup complete")}},{key:"toggleNetsuiteFields",value:function(){var t=jQuery,e=t("#netsuite_enabled").is(":checked"),i=t("#netsuite_client_id, #netsuite_client_secret, #netsuite_api_url, #netsuite_token_url, #netsuite_request_limit, #netsuite_cache_time").closest("tr");e?(i.fadeIn(200),t("#test-netsuite-connection").closest("p").fadeIn(200)):(i.fadeOut(200),t("#test-netsuite-connection").closest("p").fadeOut(200))}},{key:"testNetsuiteConnection",value:function(){var t=jQuery,e=t("#test-netsuite-connection"),i=t("#connection-result");e.prop("disabled")||(e.prop("disabled",!0),i.html('<span style="color:#666;">'.concat(netsuiteSettings.i18n.testing||"Testing connection...","</span>")),U.log("Testing NetSuite connection"),p({url:netsuiteSettings.ajax_url,type:"POST",data:{action:"test_netsuite_connection",nonce:netsuiteSettings.nonce}}).then((function(t){i.html('<span style="color:green;">'.concat(t.message,"</span>")),U.log("Connection test successful")})).catch((function(t){i.html('<span style="color:red;">'.concat(netsuiteSettings.i18n.error||"Error:"," ").concat(t.message,"</span>")),U.log("Connection test failed:",t)})).finally((function(){e.prop("disabled",!1)})))}},{key:"handleTabChanged",value:function(t,e){e===netsuiteSettings.tab_id&&(this.toggleNetsuiteFields(),U.log("Tab changed to NetSuite settings, refreshing fields"))}},{key:"validateUrl",value:function(t){var e=jQuery(t.currentTarget),i=e.val().trim();return i&&!this.isValidUrl(i)?(this.showFieldError(e,netsuiteSettings.i18n.invalidUrl||"Please enter a valid URL"),!1):(this.clearFieldError(e),!0)}},{key:"validateRequestLimit",value:function(t){var e=jQuery(t.currentTarget),i=parseInt(e.val(),10);return isNaN(i)||i<1||i>100?(this.showFieldError(e,"Request limit must be between 1 and 100"),!1):(this.clearFieldError(e),!0)}},{key:"validateCacheTime",value:function(t){var e=jQuery(t.currentTarget),i=parseInt(e.val(),10);return isNaN(i)||i<0?(this.showFieldError(e,"Cache time must be at least 0"),!1):(this.clearFieldError(e),!0)}},{key:"isValidUrl",value:function(t){try{return new URL(t),!0}catch(t){return!1}}},{key:"showFieldError",value:function(t,e){"undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.showFieldError?ProductEstimatorSettings.showFieldError(t,e):E(t,e)}},{key:"clearFieldError",value:function(t){"undefined"!=typeof ProductEstimatorSettings&&"function"==typeof ProductEstimatorSettings.clearFieldError?ProductEstimatorSettings.clearFieldError(t):T(t)}},{key:"addInfoSection",value:function(t){var e=jQuery,i=e("#netsuite-settings-table");if(i.length&&t){e(".netsuite-info-section").remove();var n=v("div",{className:"netsuite-info-section notice notice-info",style:{padding:"10px",marginBottom:"15px"}},t);i.before(n),U.log("Added info section to settings page")}}}])}();function B(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}(t,e);if(n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(arguments.length<3?t:i):a.value}},V.apply(null,arguments)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}function q(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}function H(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}jQuery(document).ready((function(){var t=new z;window.NetsuiteSettingsModule=t}));var W=j("VerticalTabbedModule"),X=function(){return r((function t(e){var n=this;i(this,t),window.featureSwitchesSettings,this.config=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?H(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},e),this.$container=null,this.config.mainTabId&&this.config.defaultSubTabId&&this.config.ajaxActionPrefix&&this.config.localizedDataName?(this.localizedData=window[this.config.localizedDataName]||{i18n:{},nonce:"",ajax_url:""},this.localizedData.nonce&&this.localizedData.ajax_url||(window.productEstimatorSettings&&(this.localizedData.nonce=this.localizedData.nonce||window.productEstimatorSettings.nonce,this.localizedData.ajax_url=this.localizedData.ajax_url||window.productEstimatorSettings.ajax_url),this.localizedData.nonce&&this.localizedData.ajax_url||W.warn("Nonce or AJAX URL missing for ".concat(this.config.mainTabId,". AJAX submissions might fail. Localized data:"),this.localizedData)),jQuery(document).ready((function(){n.$container=jQuery("#".concat(n.config.mainTabId)),n.$container.length?n.init():W.log("Main container #".concat(n.config.mainTabId," not found. Module not initialized."))}))):W.error("Missing critical configuration for VerticalTabbedModule.",this.config)}),[{key:"init",value:function(){var t=this;W.log("Module for main tab #".concat(this.config.mainTabId," initialized.")),this.bindCommonEvents(),this.bindModuleSpecificEvents(),window.ProductEstimatorSettings&&window.ProductEstimatorSettings.currentTab===this.config.mainTabId&&(W.log("Main tab #".concat(this.config.mainTabId," is currently active. Setting up vertical tabs.")),setTimeout((function(){t.setupVerticalTabs(),t.onMainTabActivated()}),100))}},{key:"bindCommonEvents",value:function(){jQuery(document).on("product_estimator_tab_changed",this.handleMainTabChanged.bind(this)),this.$container&&this.$container.length&&(this.$container.on("submit",".product-estimator-form, .pe-vtabs-tab-form",this.handleFormSubmit.bind(this)),this.$container.on("click",".pe-vtabs-nav-list a, .vertical-tabs-nav a",this.handleVerticalTabClick.bind(this)))}},{key:"bindModuleSpecificEvents",value:function(){}},{key:"onMainTabActivated",value:function(){W.log("onMainTabActivated hook for ".concat(this.config.mainTabId))}},{key:"onMainTabDeactivated",value:function(){W.log("onMainTabDeactivated hook for ".concat(this.config.mainTabId))}},{key:"setupVerticalTabs",value:function(){if(this.$container&&this.$container.length){W.log("Setting up vertical tabs.");var t=this.$container.find(".pe-vtabs-nav-list, .vertical-tabs-nav"),e=this.$container.find(".pe-vtabs-tab-panel, .vertical-tab-content");if(t.length&&e.length){var i=this.config.defaultSubTabId,n=new URLSearchParams(window.location.search).get("sub_tab");if(n&&t.find('a[data-tab="'.concat(n,'"]')).length)i=n;else{var a=t.find(".pe-vtabs-nav-item.active a, .tab-item.active a");a.length&&(i=a.data("tab"))}t.find('a[data-tab="'.concat(i,'"]')).length||(W.warn('Active/Default sub-tab "'.concat(i,'" not valid. Falling back.')),i=t.find("a[data-tab]").first().data("tab")||this.config.defaultSubTabId,t.find('a[data-tab="'.concat(i,'"]')).length)?(W.log("Initial active sub-tab ID:",i),this.showVerticalTab(i,!1),this.adjustTabContentHeight(),jQuery(window).off("resize.".concat(this.config.mainTabId)).on("resize.".concat(this.config.mainTabId),this.adjustTabContentHeight.bind(this))):W.error("No valid sub-tabs found. Cannot initialize.")}else W.warn("Vertical tab navigation or content panels not found.")}else W.warn("Cannot setup vertical tabs: main container not found.")}},{key:"adjustTabContentHeight",value:function(){}},{key:"handleVerticalTabClick",value:function(t){}},{key:"showVerticalTab",value:function(t){}},{key:"handleMainTabChanged",value:function(t,e,i){}},{key:"handleFormSubmit",value:function(t){var e=this,i=jQuery(t.currentTarget),a=j("VTM:".concat(this.config.mainTabId||"UnknownModule"));a.log("Form submission event triggered by VerticalTabbedModule for form:",i[0]),i.attr("data-tab")||a.warn("VerticalTabbedModule: Form does not have data-tab attribute, though it matched selector. This is unexpected for a vertical tab form. Form:",i[0]),t.preventDefault();var o=i.find(".save-settings"),r=i.find(".spinner");"undefined"!=typeof tinyMCE&&i.find(".wp-editor-area").each((function(){var t=tinyMCE.get(jQuery(this).attr("id"));t&&(t.save(),a.log("Saved TinyMCE editor content for:",jQuery(this).attr("id")))}));var s=i.serialize();a.log("Serialized form data:",s);var d=i.attr("data-tab");if(!d||""===String(d).trim())return a.error("CRITICAL: 'data-tab' attribute is missing or empty on a form this module is handling. Form:",i[0]),d=this.config.defaultSubTabId,this.showNotice("Error: Could not determine the current settings section. Please check form markup.","error"),o&&o.length&&o.prop("disabled",!1),void(r&&r.length&&r.removeClass("is-active"));d=String(d).trim(),a.log('Final sub-tab ID for AJAX: "'.concat(d,'"')),i.find('input[type="checkbox"]').each((function(){var t=jQuery(this),e=t.attr("name");e&&!t.is(":checked")&&(new RegExp("(^|&)".concat(encodeURIComponent(e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"(?:=[^&]*)?")).test(s)||(s+="&".concat(encodeURIComponent(e),"=0")))})),s=s.replace(/^&+/,"").replace(/&&+/g,"&"),o.prop("disabled",!0),r.addClass("is-active");var l={action:"".concat(this.config.ajaxActionPrefix,"_settings"),nonce:this.localizedData.nonce,form_data:s,sub_tab_id:d};a.log("Sending AJAX with payload:",l),p({url:this.localizedData.ajax_url,type:"POST",data:l}).then((function(t){a.log("Success response:",t);var i=t&&t.message||e.localizedData.i18n&&e.localizedData.i18n.saveSuccess||"Settings saved successfully.";e.showNotice(i,"success"),window.ProductEstimatorSettings&&"object"===n(window.ProductEstimatorSettings.formChangeTrackers)&&(window.ProductEstimatorSettings.formChangeTrackers[e.config.mainTabId]=!1,e.config.mainTabId===window.ProductEstimatorSettings.currentTab&&(window.ProductEstimatorSettings.formChanged=!1))})).catch((function(t){a.error("Error response:",t);var i=t&&t.message||e.localizedData.i18n&&e.localizedData.i18n.saveError||"Error saving settings.";e.showNotice(i,"error")})).finally((function(){o.length&&o.prop("disabled",!1),r.length&&r.removeClass("is-active")}))}},{key:"showNotice",value:function(t){}},{key:"showFieldError",value:function(t,e){}},{key:"clearFieldError",value:function(t){}}])}();X.prototype.adjustTabContentHeight=function(){if(this.$container&&this.$container.length){var t=this.$container.find(".pe-vtabs-nav-area, .vertical-tabs"),e=this.$container.find(".pe-vtabs-content-area, .vertical-tabs-content");if(t.length&&e.length){var i=t.outerHeight();i&&e.css("min-height",i+"px")}}},X.prototype.showVerticalTab=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.$container&&this.config.mainTabId&&t){W.log("Showing vertical tab:",t);var i=this.$container.find(".pe-vtabs-nav-list, .vertical-tabs-nav"),n=this.$container.find(".pe-vtabs-tab-panel, .vertical-tab-content");if(i.find(".pe-vtabs-nav-item, .tab-item").removeClass("active"),i.find('a[data-tab="'.concat(t,'"]')).parent().addClass("active"),n.hide().removeClass("active"),this.$container.find("#".concat(t)).show().addClass("active"),e){var a=new URL(window.location.href);a.searchParams.set("page",a.searchParams.get("page")||"product-estimator-settings"),a.searchParams.set("tab",this.config.mainTabId),a.searchParams.set("sub_tab",t),window.history.pushState({mainTabId:this.config.mainTabId,subTabId:t},"",a.toString())}jQuery(document).trigger("pe_sub_tab_changed_".concat(this.config.mainTabId),[t])}else W.warn("Cannot show vertical tab: missing container, mainTabId, or subTabId.",{containerExists:!!this.$container,mainTabId:this.config.mainTabId,subTabId:t})},X.prototype.handleMainTabChanged=function(t,e,i){var n=this;e===this.config.mainTabId?(W.log("Main tab #".concat(this.config.mainTabId," activated.")),setTimeout((function(){n.$container&&n.$container.length||(n.$container=jQuery("#".concat(n.config.mainTabId))),n.$container.length?(n.setupVerticalTabs(),n.onMainTabActivated()):W.warn("Main container #".concat(n.config.mainTabId," not found when trying to activate tab."))}),100)):i===this.config.mainTabId&&this.onMainTabDeactivated()},X.prototype.showNotice=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice?window.ProductEstimatorSettings.showNotice(t,e):k(t,e)},X.prototype.showFieldError=function(t,e){window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showFieldError?window.ProductEstimatorSettings.showFieldError(t,e):E(t,e)},X.prototype.clearFieldError=function(t){window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.clearFieldError?window.ProductEstimatorSettings.clearFieldError(t):T(t)};const G=X;function K(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(K=function(){return!!t})()}function Z(t,e,i,n){var a=V(L(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof a?function(t){return a.apply(i,t)}:a}var Y=j("NotificationSettings"),tt=function(t){function e(){var t,n,a,o;return i(this,e),n=this,o=[{mainTabId:"notifications",defaultSubTabId:"notifications-general",ajaxActionPrefix:"save_notifications",localizedDataName:"notificationSettings"}],a=L(a=e),(t=B(n,K()?Reflect.construct(a,o||[],L(n).constructor):a.apply(n,o))).mediaFrame=null,t}return q(e,t),r(e,[{key:"bindModuleSpecificEvents",value:function(){Z(e,"bindModuleSpecificEvents",this,3)([]),this.$container&&this.$container.length&&(jQuery,this.$container.on("change","#enable_notifications",this.handleToggleAllNotifications.bind(this)),this.$container.on("change",'input[id^="notification_"][id$="_enabled"]',this.handleToggleSingleNotification.bind(this)),this.$container.on("click",".image-upload-button",this.handleImageUpload.bind(this)),this.$container.on("click",".image-remove-button",this.handleImageRemove.bind(this)),this.$container.on("change",'input[type="email"]',this.handleEmailValidation.bind(this)),Y.log("NotificationSettingsModule specific events bound."))}},{key:"onMainTabActivated",value:function(){Z(e,"onMainTabActivated",this,3)([]),this.setupDependentFieldsState(),this.setupNotificationEditors(),Y.log("Notifications main tab activated - specific setup executed.")}},{key:"setupNotificationEditors",value:function(){this.$container&&this.localizedData&&Y.log("Setting up rich text editors for notifications.")}},{key:"setupDependentFieldsState",value:function(){var t=this;this.$container&&this.$container.length&&(this.handleToggleAllNotifications(),this.$container.find('input[id^="notification_"][id$="_enabled"]').each((function(e,i){var n=jQuery(i);t.toggleSingleNotificationFields(n)})))}},{key:"handleToggleAllNotifications",value:function(){var t=this;if(this.$container&&this.$container.length){jQuery;var e=this.$container.find("#enable_notifications");if(e.length){var i=e.is(":checked"),n=this.$container.find(".pe-vtabs-nav-list, .vertical-tabs-nav"),a=this.$container.find('.pe-vtabs-tab-form[data-tab-id*="notification_type_"]');Y.log("Global notifications toggle: ".concat(i)),i?(n.removeClass("pe-vtabs-nav-disabled"),this.$container.find('input[id^="notification_"][id$="_enabled"]').each((function(e,i){t.toggleSingleNotificationFields(jQuery(i))}))):(n.addClass("pe-vtabs-nav-disabled"),a.find("input, textarea, button, select").not(".save-settings").prop("disabled",!0),a.find(".wp-editor-area").each((function(){var t=tinyMCE.get(jQuery(this).attr("id"));t&&t.setMode("readonly")})))}else Y.warn("#enable_notifications checkbox not found.")}}},{key:"handleToggleSingleNotification",value:function(t){this.toggleSingleNotificationFields(jQuery(t.currentTarget))}},{key:"toggleSingleNotificationFields",value:function(t){if(this.$container&&this.$container.length){var e=jQuery,i=t.is(":checked"),n=t.attr("id").replace("notification_","").replace("_enabled",""),a=this.$container.find('.pe-vtabs-tab-form[data-tab="notification-type-'.concat(n,'"]'));if(a.length){var o=this.$container.find("#enable_notifications");!o.length||o.is(":checked")?(a.find("input, textarea, button, select").not(t).not(".save-settings").prop("disabled",!i),a.find(".wp-editor-area").each((function(){var t=tinyMCE.get(e(this).attr("id"));t&&t.setMode(i?"design":"readonly")}))):Y.log("Global notifications are disabled, individual toggles have no effect on field state.")}else Y.warn("Form for notification type ".concat(n," not found."))}}},{key:"handleImageUpload",value:function(t){var e=this;t.preventDefault();var i=jQuery(t.currentTarget).data("field-id");if(this.mediaFrame)this.mediaFrame.off("select");else{if("undefined"==typeof wp||!wp.media)return void Y.error("WordPress Media Library not available");this.mediaFrame=wp.media({title:this.localizedData.i18n.selectImage||"Select Image",button:{text:this.localizedData.i18n.useThisImage||"Use this image"},multiple:!1,library:{type:"image"}})}this.mediaFrame.on("select",(function(){var t=e.mediaFrame.state().get("selection").first().toJSON(),n=e.$container.find("#".concat(i)),a=n.closest("td").find(".image-preview-wrapper"),o=n.closest("td").find(".image-remove-button");n.val(t.id).trigger("change"),a.html('<img src="'.concat(t.sizes.thumbnail?t.sizes.thumbnail.url:t.url,'" alt="Preview" />')),o.removeClass("hidden")})),this.mediaFrame.open()}},{key:"handleImageRemove",value:function(t){t.preventDefault();var e=jQuery(t.currentTarget),i=e.data("field-id"),n=this.$container.find("#".concat(i)),a=n.closest("td").find(".image-preview-wrapper");n.val("").trigger("change"),a.empty(),e.addClass("hidden")}},{key:"handleEmailValidation",value:function(t){var e=jQuery(t.target);if(e.closest(this.$container).length){var i=e.val().trim(),n=this.localizedData&&this.localizedData.i18n||{};return i&&!w(i)?(this.showFieldError(e,n.validationErrorEmail||"Please enter a valid email address."),!1):(this.clearFieldError(e),!0)}}}])}(G);function et(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return it(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?it(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw o}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function nt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(nt=function(){return!!t})()}function at(t,e,i,n){var a=V(L(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof a?function(t){return a.apply(i,t)}:a}jQuery(document).ready((function(){jQuery("#notifications").length&&(window.ProductEstimatorNotificationSettingsModule=new tt)}));var ot=function(t){function e(){var t,n,a,o;return i(this,e),n=this,o=[{mainTabId:"product_additions",localizedDataName:"productAdditionsSettings"}],a=L(a=e),(t=B(n,nt()?Reflect.construct(a,o||[],L(n).constructor):a.apply(n,o))).productSearchTimeout=null,t.$(document).on("admin_table_manager_ready_".concat(t.config.mainTabId),(function(){t.logger.log("Base AdminTableManager is ready. Initializing ProductAdditions specifics."),t._bindSpecificEvents(),t._initializeSelect2(),t.logger.log("ProductAdditionsSettingsModule specific features initialized.")})),t.logger.log("ProductAdditionsSettingsModule constructor completed."),t}return q(e,t),r(e,[{key:"_bindSpecificEvents",value:function(){var t,e,i,n,a;null===(t=this.dom.form)||void 0===t||t.on("click.productAdditions",".product-result-item",this._handleProductResultClick.bind(this)),null===(e=this.dom.relationTypeSelect)||void 0===e||e.on("change.productAdditions",this._handleRelationTypeChange.bind(this)),null===(i=this.dom.targetCategorySelect)||void 0===i||i.on("change.productAdditions",this._handleTargetCategoryChange.bind(this)),null===(n=this.dom.productSearchInput)||void 0===n||n.on("keyup.productAdditions",this._handleProductSearchKeyup.bind(this)),null===(a=this.dom.clearProductButton)||void 0===a||a.on("click.productAdditions",this._handleClearProduct.bind(this)),this.logger.log("Product Additions specific events bound.")}},{key:"_initializeSelect2",value:function(){var t=this,e=function(e,i){e&&e.length&&t.$.fn.select2?e.select2({placeholder:i,width:"100%",allowClear:!0,dropdownCssClass:"product-estimator-dropdown"}).val(null).trigger("change"):e&&!e.length&&t.logger.warn("Select2 target element not found:",e.selector)};e(this.dom.sourceCategorySelect,this.settings.i18n.selectSourceCategories||"Select source categories"),e(this.dom.targetCategorySelect,this.settings.i18n.selectTargetCategory||"Select a category"),this.logger.log("Select2 components initialized for Product Additions.")}},{key:"_handleRelationTypeChange",value:function(){var t,e,i,n,a,o,r,s=null===(t=this.dom.relationTypeSelect)||void 0===t?void 0:t.val();if(this.logger.log("Relation type changed to:",s),null===(e=this.dom.targetCategoryRow)||void 0===e||e.hide(),null===(i=this.dom.productSearchRow)||void 0===i||i.hide(),null===(n=this.dom.noteRow)||void 0===n||n.hide(),null===(a=this.dom.targetCategorySelect)||void 0===a||a.val(null).trigger("change.select2"),this._clearProductSelectionFields(),null===(o=this.dom.noteTextInput)||void 0===o||o.val(""),"auto_add_by_category"===s)null===(r=this.dom.targetCategoryRow)||void 0===r||r.show();else if("auto_add_note_by_category"===s){var d;null===(d=this.dom.noteRow)||void 0===d||d.show()}else if("suggest_products_by_category"===s){var l;this.settings.feature_flags&&this.settings.feature_flags.suggested_products_enabled?null===(l=this.dom.targetCategoryRow)||void 0===l||l.show():this.logger.warn("Suggest products feature is disabled, target category row for this type will not be shown.")}}},{key:"_handleTargetCategoryChange",value:function(){var t,e,i,n,a=null===(t=this.dom.targetCategorySelect)||void 0===t?void 0:t.val(),o=null===(e=this.dom.relationTypeSelect)||void 0===e?void 0:e.val();this.logger.log("Target category changed to:",a,"Action type:",o),this._clearProductSelectionFields(),a&&"auto_add_by_category"===o?null===(i=this.dom.productSearchRow)||void 0===i||i.show():null===(n=this.dom.productSearchRow)||void 0===n||n.hide()}},{key:"_clearProductSelectionFields",value:function(){var t,e,i,n;null===(t=this.dom.productSearchInput)||void 0===t||t.val(""),null===(e=this.dom.productSearchResults)||void 0===e||e.empty().hide(),null===(i=this.dom.selectedProductIdInput)||void 0===i||i.val(""),null===(n=this.dom.selectedProductDisplay)||void 0===n||n.hide().find(".selected-product-info").empty()}},{key:"_handleProductSearchKeyup",value:function(t){var e,i,n,a,o=this,r=(null===(e=this.$(t.target).val())||void 0===e?void 0:e.trim())||"",s=null===(i=this.dom.targetCategorySelect)||void 0===i?void 0:i.val();clearTimeout(this.productSearchTimeout),r.length<3||!s?null===(a=this.dom.productSearchResults)||void 0===a||a.empty().hide():(null===(n=this.dom.productSearchResults)||void 0===n||n.html("<p>".concat(this.settings.i18n.searching||"Searching...","</p>")).show(),this.productSearchTimeout=setTimeout((function(){o._searchProducts(r,s)}),500))}},{key:"_searchProducts",value:function(t,e){var i=this;this.logger.log("Searching products with term:",t,"in category:",e),p({url:this.settings.ajaxUrl,data:{action:this.settings.actions.search_products,nonce:this.settings.nonce,search:t,category:e}}).then((function(t){if(i.logger.log("Raw response from ajax.ajaxRequest:",t),i.logger.log("Type of response:",n(t)),t&&"object"===n(t)&&(i.logger.log("Is response an array?",Array.isArray(t)),i.logger.log("Response keys:",Object.keys(t)),i.logger.log('Does response have "success" property?',t.hasOwnProperty("success")),i.logger.log('Does response have "data" property?',t.hasOwnProperty("data"))),t&&t.products&&Array.isArray(t.products)){var e;i.logger.log("Product data found directly in response. Processing products array.");var a="";t.products.length>0?(a='<ul class="product-results-list">',t.products.forEach((function(t){var e=i.$("<div>").text(t.name||"").html();a+='<li class="product-result-item" data-id="'.concat(t.id,'" data-name="').concat(e,'">').concat(t.name||"Unnamed Product"," (ID: ").concat(t.id,")</li>")})),a+="</ul>"):a="<p>".concat(i.settings.i18n.noProductsFound||"No products found","</p>"),null===(e=i.dom.productSearchResults)||void 0===e||e.html(a).show()}else if(t&&t.success&&t.data&&t.data.products&&Array.isArray(t.data.products)){var o;i.logger.log("Product data found in response.data.products. Processing products array.");var r="";t.data.products.length>0?(r='<ul class="product-results-list">',t.data.products.forEach((function(t){var e=i.$("<div>").text(t.name||"").html();r+='<li class="product-result-item" data-id="'.concat(t.id,'" data-name="').concat(e,'">').concat(t.name||"Unnamed Product"," (ID: ").concat(t.id,")</li>")})),r+="</ul>"):r="<p>".concat(i.settings.i18n.noProductsFound||"No products found","</p>"),null===(o=i.dom.productSearchResults)||void 0===o||o.html(r).show()}else{var s;i.logger.error("Product search failed or returned invalid/unexpected data structure:",t),null===(s=i.dom.productSearchResults)||void 0===s||s.html("<p>".concat(i.settings.i18n.errorSearching||"Error searching products","</p>")).show()}})).catch((function(t){}))}},{key:"_handleProductResultClick",value:function(t){var e,i,n,a,o,r=this.$(t.currentTarget),s=r.data("id"),d=r.data("name");this.logger.log("Product selected from search:",s,d),null===(e=this.dom.selectedProductIdInput)||void 0===e||e.val(s),null===(i=this.dom.selectedProductDisplay)||void 0===i||i.find(".selected-product-info").html("<strong>".concat(d,"</strong> (ID: ").concat(s,")")),null===(n=this.dom.selectedProductDisplay)||void 0===n||n.show(),null===(a=this.dom.productSearchInput)||void 0===a||a.val(""),null===(o=this.dom.productSearchResults)||void 0===o||o.empty().hide(),this.formModified=!0}},{key:"_handleClearProduct",value:function(){var t;this.logger.log("Clear product selection."),this._clearProductSelectionFields(),null===(t=this.dom.productSearchInput)||void 0===t||t.focus(),this.formModified=!0}},{key:"resetForm",value:function(){var t,i,n,a,o,r,s;at(e,"resetForm",this,3)([]),null===(t=this.dom.relationTypeSelect)||void 0===t||t.val("").trigger("change.productAdditions"),null===(i=this.dom.sourceCategorySelect)||void 0===i||i.val(null).trigger("change.select2"),null===(n=this.dom.targetCategorySelect)||void 0===n||n.val(null).trigger("change.select2"),this._clearProductSelectionFields(),null===(a=this.dom.noteTextInput)||void 0===a||a.val(""),null===(o=this.dom.targetCategoryRow)||void 0===o||o.hide(),null===(r=this.dom.productSearchRow)||void 0===r||r.hide(),null===(s=this.dom.noteRow)||void 0===s||s.hide(),this.logger.log("Product Additions form fields fully reset.")}},{key:"populateFormWithData",value:function(t){var i,n=this;at(e,"populateFormWithData",this,3)([t]),this.logger.log("Populating Product Additions form with full item data:",t);var a=t.relation_type||"",o=t.source_category||[],r=t.target_category||"",s=t.product_id||"",d=t.note_text||"";null===(i=this.dom.relationTypeSelect)||void 0===i||i.val(a).trigger("change.productAdditions"),setTimeout((function(){var e,i,l,c,u;if(null===(e=n.dom.sourceCategorySelect)||void 0===e||e.val(o).trigger("change.select2"),"auto_add_by_category"===a){if(null===(i=n.dom.targetCategorySelect)||void 0===i||i.val(r).trigger("change.select2"),s&&t.product_name)null===(l=n.dom.selectedProductIdInput)||void 0===l||l.val(s),null===(c=n.dom.selectedProductDisplay)||void 0===c||c.find(".selected-product-info").html("<strong>".concat(t.product_name,"</strong> (ID: ").concat(s,")")),null===(u=n.dom.selectedProductDisplay)||void 0===u||u.show();else if(s){var g,h,f;n.logger.warn("Product ID present but product_name missing in data for edit form population."),null===(g=n.dom.selectedProductIdInput)||void 0===g||g.val(s),null===(h=n.dom.selectedProductDisplay)||void 0===h||h.find(".selected-product-info").html("Product ID: ".concat(s," (Name not available)")),null===(f=n.dom.selectedProductDisplay)||void 0===f||f.show()}}else if("suggest_products_by_category"===a){var m;n.settings.feature_flags&&n.settings.feature_flags.suggested_products_enabled&&(null===(m=n.dom.targetCategorySelect)||void 0===m||m.val(r).trigger("change.select2"))}else if("auto_add_note_by_category"===a){var p;null===(p=n.dom.noteTextInput)||void 0===p||p.val(d)}n.formModified=!1}),150)}},{key:"validateForm",value:function(){var t,e,i,n,a,o,r,s=!0;this.logger.log("Validating Product Additions form.");var d,l,c=null===(t=this.dom.relationTypeSelect)||void 0===t?void 0:t.val(),u=null===(e=this.dom.sourceCategorySelect)||void 0===e?void 0:e.val(),g=null===(i=this.dom.targetCategorySelect)||void 0===i?void 0:i.val(),h=null===(n=this.dom.selectedProductIdInput)||void 0===n?void 0:n.val(),f=(null===(a=this.dom.noteTextInput)||void 0===a||null===(a=a.val())||void 0===a?void 0:a.trim())||"";if(this.clearFieldError(this.dom.relationTypeSelect),this.clearFieldError(null===(o=this.dom.sourceCategorySelect)||void 0===o?void 0:o.next(".select2-container")),this.clearFieldError(null===(r=this.dom.targetCategorySelect)||void 0===r?void 0:r.next(".select2-container")),this.clearFieldError(this.dom.productSearchInput),this.clearFieldError(this.dom.noteTextInput),c||(this.showFieldError(this.dom.relationTypeSelect,this.settings.i18n.selectAction),s=!1),u&&0!==u.length||(this.showFieldError(null===(d=this.dom.sourceCategorySelect)||void 0===d?void 0:d.next(".select2-container"),this.settings.i18n.selectSourceCategories),s=!1),"auto_add_by_category"===c){if(g||(this.showFieldError(null===(l=this.dom.targetCategorySelect)||void 0===l?void 0:l.next(".select2-container"),this.settings.i18n.selectTargetCategory),s=!1),!h){var m,p=null!==(m=this.dom.selectedProductDisplay)&&void 0!==m&&m.is(":visible")?this.dom.selectedProductDisplay:this.dom.productSearchInput;this.showFieldError(p,this.settings.i18n.selectProduct),s=!1}}else if("suggest_products_by_category"===c){var v;this.settings.feature_flags&&this.settings.feature_flags.suggested_products_enabled&&(g||(this.showFieldError(null===(v=this.dom.targetCategorySelect)||void 0===v?void 0:v.next(".select2-container"),this.settings.i18n.selectTargetCategory),s=!1))}else"auto_add_note_by_category"===c&&(f||(this.showFieldError(this.dom.noteTextInput,this.settings.i18n.noteTextRequired),s=!1));return this.logger.log("Product Additions form validation result:",s),s}},{key:"createTableRow",value:function(t){if(this.logger.log("Creating Product Additions table row with data:",t),!t||!t.id)return this.logger.error("Cannot create table row: itemData or itemData.id is missing."),this.$('<tr><td colspan="4">Error: Invalid item data.</td></tr>');var e=this.$('<tr data-id="'.concat(t.id,'"></tr>'));e.append(this.$("<td></td>").text(t.source_name||"N/A"));var i=this.$("<td></td>"),n=this.$("<span></span>").addClass("relation-type ".concat(t.relation_type||"")).text(t.relation_type_label||t.relation_type||"N/A");i.append(n),e.append(i),e.append(this.$("<td></td>").text(t.target_details_display||"N/A"));var a=this.$("<td></td>").addClass("actions"),o=(Array.isArray(t.source_category)?t.source_category.join(","):t.source_category,this.$("<button></button>").attr("type","button").addClass("button button-small").addClass(this.settings.selectors.editButton.substring(1)).text(this.settings.i18n.editButtonLabel||"Edit").data("id",t.id)),r=this.$("<button></button>").attr("type","button").addClass("button button-small").addClass(this.settings.selectors.deleteButton.substring(1)).text(this.settings.i18n.deleteButtonLabel||"Delete").data("id",t.id);return a.append(o," ",r),e.append(a),e}}])}(function(){return r((function t(e){var n=this;i(this,t),this.$=jQuery,this.config=e,this.logger=j("AdminTableManager:".concat(this.config.mainTabId||"Generic")),this.config.mainTabId&&this.config.localizedDataName||this.logger.error("AdminTableManager: Missing critical configuration: mainTabId or localizedDataName.",this.config),this.settings=window[this.config.localizedDataName]||{},this.formModified=!1,this.isEditMode=!1,this.currentItemId=null,this.$mainContainer=null,this.$(document).ready((function(){if(!n.config.mainTabId)return n.logger.error("AdminTableManager: mainTabId missing in config during document.ready. Cannot initialize."),void(window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice&&window.ProductEstimatorSettings.showNotice("Critical error: Table manager configuration incomplete.","error"));if(n.$mainContainer=n.$("#".concat(n.config.mainTabId)),n.$mainContainer&&n.$mainContainer.length)try{n._validateSettings(),n.init()}catch(t){n.logger.error('AdminTableManager: Initialization failed for tab "'.concat(n.config.mainTabId,'".'),t),window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice&&window.ProductEstimatorSettings.showNotice("Error initializing table manager for ".concat(n.config.mainTabId,". Check console."),"error")}else n.logger.error("AdminTableManager: Main container #".concat(n.config.mainTabId," not found. Module will not initialize."))}))}),[{key:"_validateSettings",value:function(){if(0===Object.keys(this.settings).length&&this.config.localizedDataName)throw this.logger.error('Localized data object "'.concat(this.config.localizedDataName,'" not found or is empty.')),new Error('AdminTableManager: Localized data "'.concat(this.config.localizedDataName,'" is missing or empty.'));var t,e=!0,i=et(["ajaxUrl","nonce","actions","selectors","i18n","option_name","tab_id"]);try{for(i.s();!(t=i.n()).done;){var n=t.value;void 0===this.settings[n]&&(this.logger.error("Missing required setting: ".concat(n," (expected in ").concat(this.config.localizedDataName,")")),e=!1)}}catch(t){i.e(t)}finally{i.f()}if(this.settings.actions){var a,o=et(["add_item","update_item","delete_item"]);try{for(o.s();!(a=o.n()).done;){var r=a.value;void 0===this.settings.actions[r]&&(this.logger.error("Missing required action: actions.".concat(r," (expected in ").concat(this.config.localizedDataName,")")),e=!1)}}catch(t){o.e(t)}finally{o.f()}}else this.logger.error("Missing required setting: actions (expected in ".concat(this.config.localizedDataName,")")),e=!1;if(this.settings.selectors){var s,d=et(["formContainer","form","addButton","listTableBody","editButton","deleteButton","idInput","saveButton","cancelButton","noItemsMessage","formTitle","listItemRow","listTableContainer","listTable"]);try{for(d.s();!(s=d.n()).done;){var l=s.value;void 0===this.settings.selectors[l]&&(this.logger.error("Missing required selector: selectors.".concat(l," (expected in ").concat(this.config.localizedDataName,")")),e=!1)}}catch(t){d.e(t)}finally{d.f()}}else this.logger.error("Missing required setting: selectors (expected in ".concat(this.config.localizedDataName,")")),e=!1;if(this.settings.i18n){var c,u=et(["confirmDelete","itemSavedSuccess","itemDeletedSuccess","errorSavingItem","errorDeletingItem","addItemButtonLabel","editItemFormTitle","addItemFormTitle","saving","deleting","editButtonLabel","deleteButtonLabel"]);try{for(u.s();!(c=u.n()).done;){var g=c.value;void 0===this.settings.i18n[g]&&this.logger.warn("Potentially missing i18n string: i18n.".concat(g," (in ").concat(this.config.localizedDataName,")"))}}catch(t){u.e(t)}finally{u.f()}}else this.logger.warn("Setting: i18n is missing (in ".concat(this.config.localizedDataName,"). Some UI text may not appear."));if(!e)throw new Error("AdminTableManager: Initialization failed due to missing critical settings. Check console for details.");this.logger.log("Settings validated successfully for tab:",this.config.mainTabId)}},{key:"init",value:function(){this.logger.log("Initializing AdminTableManager DOM and events for tab:",this.config.mainTabId),this.cacheDOM(),this._checkEssentialDOM()?(this.bindEvents(),this.updateNoItemsMessageVisibility(),this.logger.log("AdminTableManager initialized successfully for tab:",this.config.mainTabId),this.$(document).trigger("admin_table_manager_ready_".concat(this.config.mainTabId),[this])):(this.logger.error("AdminTableManager initialization failed: missing essential DOM elements for tab:",this.config.mainTabId),window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice&&window.ProductEstimatorSettings.showNotice("Error initializing UI components for ".concat(this.settings.tab_id||"table manager",". Some parts may not work."),"error"))}},{key:"_checkEssentialDOM",value:function(){for(var t=!0,e=0,i=["formContainer","form","addButton","listTableBody","listTableContainer","listTable","noItemsMessage","formTitle","idInput","saveButton","cancelButton"];e<i.length;e++){var n=i[e];this.dom[n]&&this.dom[n].length||(this.logger.error("Essential DOM element not found for selector key '".concat(n,"':"),this.settings.selectors[n]),t=!1)}return t}},{key:"cacheDOM",value:function(){if(this.dom={},this.settings.selectors)for(var t in this.settings.selectors)Object.prototype.hasOwnProperty.call(this.settings.selectors,t)&&(this.$mainContainer&&this.$mainContainer.length?this.dom[t]=this.$mainContainer.find(this.settings.selectors[t]):this.dom[t]=this.$());this.logger.log("DOM elements cached for tab:",this.config.mainTabId,this.dom)}},{key:"bindEvents",value:function(){var t,e,i,n,a=this;null===(t=this.dom.addButton)||void 0===t||t.on("click.adminTableManager",this.handleAddNew.bind(this)),this.dom.listTableBody&&this.dom.listTableBody.length?(this.dom.listTableBody.on("click.adminTableManager",this.settings.selectors.editButton,this.handleEdit.bind(this)),this.dom.listTableBody.on("click.adminTableManager",this.settings.selectors.deleteButton,this.handleDelete.bind(this))):this.logger.warn("listTableBody not found for tab:",this.config.mainTabId,"- edit/delete events not bound."),null===(e=this.dom.form)||void 0===e||e.on("submit.adminTableManager",this.handleSubmit.bind(this)),null===(i=this.dom.cancelButton)||void 0===i||i.on("click.adminTableManager",this.handleCancel.bind(this)),null===(n=this.dom.form)||void 0===n||n.on("change.adminTableManager input.adminTableManager",":input",(function(){a.formModified=!0})),this.logger.log("Common events bound for tab:",this.config.mainTabId)}},{key:"handleAddNew",value:function(t){var e,i,n,a;t.preventDefault(),this.logger.log("Add New clicked for tab:",this.config.mainTabId),this.isEditMode=!1,this.currentItemId=null,this.resetForm(),null===(e=this.dom.formTitle)||void 0===e||e.text(this.settings.i18n.addItemFormTitle),null===(i=this.dom.saveButton)||void 0===i||i.text(this.settings.i18n.saveChangesButton||"Save Changes"),null===(n=this.dom.formContainer)||void 0===n||n.slideDown(),null===(a=this.dom.addButton)||void 0===a||a.hide()}},{key:"handleEdit",value:function(t){var e,i,n=this;t.preventDefault();var a=this.$(t.currentTarget),o=a.closest(this.settings.selectors.listItemRow).data("id");if(this.logger.log("Edit clicked for item ID:",o,"on tab:",this.config.mainTabId),o)if(this.isEditMode=!0,this.currentItemId=o,this.resetForm(),null===(e=this.dom.formTitle)||void 0===e||e.text(this.settings.i18n.editItemFormTitle),null===(i=this.dom.saveButton)||void 0===i||i.text(this.settings.i18n.updateChangesButton||"Update Changes"),this.settings.actions.get_item)this.showFormLoadingSpinner(!0,this.dom.saveButton),p({url:this.settings.ajaxUrl,data:{action:this.settings.actions.get_item,nonce:this.settings.nonce,item_id:o,option_name:this.settings.option_name,tab_id:this.settings.tab_id}}).then((function(t){if(t.success&&t.data&&t.data.item){var e,i;n.populateFormWithData(t.data.item),null===(e=n.dom.formContainer)||void 0===e||e.slideDown(),null===(i=n.dom.addButton)||void 0===i||i.hide()}else{var a=t.data&&t.data.message||n.settings.i18n.errorLoadingItem||"Error loading item details.";n.showNotice(a,"error"),n.logger.error("Error loading item details for editing:",t)}})).catch((function(t){n.showNotice(t.message||n.settings.i18n.errorLoadingItem,"error"),n.logger.error("AJAX error loading item for editing:",t)})).finally((function(){n.showFormLoadingSpinner(!1,n.dom.saveButton)}));else{var r,s;this.logger.log("No get_item action defined, attempting to populate from button data attributes for tab:",this.config.mainTabId);var d=a.data();d.id=o,this.populateFormWithData(d),null===(r=this.dom.formContainer)||void 0===r||r.slideDown(),null===(s=this.dom.addButton)||void 0===s||s.hide()}else this.logger.error("Could not find item ID for editing on tab:",this.config.mainTabId)}},{key:"handleDelete",value:function(t){var e=this;t.preventDefault();var i=this.$(t.currentTarget),n=i.closest(this.settings.selectors.listItemRow),a=n.data("id");if(this.logger.log("Delete clicked for item ID:",a,"on tab:",this.config.mainTabId),a){if(confirm(this.settings.i18n.confirmDelete)){var o=i.text();i.prop("disabled",!0).text(this.settings.i18n.deleting),p({url:this.settings.ajaxUrl,data:{action:this.settings.actions.delete_item,nonce:this.settings.nonce,item_id:a,option_name:this.settings.option_name,tab_id:this.settings.tab_id}}).then((function(t){t.success?(e.showNotice(t.data&&t.data.message||e.settings.i18n.itemDeletedSuccess,"success"),n.fadeOut(300,(function(){n.remove(),e.updateNoItemsMessageVisibility()}))):(e.showNotice(t.data&&t.data.message||e.settings.i18n.errorDeletingItem,"error"),i.prop("disabled",!1).text(o))})).catch((function(t){e.showNotice(t.message||e.settings.i18n.errorDeletingItem,"error"),e.logger.error("AJAX error deleting item:",t),i.prop("disabled",!1).text(o)}))}}else this.logger.error("Could not find item ID for deletion on tab:",this.config.mainTabId)}},{key:"handleSubmit",value:function(t){var e=this;if(t.preventDefault(),this.logger.log("Form submitted for tab:",this.config.mainTabId,"Edit mode:",this.isEditMode,"Item ID:",this.currentItemId),this.validateForm()){var i=this.isEditMode?this.settings.actions.update_item:this.settings.actions.add_item;if(!i)return this.logger.error("Form submission action (add_item or update_item) is not defined in settings.actions for tab:",this.config.mainTabId),this.showNotice(this.settings.i18n.errorSavingItem||"Configuration error: Save action not defined.","error"),void this.showFormLoadingSpinner(!1,this.dom.saveButton);var n={action:i,nonce:this.settings.nonce,option_name:this.settings.option_name,tab_id:this.settings.tab_id,item_data:{}};this.dom.form.serializeArray().forEach((function(t){var e=t.name,i=t.value;if(e.endsWith("[]")){var a=e.slice(0,-2);n.item_data[a]||(n.item_data[a]=[]),n.item_data[a].push(i)}else n.item_data[e]=i})),this.isEditMode&&this.currentItemId&&(n.item_id=this.currentItemId,this.dom.idInput&&n.item_data.hasOwnProperty(this.dom.idInput.attr("name"))&&delete n.item_data[this.dom.idInput.attr("name")]),this.logger.log("AJAX data payload for save:",n),this.showFormLoadingSpinner(!0,this.dom.saveButton),p({url:this.settings.ajaxUrl,data:n}).then((function(t){if(e.logger.log("AJAX save response received:",t),t&&t.item){var i,n;e.showNotice(t.message||e.settings.i18n.itemSavedSuccess,"success"),e.isEditMode?e.updateTableRow(t.item):e.addTableRow(t.item),null===(i=e.dom.formContainer)||void 0===i||i.slideUp(),null===(n=e.dom.addButton)||void 0===n||n.show(),e.resetForm(),e.updateNoItemsMessageVisibility(),e.formModified=!1}else{var a=t&&t.message?t.message:e.settings.i18n.errorSavingItem,o=t&&t.errors?"<br><pre>".concat(JSON.stringify(t.errors,null,2),"</pre>"):"";e.showNotice(a+o,"error"),e.logger.error("Error saving item or item data missing in successful-looking response structure:",t)}})).catch((function(t){var i=t.message||e.settings.i18n.errorSavingItem;e.showNotice(i,"error"),e.logger.error("AJAX error during save operation:",t)})).finally((function(){e.showFormLoadingSpinner(!1,e.dom.saveButton)})).finally((function(){e.showFormLoadingSpinner(!1,e.dom.saveButton)}))}else this.logger.warn("Form validation failed for tab:",this.config.mainTabId)}},{key:"handleCancel",value:function(t){var e,i;t.preventDefault(),this.logger.log("Cancel form clicked for tab:",this.config.mainTabId),null===(e=this.dom.formContainer)||void 0===e||e.slideUp(),null===(i=this.dom.addButton)||void 0===i||i.show(),this.resetForm()}},{key:"resetForm",value:function(){var t,e,i;null===(t=this.dom.form[0])||void 0===t||t.reset(),this.dom.idInput&&this.dom.idInput.length&&this.dom.idInput.val(""),this.isEditMode=!1,this.currentItemId=null,this.formModified=!1,null===(e=this.dom.form)||void 0===e||e.find(".error").removeClass("error"),null===(i=this.dom.form)||void 0===i||i.find(".field-error").remove(),this.logger.log("Form reset for tab:",this.config.mainTabId)}},{key:"populateFormWithData",value:function(t){this.logger.log("Populating form with data for tab:",this.config.mainTabId,t),t.id&&this.dom.idInput&&this.dom.idInput.length&&this.dom.idInput.val(t.id)}},{key:"validateForm",value:function(){var t,e,i,n=this;this.logger.log("Validating form (base method) for tab:",this.config.mainTabId);var a=!0;return null===(t=this.dom.form)||void 0===t||t.find(".error").removeClass("error"),null===(e=this.dom.form)||void 0===e||e.find(".field-error").remove(),null===(i=this.dom.form)||void 0===i||i.find(".is-required").each((function(t,e){var i=n.$(e),o=i.val();"string"==typeof o&&(o=o.trim()),(!o||i.is("select")&&!o)&&(n.showFieldError(i,n.settings.i18n.fieldRequired||"This field is required."),a=!1)})),a}},{key:"addTableRow",value:function(t){this.logger.log("Adding table row for tab:",this.config.mainTabId,t);var e=this.createTableRow(t);e&&this.dom.listTableBody&&this.dom.listTableBody.length?(this.dom.listTableBody.append(e),this.updateNoItemsMessageVisibility()):this.logger.error("Failed to add table row: createTableRow invalid or listTableBody not found for tab:",this.config.mainTabId)}},{key:"updateTableRow",value:function(t){var e;if(this.logger.log("Updating table row for tab:",this.config.mainTabId,t),t.id){var i=null===(e=this.dom.listTableBody)||void 0===e?void 0:e.find("".concat(this.settings.selectors.listItemRow,'[data-id="').concat(t.id,'"]'));if(i&&i.length){var n=this.createTableRow(t);n?i.replaceWith(n):this.logger.error("Failed to update table row: createTableRow returned null for tab:",this.config.mainTabId)}else this.logger.warn("Could not find row to update with ID:",t.id,"- Appending as new for tab:",this.config.mainTabId),this.addTableRow(t)}else this.logger.error("Cannot update table row: itemData missing ID for tab:",this.config.mainTabId,t)}},{key:"createTableRow",value:function(t){return this.logger.error("createTableRow() must be implemented by the child class.",t),null}},{key:"updateNoItemsMessageVisibility",value:function(){if(this.dom.noItemsMessage&&this.dom.noItemsMessage.length&&this.dom.listTableBody&&this.dom.listTable){var t=this.dom.listTableBody.find(this.settings.selectors.listItemRow).length>0;t?(this.dom.noItemsMessage.hide(),this.dom.listTable.show()):(this.dom.noItemsMessage.show(),this.dom.listTable.hide()),this.logger.log('"No items" message visibility updated for tab:',this.config.mainTabId,"Has items:",t)}else this.logger.warn('Cannot update "no items" message visibility: DOM elements missing for tab:',this.config.mainTabId)}},{key:"showNotice",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice?window.ProductEstimatorSettings.showNotice(t,e):k(t,e)}},{key:"showFieldError",value:function(t,i){if(window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showFieldError)window.ProductEstimatorSettings.showFieldError(t,i);else if(e)E(t,i);else{this.clearFieldError(t);var n=this.$('<span class="field-error">'.concat(i,"</span>"));t.addClass("error").after(n)}}},{key:"clearFieldError",value:function(t){window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.clearFieldError?window.ProductEstimatorSettings.clearFieldError(t):e?T(t):t.removeClass("error").next(".field-error").remove()}},{key:"showFormLoadingSpinner",value:function(t,e){var i=e||this.dom.saveButton;if(i&&i.length)if(t){i.prop("disabled",!0).addClass("pe-loading"),i.data("original-text")||i.data("original-text",i.text()||i.val());var n=this.settings.i18n&&this.settings.i18n.saving||"Saving...";i.is("input")?i.val(n):i.text(n)}else i.prop("disabled",!1).removeClass("pe-loading"),i.data("original-text")&&(i.is("input")?i.val(i.data("original-text")):i.text(i.data("original-text")))}}])}());jQuery(document).ready((function(t){var e="product_additions",i="productAdditionsSettings",n=function(){if(window.ProductEstimatorSettings&&window.ProductEstimatorSettings.currentTab===e)if(window[i]){if(!window.ProductAdditionsTableManagerInstance)try{window.ProductAdditionsTableManagerInstance=new ot,j("ProductAdditionsInit").log("ProductAdditionsSettingsModule instance initiated.")}catch(t){j("ProductAdditionsInit").error("Error instantiating ProductAdditionsSettingsModule:",t),window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice&&window.ProductEstimatorSettings.showNotice("Failed to initialize Product Additions settings. Check console for errors.","error")}}else j("ProductAdditionsInit").error('Localized data object "'.concat(i,'" not found for tab: ').concat(e,". Cannot initialize module.")),window.ProductEstimatorSettings&&"function"==typeof window.ProductEstimatorSettings.showNotice&&window.ProductEstimatorSettings.showNotice('Configuration data for Product Additions ("'.concat(i,'") is missing.'),"error")};t("#".concat(e)).length?(n(),t(document).on("product_estimator_tab_changed",(function(t,i){i===e&&setTimeout(n,50)}))):j("ProductAdditionsInit").warn("Main container #".concat(e," not found. ProductAdditionsSettingsModule will not be initialized."))}));var rt=j("NetSuiteSettingsModule"),st=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.pricingRulesSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce,i18n:n.i18n,tab_id:n.tab_id},$(document).ready((function(){var t=window.similarProducts||{};e.settings.nonce=t.nonce||e.settings.nonce,e.init()}))}),[{key:"init",value:function(){rt.log("Initializing Pricing Rules Settings Module"),this.bindEvents(),this.setupFormHandling(),this.initializeDefaultSettingsForm()}},{key:"bindEvents",value:function(){jQuery(document).on("product_estimator_tab_changed",this.handleTabChanged.bind(this)),this.initRuleHandlers()}},{key:"initializeDefaultSettingsForm",value:function(){jQuery(".default-pricing-form").on("submit",(function(t){t.preventDefault(),"undefined"!=typeof ProductEstimatorSettings&&(ProductEstimatorSettings.formChanged=!0,ProductEstimatorSettings.handleAjaxFormSubmit(t))}))}},{key:"initRuleHandlers",value:function(){var t=jQuery,e=(t(".product-estimator-pricing-rules"),t("#pricing-rule-form")),i=t(".pricing-rules-form"),n=t(".add-new-rule");t("#categories").select2({placeholder:"Select categories",width:"100%",dropdownCssClass:"product-estimator-dropdown"}),n.on("click",function(){rt.log("Add New Pricing Rule button clicked"),this.resetForm(),t(".form-title").text(this.settings.i18n.addNew||"Add New Pricing Rule"),t(".save-rule").text(this.settings.i18n.saveChanges||"Save Changes"),i.slideDown()}.bind(this)),t(".cancel-form").on("click",function(){i.slideUp(),this.resetForm()}.bind(this)),e.on("submit",this.handleFormSubmission.bind(this)),t(".pricing-rules-list").on("click",".edit-rule",this.handleEditRule.bind(this)),t(".pricing-rules-list").on("click",".delete-rule",this.handleDeleteRule.bind(this))}},{key:"setupFormHandling",value:function(){}},{key:"handleTabChanged",value:function(t,e){e===this.settings.tab_id&&this.init()}},{key:"resetForm",value:function(){var t=jQuery;t("#pricing-rule-form")[0].reset(),t("#rule_id").val(""),t("#categories").val(null).trigger("change")}},{key:"toggleFormState",value:function(t){var e=jQuery,i=e("#pricing-rule-form"),n=i.find(".save-rule"),a=i.find(".cancel-form");i.find("input, select").prop("disabled",!t),n.prop("disabled",!t),a.prop("disabled",!t),t?n.text(e("#rule_id").val()?"Update Pricing Rule":"Save Pricing Rule"):n.text("Saving..."),t?e("#categories").prop("disabled",!1).trigger("change"):e("#categories").prop("disabled",!0).trigger("change")}},{key:"handleFormSubmission",value:function(t){var e=this;t.preventDefault();var i=jQuery,n=i("#categories").val(),a=i("#pricing_method").val(),o=i("#pricing_source").val();if(n&&0!==n.length)if(a)if(o){this.toggleFormState(!1);var r={action:"save_pricing_rule",nonce:this.settings.nonce,rule_id:i("#rule_id").val(),categories:n,pricing_method:a,pricing_source:o};rt.log("Sending form data:",r),p({url:this.settings.ajaxUrl,data:r}).then((function(t){if(rt.log("Response received:",t),e.showMessage("success",t.message),r.rule_id){rt.log("Updating existing rule:",r.rule_id);var n=i(".pricing-rules-list").find('tr[data-id="'.concat(r.rule_id,'"]'));n.length?n.replaceWith(e.createRuleRow(t.rule)):e.appendRuleRow(t.rule)}else e.appendRuleRow(t.rule);i(".pricing-rules-form").slideUp(),e.resetForm();var a=i(".pricing-rules-list").find(".no-items");if(a.length&&(a.remove(),!i(".pricing-rules-list").find("table").length)){var o='\n              <table class="wp-list-table widefat fixed striped pricing-rules-table">\n                <thead>\n                  <tr>\n                    <th scope="col">'.concat("Categories",'</th>\n                    <th scope="col">',"Pricing Method",'</th>\n                    <th scope="col">',"Actions","</th>\n                  </tr>\n                </thead>\n                <tbody></tbody>\n              </table>\n            ");i(".pricing-rules-list").find("h3").after(o)}})).catch((function(t){e.showMessage("error",t.message||"Error saving pricing rule. Please try again."),rt.error("Error saving pricing rule:",t)})).finally((function(){e.toggleFormState(!0)}))}else alert(this.settings.i18n.selectPricingSource||"Please select a pricing source");else alert(this.settings.i18n.selectPricingMethod||"Please select a pricing method");else alert(this.settings.i18n.selectCategories||"Please select at least one category")}},{key:"handleEditRule",value:function(t){var e=jQuery,i=e(t.currentTarget),n=i.data("id"),a=String(i.data("categories")).split(","),o=i.data("method"),r=i.data("source");rt.log("Edit rule:",n,a,o,r),this.resetForm(),e("#rule_id").val(n),e("#pricing_method").val(o),e("#pricing_source").val(r),setTimeout((function(){e("#categories").val(a).trigger("change")}),100),e(".form-title").text("Edit Pricing Rule"),e(".save-rule").text("Update Pricing Rule"),e(".pricing-rules-form").slideDown(),e("html, body").animate({scrollTop:e(".pricing-rules-form").offset().top-50},300)}},{key:"handleDeleteRule",value:function(t){var e=this,i=jQuery,n=i(t.currentTarget),a=n.data("id");rt.log("Delete rule:",a),confirm(this.settings.i18n.confirmDelete||"Are you sure you want to delete this pricing rule?")&&(n.prop("disabled",!0).text("Deleting..."),p({url:this.settings.ajaxUrl,data:{action:"delete_pricing_rule",nonce:this.settings.nonce,rule_id:a}}).then((function(t){rt.log("Delete response:",t);var a=n.closest("tr");a.fadeOut(300,(function(){a.remove(),i(".pricing-rules-list").find("tbody tr").length||(i(".pricing-rules-list").find("table").remove(),i(".pricing-rules-list").append('<div class="no-items">No pricing rules have been created yet.</div>'))})),e.showMessage("success",t.message)})).catch((function(t){e.showMessage("error",t.message||"Error deleting pricing rule. Please try again."),n.prop("disabled",!1).text("Delete"),rt.error("Error deleting rule:",t)})))}},{key:"createRuleRow",value:function(t){var e=jQuery,i=e("<tr></tr>").attr("data-id",t.id);i.append(e("<td></td>").text(t.category_names)),i.append(e("<td></td>").text(t.pricing_label));var n=e("<td></td>").addClass("actions"),a=v("button",{className:"button button-small edit-rule",type:"button",dataset:{id:t.id,categories:Array.isArray(t.categories)?t.categories.join(","):"",method:t.pricing_method,source:t.pricing_source}},"Edit"),o=v("button",{className:"button button-small delete-rule",type:"button",dataset:{id:t.id}},"Delete");return n.append(e(a)," ",e(o)),i.append(n),i}},{key:"appendRuleRow",value:function(t){var e=jQuery(".pricing-rules-table").find("tbody"),i=this.createRuleRow(t);e.append(i)}},{key:"showMessage",value:function(t,e){var i=jQuery,n=i(".product-estimator-pricing-rules"),a=n.find(".notice");if(a.length&&a.remove(),"undefined"==typeof ProductEstimatorSettings||"function"!=typeof ProductEstimatorSettings.showNotice){var o=v("div",{className:"notice notice-".concat("success"===t?"success":"error")}),r=v("p",{},e);o.appendChild(r),n.find("h1, h3").first().after(i(o)),setTimeout((function(){i(o).fadeOut(500,(function(){i(this).remove()}))}),5e3)}else ProductEstimatorSettings.showNotice(e,t)}}])}();jQuery(document).ready((function(){var t=jQuery("#pricing_rules");if(t.length&&t.is(":visible")){var e=new st;window.PricingRulesSettingsModule=e}else jQuery(document).on("product_estimator_tab_changed",(function(t,e){"pricing_rules"===e&&setTimeout((function(){var t=new st;window.PricingRulesSettingsModule=t}),100)}))}));var dt=j("SimilarProductsSettings"),lt=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.similarProductsSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce||"",i18n:n.i18n||{},tab_id:n.tab_id||"similar_products"},$(document).ready((function(){var t=window.similarProductsSettings||{};t.nonce&&(e.settings.nonce=t.nonce),e.init()}))}),[{key:"init",value:function(){$(".product-estimator-similar-products-settings").length&&(dt.log("Initializing Similar Products Settings Module (Class-based)"),!this.settings.nonce&&window.similarProducts&&window.similarProductsSettings.nonce?(dt.warn("Nonce was initially empty but found later. This might indicate a race condition."),this.settings.nonce=window.similarProductsSettings.nonce):this.settings.nonce||dt.error("Nonce is not available from window.similarProductsSettings. AJAX requests may fail."),this.bindEvents(),this.initializeExistingRules())}},{key:"bindEvents",value:function(){$(".add-new-rule").on("click",this.addNewRule.bind(this)),$(document).on("product_estimator_tab_changed",this.handleTabChanged.bind(this))}},{key:"handleTabChanged",value:function(t,e){e===this.settings.tab_id&&(dt.log("Tab changed to Similar Products, re-initializing rules."),this.initializeExistingRules())}},{key:"addNewRule",value:function(){var t=$(".rule-template").children().first().clone(),e="new_"+Math.random().toString(36).substr(2,9);t.attr("data-rule-id",e),t.find('[name^="TEMPLATE_ID"]').each((function(t,i){var n=$(i).attr("name").replace("TEMPLATE_ID",e);$(i).attr("name",n)})),$(".similar-products-rules").append(t),$(".no-rules-message").hide(),this.initializeRule(t),t.addClass("open")}},{key:"initializeExistingRules",value:function(){var t=this;$(".similar-products-rule").each((function(e,i){t.initializeRule($(i))}))}},{key:"initializeRule",value:function(t){var e=this,i=t.data("rule-id");t.find(".rule-header").off("click").on("click",(function(e){$(e.target).is(".delete-rule, .save-rule")||$(e.target).parent().is(".delete-rule, .save-rule")||t.toggleClass("open")}));var n=t.find(".source-categories-select");$.fn.select2&&n.select2({width:"100%",placeholder:"Select categories",allowClear:!0,closeOnSelect:!1}),n.off("change").on("change",(function(i){var n=$(i.target).val();n&&n.length>0?e.loadCategoryAttributes(n,t):t.find(".attributes-list").empty().html("<p>".concat(e.settings.select_category,"</p>"))})),t.find(".delete-rule").off("click").on("click",(function(n){n.preventDefault(),n.stopPropagation(),confirm(e.settings.confirm_delete)&&e.deleteRule(i,t)})),t.find(".save-rule").off("click").on("click",(function(n){n.preventDefault(),n.stopPropagation(),e.saveRule(i,t)}));var a=n.val();a&&a.length>0?this.loadCategoryAttributes(a,t):t.find(".attributes-list").empty().html("<p>".concat(this.settings.select_category,"</p>"))}},{key:"loadCategoryAttributes",value:function(t,e){var i=this,n=e.find(".attributes-list");n.html("<p>".concat(this.settings.loading_attributes,"</p>")).addClass("loading"),$.ajax({url:this.settings.ajaxUrl,type:"POST",dataType:"json",data:{action:"get_category_attributes",nonce:this.settings.nonce,category_ids:t},success:function(t){t.success?i.renderAttributes(t.data.attributes,e):(n.html('<p class="error">'.concat(t.data.message||i.settings.error_loading,"</p>")).removeClass("loading"),dt.error("Error loading attributes:",t))},error:function(t,e,a){n.html('<p class="error">'.concat(i.settings.error_loading,"</p>")).removeClass("loading"),dt.error("AJAX error loading attributes:",e,a)}})}},{key:"renderAttributes",value:function(t,e){var i=e.find(".attributes-list");if(i.empty().removeClass("loading"),t&&0!==t.length){var n=e.data("rule-id"),a="";t.forEach((function(t){var e=t.is_selected||!1;a+='<div class="attribute-item">\n                 <label>\n                   <input type="checkbox" name="'.concat(n,'[attributes][]" value="').concat(t.name,'"').concat(e?" checked":"",">\n                   <span>").concat(t.label,"</span>\n                 </label>\n               </div>")})),i.html(a)}else i.html("<p>".concat(this.settings.no_attributes,"</p>"))}},{key:"saveRule",value:function(t,e){var i=this,n=e.find(".save-rule"),a=n.text(),o=e.find(".source-categories-select").val();if(o&&0!==o.length){var r=[];e.find('.attributes-list input[type="checkbox"]:checked').each((function(t,e){r.push($(e).val())})),0!==r.length?(n.text(this.settings.saving).prop("disabled",!0),$.ajax({url:this.settings.ajaxUrl,type:"POST",dataType:"json",data:{action:"save_similar_products_rule",nonce:this.settings.nonce,rule_id:t,source_categories:o,attributes:r},success:function(n){if(n.success){if(i.showMessage(e,i.settings.rule_saved,"success"),t.startsWith("new_")&&n.data.rule_id){var a=n.data.rule_id;e.attr("data-rule-id",a),e.find('[name^="'.concat(t,'"]')).each((function(e,i){var n=$(i).attr("name").replace(t,a);$(i).attr("name",n)}))}var r=[];o.forEach((function(t){var i=e.find('.source-categories-select option[value="'.concat(t,'"]')).text();i&&r.push(i)})),e.find(".rule-title").text(r.length>0?r.join(", "):"Rule"),dt.log("Rule saved successfully",n.data)}else i.showMessage(e,n.data.message||i.settings.error_saving,"error"),dt.error("Error saving rule:",n)},error:function(t,n,a){i.showMessage(e,i.settings.error_saving,"error"),dt.error("AJAX error saving rule:",n,a)},complete:function(){n.text(a).prop("disabled",!1)}})):this.showMessage(e,this.settings.select_attributes_error,"error")}else this.showMessage(e,this.settings.select_category_error,"error")}},{key:"deleteRule",value:function(t,e){var i=this;if(t.startsWith("new_"))return e.remove(),void(0===$(".similar-products-rule").length&&$(".no-rules-message").show());$.ajax({url:this.settings.ajaxUrl,type:"POST",dataType:"json",data:{action:"delete_similar_products_rule",nonce:this.settings.nonce,rule_id:t},success:function(t){t.success?(e.remove(),0===$(".similar-products-rule").length&&$(".no-rules-message").show(),dt.log("Rule deleted successfully")):(i.showMessage(e,t.data.message||i.settings.error_deleting,"error"),dt.error("Error deleting rule:",t))},error:function(t,n,a){i.showMessage(e,i.settings.error_deleting,"error"),dt.error("AJAX error deleting rule:",n,a)}})}},{key:"showMessage",value:function(t,e,i){var n=$("<div>",{class:"rule-message ".concat(i),text:e});t.find(".rule-message").remove(),t.find(".rule-header").after(n),setTimeout((function(){n.fadeOut(300,(function(){this.remove()}))}),3e3)}}])}();jQuery(document).ready((function(){if(jQuery("#similar_products").length||jQuery(".product-estimator-similar-products-settings").length){var t=new lt;window.SimilarProductsSettingsModuleInstance=t}}));var ct=j("ProductUpgradesSettings"),ut=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.productUpgradesSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce||"",i18n:n.i18n||{},tab_id:n.tab_id||"product_upgrades"},this.formModified=!1,$(document).ready((function(){var t=window.productUpgradesSettings||{};t.nonce&&(e.settings.nonce=t.nonce),e.init()}))}),[{key:"init",value:function(){ct.log("Initializing Product Upgrades Settings Module"),this.formModified=!1,this.bindEvents(),this.setupFormHandling()}},{key:"bindEvents",value:function(){var t=this,e=jQuery;e(document).on("product_estimator_tab_changed",this.handleTabChanged.bind(this)),this.initUpgradeHandlers(),e("#product-upgrade-form").on("change input","input, select, textarea",(function(){t.formModified=!0,"undefined"!=typeof ProductEstimatorSettings&&void 0!==ProductEstimatorSettings.formChangeTrackers&&(ProductEstimatorSettings.formChangeTrackers[t.settings.tab_id]=!0,ProductEstimatorSettings.currentTab===t.settings.tab_id&&(ProductEstimatorSettings.formChanged=!0))}))}},{key:"initUpgradeHandlers",value:function(){var t=jQuery,e=(t(".product-estimator-upgrades"),t("#product-upgrade-form")),i=t(".product-upgrades-form"),n=t(".add-new-upgrade");t("#base_categories").select2({placeholder:"Select base categories",width:"100%",dropdownCssClass:"product-estimator-dropdown"}),t("#upgrade_categories").select2({placeholder:"Select upgrade categories",width:"100%",dropdownCssClass:"product-estimator-dropdown"}),n.on("click",function(){ct.log("Add New Upgrade Configuration button clicked"),this.resetForm(),t(".form-title").text(this.settings.i18n.addNew||"Add New Upgrade Configuration"),t(".save-upgrade").text(this.settings.i18n.saveChanges||"Save Changes"),i.slideDown()}.bind(this)),t(".cancel-form").on("click",function(){i.slideUp(),this.resetForm()}.bind(this)),e.on("submit",this.handleFormSubmission.bind(this)),t(".product-upgrades-list").on("click",".edit-upgrade",this.handleEditUpgrade.bind(this)),t(".product-upgrades-list").on("click",".delete-upgrade",this.handleDeleteUpgrade.bind(this))}},{key:"setupFormHandling",value:function(){}},{key:"handleTabChanged",value:function(t,e){e===this.settings.tab_id&&(this.formModified=!1,this.init(),"undefined"!=typeof ProductEstimatorSettings&&void 0!==ProductEstimatorSettings.formChangeTrackers&&(ProductEstimatorSettings.formChangeTrackers[this.settings.tab_id]=!1,ProductEstimatorSettings.currentTab===this.settings.tab_id&&(ProductEstimatorSettings.formChanged=!1)))}},{key:"resetForm",value:function(){var t=jQuery;t("#product-upgrade-form")[0].reset(),t("#upgrade_id").val(""),t("#base_categories").val(null).trigger("change"),t("#upgrade_categories").val(null).trigger("change"),t("#display_mode").val("dropdown").trigger("change"),t("#upgrade_title").val(""),t("#upgrade_description").val(""),this.formModified=!1,"undefined"!=typeof ProductEstimatorSettings&&void 0!==ProductEstimatorSettings.formChangeTrackers&&(ProductEstimatorSettings.formChangeTrackers[this.settings.tab_id]=!1,ProductEstimatorSettings.currentTab===this.settings.tab_id&&(ProductEstimatorSettings.formChanged=!1))}},{key:"toggleFormState",value:function(t){var e=jQuery,i=e("#product-upgrade-form"),n=i.find(".save-upgrade"),a=i.find(".cancel-form");i.find("input, select, textarea").prop("disabled",!t),n.prop("disabled",!t),a.prop("disabled",!t),t?n.text(e("#upgrade_id").val()?"Update Configuration":"Save Configuration"):n.text("Saving..."),t?(e("#base_categories").prop("disabled",!1).trigger("change"),e("#upgrade_categories").prop("disabled",!1).trigger("change")):(e("#base_categories").prop("disabled",!0).trigger("change"),e("#upgrade_categories").prop("disabled",!0).trigger("change"))}},{key:"handleFormSubmission",value:function(t){var e=this;t.preventDefault();var i=jQuery,n=i("#base_categories").val(),a=i("#upgrade_categories").val(),o=i("#display_mode").val(),r=i("#upgrade_title").val(),s=i("#upgrade_description").val();if(n&&0!==n.length)if(a&&0!==a.length){this.toggleFormState(!1);var d={action:"save_product_upgrade",nonce:this.settings.nonce,upgrade_id:i("#upgrade_id").val(),base_categories:n,upgrade_categories:a,display_mode:o,upgrade_title:r,upgrade_description:s};ct.log("Sending form data:",d),p({url:this.settings.ajaxUrl,data:d}).then((function(t){if(ct.log("Response received:",t),e.showMessage("success",t.message),d.upgrade_id){ct.log("Updating existing upgrade:",d.upgrade_id);var n=i(".product-upgrades-list").find('tr[data-id="'.concat(d.upgrade_id,'"]'));n.length?n.replaceWith(e.createUpgradeRow(t.upgrade)):e.appendUpgradeRow(t.upgrade)}else e.appendUpgradeRow(t.upgrade);i(".product-upgrades-form").slideUp(),e.resetForm();var a=i(".product-upgrades-list").find(".no-items");if(a.length&&(a.remove(),!i(".product-upgrades-list").find("table").length)){var o='\n              <table class="wp-list-table widefat fixed striped product-upgrades-table">\n                <thead>\n                  <tr>\n                    <th scope="col">'.concat("Base Categories",'</th>\n                    <th scope="col">',"Upgrade Categories",'</th>\n                    <th scope="col">',"Display Mode",'</th>\n                    <th scope="col">',"Actions","</th>\n                  </tr>\n                </thead>\n                <tbody></tbody>\n              </table>\n            ");i(".product-upgrades-list").find("h3").after(o)}e.formModified=!1,"undefined"!=typeof ProductEstimatorSettings&&void 0!==ProductEstimatorSettings.formChangeTrackers&&(ProductEstimatorSettings.formChangeTrackers[e.settings.tab_id]=!1,ProductEstimatorSettings.currentTab===e.settings.tab_id&&(ProductEstimatorSettings.formChanged=!1))})).catch((function(t){e.showMessage("error",t.message||"Error saving upgrade configuration. Please try again."),ct.error("Error saving upgrade configuration:",t)})).finally((function(){e.toggleFormState(!0)}))}else alert(this.settings.i18n.selectUpgradeCategories||"Please select at least one upgrade category");else alert(this.settings.i18n.selectBaseCategories||"Please select at least one base category")}},{key:"handleEditUpgrade",value:function(t){var e=jQuery,i=e(t.currentTarget),n=i.data("id"),a=String(i.data("base")||"").split(",").filter(Boolean),o=String(i.data("upgrade")||"").split(",").filter(Boolean),r=i.data("mode"),s=i.data("title"),d=i.data("description");ct.log("Edit upgrade:",n,a,o,r,s,d),this.resetForm(),e("#upgrade_id").val(n),e("#display_mode").val(r||"dropdown").trigger("change"),e("#upgrade_title").val(s||""),e("#upgrade_description").val(d||""),setTimeout((function(){e("#base_categories").val(a).trigger("change"),e("#upgrade_categories").val(o).trigger("change")}),100),e(".form-title").text("Edit Upgrade Configuration"),e(".save-upgrade").text("Update Configuration"),e(".product-upgrades-form").slideDown(),e("html, body").animate({scrollTop:e(".product-upgrades-form").offset().top-50},300)}},{key:"handleDeleteUpgrade",value:function(t){var e=this,i=jQuery,n=i(t.currentTarget),a=n.data("id");if(ct.log("Delete upgrade:",a),confirm(this.settings.i18n.confirmDelete||"Are you sure you want to delete this upgrade configuration?")){n.prop("disabled",!0).text("Deleting...");var o={action:"delete_product_upgrade",nonce:this.settings.nonce,upgrade_id:a};p({url:this.settings.ajaxUrl,data:o}).then((function(t){ct.log("Delete response:",t);var a=n.closest("tr");a.fadeOut(300,(function(){a.remove(),i(".product-upgrades-list").find("tbody tr").length||(i(".product-upgrades-list").find("table").remove(),i(".product-upgrades-list").append('<div class="no-items">No upgrade configurations have been created yet.</div>'))})),e.showMessage("success",t.message)})).catch((function(t){e.showMessage("error",t.message||"Error deleting upgrade configuration. Please try again."),n.prop("disabled",!1).text("Delete"),ct.error("Error deleting upgrade configuration:",t)}))}}},{key:"createUpgradeRow",value:function(t){var e=jQuery;if(!t||!t.id)return ct.log("Invalid upgrade data",t),e('<tr><td colspan="4">Error: Invalid upgrade data</td></tr>');var i=e("<tr></tr>").attr("data-id",t.id),n=t.base_category_names||"";i.append(e("<td></td>").text(n));var a=t.upgrade_category_names||"";i.append(e("<td></td>").text(a));var o={dropdown:"Dropdown",radio:"Radio Buttons",tiles:"Image Tiles"}[t.display_mode]||"Dropdown";i.append(e("<td></td>").text(o));var r=e("<td></td>").addClass("actions"),s=v("button",{className:"button button-small edit-upgrade",type:"button",dataset:{id:t.id,base:Array.isArray(t.base_categories)?t.base_categories.join(","):"",upgrade:Array.isArray(t.upgrade_categories)?t.upgrade_categories.join(","):"",mode:t.display_mode||"dropdown",title:t.title||"",description:t.description||""}},"Edit"),d=v("button",{className:"button button-small delete-upgrade",type:"button",dataset:{id:t.id}},"Delete");return r.append(e(s)," ",e(d)),i.append(r),i}},{key:"appendUpgradeRow",value:function(t){var e=jQuery;if(t&&t.id){var i=e(".product-upgrades-table");if(i.length){var n=i.find("tbody");if(n.length){var a=this.createUpgradeRow(t);n.append(a)}else ct.log("Cannot append row: Table body not found")}else ct.log("Cannot append row: Table not found")}else ct.log("Cannot append row: Invalid upgrade data",t)}},{key:"showMessage",value:function(t,e){var i=jQuery(".product-estimator-upgrades");if(i.length){var n=i.find(".notice");n.length&&n.remove(),"undefined"==typeof ProductEstimatorSettings||"function"!=typeof ProductEstimatorSettings.showNotice?k(e,t):ProductEstimatorSettings.showNotice(e,t)}else ct.log("Cannot show notice: Container not found")}}])}();function gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gt=function(){return!!t})()}function ht(t,e,i,n){var a=V(L(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof a?function(t){return a.apply(i,t)}:a}jQuery(document).ready((function(){var t=jQuery("#product_upgrades");if(t.length&&t.is(":visible")){var e=new ut;window.ProductUpgradesSettingsModule=e}else jQuery(document).on("product_estimator_tab_changed",(function(t,e){"product_upgrades"===e&&setTimeout((function(){var t=new ut;window.ProductUpgradesSettingsModule=t}),100)}))}));var ft=j("LabelSettings"),mt=function(t){function e(){return i(this,e),t=this,a=[{mainTabId:"labels",defaultSubTabId:"labels-general",ajaxActionPrefix:"save_labels",localizedDataName:"labelSettings"}],n=L(n=e),B(t,gt()?Reflect.construct(n,a||[],L(t).constructor):n.apply(t,a));var t,n,a}return q(e,t),r(e,[{key:"bindModuleSpecificEvents",value:function(){ht(e,"bindModuleSpecificEvents",this,3)([]),this.$container&&this.$container.length&&(jQuery,ft.log("LabelSettingsModule specific events bound (if any)."))}},{key:"onMainTabActivated",value:function(){ht(e,"onMainTabActivated",this,3)([]),ft.log("Labels main tab activated - specific setup can go here.")}}])}(G);jQuery(document).ready((function(){jQuery("#labels").length&&(window.ProductEstimatorLabelSettingsModule=new mt)}));var pt=j("FeatureSwitchSettings"),vt=function(){return r((function t(){var e=this;i(this,t),$=jQuery;var n=window.featureSwitchesSettings||{};this.settings={ajaxUrl:n.ajaxUrl||("undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php"),nonce:n.nonce||"",i18n:n.i18n||{},tab_id:n.tab_id||"feature_switches"},$(document).ready((function(){var t=window.featureSwitchesSettings||{};t.nonce&&(e.settings.nonce=t.nonce),e.init()}))}),[{key:"init",value:function(){pt.log("Initializing Feature Switches Settings Module"),this.bindEvents()}},{key:"bindEvents",value:function(){jQuery(document).on("product_estimator_tab_changed",this.handleTabChanged.bind(this))}},{key:"handleTabChanged",value:function(t,e){e===this.settings.tab_id&&pt.log("Feature Switches tab activated")}}])}();jQuery(document).ready((function(){jQuery("#feature_switches").length&&new vt})),console.log("Product Estimator Admin initialized")})();
//# sourceMappingURL=product-estimator-admin.bundle.js.map