(()=>{var t={16:(t,e,o)=>{"use strict";o(7081)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),o(217))},24:(t,e,o)=>{"use strict";o(9363),o(4944);var r=o(2046);t.exports=r.Object.fromEntries},30:(t,e,o)=>{"use strict";o(4729);var r=o(2046);t.exports=r.Object.entries},36:(t,e,o)=>{"use strict";o(1091)({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:o(9197)})},43:(t,e,o)=>{"use strict";var r=o(4018),n=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i("Can't set "+n(t)+" as a prototype")}},70:(t,e,o)=>{"use strict";var r=o(1661);t.exports=r},106:(t,e,o)=>{"use strict";var r=o(1091),n=o(4002);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("isSupersetOf",(function(t){return!t}))},{isSupersetOf:n})},154:(t,e,o)=>{"use strict";var r=o(3930),n=o(6624),i=o(9367);t.exports=function(t,e,o){var s,a;n(t);try{if(!(s=i(t,"return"))){if("throw"===e)throw o;return o}s=r(s,t)}catch(t){a=!0,s=t}if("throw"===e)throw o;if(a)throw s;return n(s),o}},160:(t,e,o)=>{"use strict";var r=o(3948),n=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return n(t)}},179:(t,e,o)=>{"use strict";var r=o(1091),n=o(9447),i=o(1042),s=o(7374),a=o(3846),c=o(5543);r({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(t){for(var e,o,r=s(t),n=a.f,l=i(r),u={},d=0;l.length>d;)void 0!==(o=n(r,e=l[d++]))&&c(u,e,o);return u}})},183:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(7376),s=o(6833),a=o(2250),c=o(7181),l=o(5972),u=o(9192),d=o(4840),m=o(1626),h=o(8055),f=o(6264),p=o(3742),v=o(5116),g=s.PROPER,y=s.CONFIGURABLE,w=v.IteratorPrototype,b=v.BUGGY_SAFARI_ITERATORS,E=f("iterator"),S="keys",x="values",k="entries",L=function(){return this};t.exports=function(t,e,o,s,f,v,_){c(o,e,s);var P,C,I,F=function(t){if(t===f&&O)return O;if(!b&&t&&t in A)return A[t];switch(t){case S:case x:case k:return function(){return new o(this,t)}}return function(){return new o(this)}},D=e+" Iterator",R=!1,A=t.prototype,T=A[E]||A["@@iterator"]||f&&A[f],O=!b&&T||F(f),q="Array"===e&&A.entries||T;if(q&&(P=l(q.call(new t)))!==Object.prototype&&P.next&&(i||l(P)===w||(u?u(P,w):a(P[E])||h(P,E,L)),d(P,D,!0,!0),i&&(p[D]=L)),g&&f===x&&T&&T.name!==x&&(!i&&y?m(A,"name",x):(R=!0,O=function(){return n(T,this)})),f)if(C={values:F(x),keys:v?O:F(S),entries:F(k)},_)for(I in C)(b||R||!(I in A))&&h(A,I,C[I]);else r({target:e,proto:!0,forced:b||R},C);return i&&!_||A[E]===O||h(A,E,O,{name:f}),p[e]=O,C}},217:(t,e,o)=>{"use strict";var r=o(8075),n=o(9251),i=o(2802),s=o(8311),a=o(9596),c=o(7136),l=o(4823),u=o(183),d=o(9550),m=o(7118),h=o(9447),f=o(1548).fastKey,p=o(4932),v=p.set,g=p.getterFor;t.exports={getConstructor:function(t,e,o,u){var d=t((function(t,n){a(t,m),v(t,{type:e,index:r(null),first:null,last:null,size:0}),h||(t.size=0),c(n)||l(n,t[u],{that:t,AS_ENTRIES:o})})),m=d.prototype,p=g(e),y=function(t,e,o){var r,n,i=p(t),s=w(t,e);return s?s.value=o:(i.last=s={index:n=f(e,!0),key:e,value:o,previous:r=i.last,next:null,removed:!1},i.first||(i.first=s),r&&(r.next=s),h?i.size++:t.size++,"F"!==n&&(i.index[n]=s)),t},w=function(t,e){var o,r=p(t),n=f(e);if("F"!==n)return r.index[n];for(o=r.first;o;o=o.next)if(o.key===e)return o};return i(m,{clear:function(){for(var t=p(this),e=t.first;e;)e.removed=!0,e.previous&&(e.previous=e.previous.next=null),e=e.next;t.first=t.last=null,t.index=r(null),h?t.size=0:this.size=0},delete:function(t){var e=this,o=p(e),r=w(e,t);if(r){var n=r.next,i=r.previous;delete o.index[r.index],r.removed=!0,i&&(i.next=n),n&&(n.previous=i),o.first===r&&(o.first=n),o.last===r&&(o.last=i),h?o.size--:e.size--}return!!r},forEach:function(t){for(var e,o=p(this),r=s(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:o.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!w(this,t)}}),i(m,o?{get:function(t){var e=w(this,t);return e&&e.value},set:function(t,e){return y(this,0===t?0:t,e)}}:{add:function(t){return y(this,t=0===t?0:t,t)}}),h&&n(m,"size",{configurable:!0,get:function(){return p(this).size}}),d},setStrong:function(t,e,o){var r=e+" Iterator",n=g(e),i=g(r);u(t,e,(function(t,e){v(this,{type:r,target:t,state:n(t),kind:e,last:null})}),(function(){for(var t=i(this),e=t.kind,o=t.last;o&&o.removed;)o=o.previous;return t.target&&(t.last=o=o?o.next:t.state.first)?d("keys"===e?o.key:"values"===e?o.value:[o.key,o.value],!1):(t.target=null,d(void 0,!0))}),o?"entries":"values",!o,!0),m(e)}}},237:()=>{},300:(t,e,o)=>{"use strict";var r=o(3930),n=o(2159),i=o(6624),s=o(4640),a=o(3448),c=TypeError;t.exports=function(t,e){var o=arguments.length<2?a(t):e;if(n(o))return i(r(o,t));throw new c(s(t)+" is not iterable")}},303:(t,e,o)=>{"use strict";var r=o(8280),n=o(5265),i=Array.prototype;t.exports=function(t){var e=t.slice;return t===i||r(i,t)&&e===i.slice?n:e}},317:(t,e,o)=>{"use strict";o(6648),o(9721);var r=o(2046),n=o(6024);r.JSON||(r.JSON={stringify:JSON.stringify}),t.exports=function(t,e,o){return n(r.JSON.stringify,null,arguments)}},359:(t,e,o)=>{"use strict";o(366)("replaceAll")},366:(t,e,o)=>{"use strict";var r=o(2046),n=o(9724),i=o(560),s=o(4284).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});n(e,t)||s(e,t,{value:i.f(t)})}},376:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},470:(t,e,o)=>{"use strict";var r=o(6028),n=o(5594);t.exports=function(t){var e=r(t,"string");return n(e)?e:e+""}},473:(t,e,o)=>{"use strict";var r=o(6264)("iterator"),n=!1;try{var i=0,s={next:function(){return{done:!!i++}},return:function(){n=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){try{if(!e&&!n)return!1}catch(t){return!1}var o=!1;try{var i={};i[r]=function(){return{next:function(){return{done:o=!0}}}},t(i)}catch(t){}return o}},485:(t,e,o)=>{"use strict";var r,n=o(5951),i=o(6024),s=o(2250),a=o(2832),c=o(6794),l=o(3427),u=o(4787),d=n.Function,m=/MSIE .\./.test(c)||"BUN"===a&&((r=n.Bun.version.split(".")).length<3||"0"===r[0]&&(r[1]<3||"3"===r[1]&&"0"===r[2]));t.exports=function(t,e){var o=e?2:1;return m?function(r,n){var a=u(arguments.length,1)>o,c=s(r)?r:d(r),m=a?l(arguments,o):[],h=a?function(){i(c,this,m)}:c;return e?t(h,n):t(h)}:t}},530:(t,e,o)=>{"use strict";var r=o(5837);t.exports=r},551:(t,e,o)=>{"use strict";var r=o(5951),n=o(2250),i=r.WeakMap;t.exports=n(i)&&/native code/.test(String(i))},560:(t,e,o)=>{"use strict";var r=o(6264);e.f=r},568:(t,e,o)=>{"use strict";o(3342);var r=o(2046);t.exports=r.setTimeout},575:(t,e,o)=>{"use strict";var r=o(3121);t.exports=function(t){return r(t.length)}},581:(t,e,o)=>{"use strict";var r=o(3930),n=o(2250),i=o(6285),s=TypeError;t.exports=function(t,e){var o,a;if("string"===e&&n(o=t.toString)&&!i(a=r(o,t)))return a;if(n(o=t.valueOf)&&!i(a=r(o,t)))return a;if("string"!==e&&n(o=t.toString)&&!i(a=r(o,t)))return a;throw new s("Can't convert object to primitive value")}},697:(t,e,o)=>{t.exports=o(6490)},726:(t,e,o)=>{"use strict";var r=o(8311),n=o(1907),i=o(6946),s=o(9298),a=o(575),c=o(6968),l=n([].push),u=function(t){var e=1===t,o=2===t,n=3===t,u=4===t,d=6===t,m=7===t,h=5===t||d;return function(f,p,v,g){for(var y,w,b=s(f),E=i(b),S=a(E),x=r(p,v),k=0,L=g||c,_=e?L(f,S):o||m?L(f,0):void 0;S>k;k++)if((h||k in E)&&(w=x(y=E[k],k,b),t))if(e)_[k]=w;else if(w)switch(t){case 3:return!0;case 5:return y;case 6:return k;case 2:l(_,y)}else switch(t){case 4:return!1;case 7:l(_,y)}return d?-1:n||u?u:_}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},727:(t,e,o)=>{"use strict";var r=o(1091),n=o(5993).trim;r({target:"String",proto:!0,forced:o(5819)("trim")},{trim:function(){return n(this)}})},751:(t,e,o)=>{"use strict";var r=o(1091),n=o(9724),i=o(5594),s=o(4640),a=o(5816),c=o(4411),l=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(t){if(!i(t))throw new TypeError(s(t)+" is not a symbol");if(n(l,t))return l[t]}})},768:(t,e,o)=>{"use strict";var r=o(6264),n=o(4284).f,i=r("metadata"),s=Function.prototype;void 0===s[i]&&n(s,i,{value:null})},798:(t,e,o)=>{"use strict";var r,n,i=o(5951),s=o(6794),a=i.process,c=i.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(n=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(n=+r[1]),t.exports=n},975:(t,e,o)=>{"use strict";var r=o(9748);t.exports=r},1042:(t,e,o)=>{"use strict";var r=o(5582),n=o(1907),i=o(4443),s=o(7170),a=o(6624),c=n([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),o=s.f;return o?c(e,o(t)):e}},1074:(t,e,o)=>{"use strict";var r=o(1091),n=o(1907),i=o(4849),s=RangeError,a=String.fromCharCode,c=String.fromCodePoint,l=n([].join);r({target:"String",stat:!0,arity:1,forced:!!c&&1!==c.length},{fromCodePoint:function(t){for(var e,o=[],r=arguments.length,n=0;r>n;){if(e=+arguments[n++],i(e,1114111)!==e)throw new s(e+" is not a valid code point");o[n]=e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320)}return l(o,"")}})},1091:(t,e,o)=>{"use strict";var r=o(5951),n=o(6024),i=o(2361),s=o(2250),a=o(3846).f,c=o(7463),l=o(2046),u=o(8311),d=o(1626),m=o(9724);o(6128);var h=function(t){var e=function(o,r,i){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(o);case 2:return new t(o,r)}return new t(o,r,i)}return n(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var o,n,f,p,v,g,y,w,b,E=t.target,S=t.global,x=t.stat,k=t.proto,L=S?r:x?r[E]:r[E]&&r[E].prototype,_=S?l:l[E]||d(l,E,{})[E],P=_.prototype;for(p in e)n=!(o=c(S?p:E+(x?".":"#")+p,t.forced))&&L&&m(L,p),g=_[p],n&&(y=t.dontCallGetSet?(b=a(L,p))&&b.value:L[p]),v=n&&y?y:e[p],(o||k||typeof g!=typeof v)&&(w=t.bind&&n?u(v,r):t.wrap&&n?h(v):k&&s(v)?i(v):v,(t.sham||v&&v.sham||g&&g.sham)&&d(w,"sham",!0),d(_,p,w),k&&(m(l,f=E+"Prototype")||d(l,f,{}),d(l[f],p,v),t.real&&P&&(o||!P[p])&&d(P,p,v)))}},1127:(t,e,o)=>{"use strict";o(5745);var r=o(1747);t.exports=r("Array","push")},1164:(t,e,o)=>{"use strict";var r=o(1907),n=o(3121),i=o(160),s=o(9314),a=o(4239),c=r(s),l=r("".slice),u=Math.ceil,d=function(t){return function(e,o,r){var s,d,m=i(a(e)),h=n(o),f=m.length,p=void 0===r?" ":i(r);return h<=f||""===p?m:((d=c(p,u((s=h-f)/p.length))).length>s&&(d=l(d,0,s)),t?m+d:d+m)}};t.exports={start:d(!1),end:d(!0)}},1175:(t,e,o)=>{"use strict";var r=o(9846);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1176:t=>{"use strict";var e=Math.ceil,o=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?o:e)(r)}},1212:(t,e,o)=>{t.exports=o(8435)},1229:(t,e,o)=>{"use strict";var r=o(8311),n=o(3930),i=o(9298),s=o(6818),a=o(7812),c=o(5468),l=o(575),u=o(5543),d=o(300),m=o(3448),h=Array;t.exports=function(t){var e=i(t),o=c(this),f=arguments.length,p=f>1?arguments[1]:void 0,v=void 0!==p;v&&(p=r(p,f>2?arguments[2]:void 0));var g,y,w,b,E,S,x=m(e),k=0;if(!x||this===h&&a(x))for(g=l(e),y=o?new this(g):h(g);g>k;k++)S=v?p(e[k],k):e[k],u(y,k,S);else for(y=o?new this:[],E=(b=d(e,x)).next;!(w=n(E,b)).done;k++)S=v?s(b,p,[w.value,k],!0):w.value,u(y,k,S);return y.length=k,y}},1240:(t,e,o)=>{t.exports=o(5204)},1265:(t,e,o)=>{t.exports=o(4598)},1330:(t,e,o)=>{"use strict";var r=o(2190);t.exports=function(t,e,o){return o?r(t.keys(),e,!0):t.forEach(e)}},1340:(t,e,o)=>{"use strict";var r=o(1091),n=o(9538);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==n},{assign:n})},1372:(t,e,o)=>{"use strict";o(366)("metadata")},1393:(t,e,o)=>{t.exports=o(530)},1426:(t,e,o)=>{t.exports=o(9617)},1470:(t,e,o)=>{"use strict";var r=o(1907),n=o(5482),i=o(160),s=o(4239),a=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(t){return function(e,o){var r,u,d=i(s(e)),m=n(o),h=d.length;return m<0||m>=h?t?"":void 0:(r=c(d,m))<55296||r>56319||m+1===h||(u=c(d,m+1))<56320||u>57343?t?a(d,m):r:t?l(d,m,m+2):u-56320+(r-55296<<10)+65536}};t.exports={codeAt:u(!1),charAt:u(!0)}},1505:(t,e,o)=>{"use strict";var r=o(8828);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},1519:(t,e,o)=>{"use strict";t.exports=o(9029)},1542:(t,e,o)=>{"use strict";o(16)},1548:(t,e,o)=>{"use strict";var r=o(1091),n=o(1907),i=o(8530),s=o(6285),a=o(9724),c=o(4284).f,l=o(4443),u=o(5407),d=o(7005),m=o(6499),h=o(5681),f=!1,p=m("meta"),v=0,g=function(t){c(t,p,{value:{objectID:"O"+v++,weakData:{}}})},y=t.exports={enable:function(){y.enable=function(){},f=!0;var t=l.f,e=n([].splice),o={};o[p]=1,t(o).length&&(l.f=function(o){for(var r=t(o),n=0,i=r.length;n<i;n++)if(r[n]===p){e(r,n,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,p)){if(!d(t))return"F";if(!e)return"E";g(t)}return t[p].objectID},getWeakData:function(t,e){if(!a(t,p)){if(!d(t))return!0;if(!e)return!1;g(t)}return t[p].weakData},onFreeze:function(t){return h&&f&&d(t)&&!a(t,p)&&g(t),t}};i[p]=!0},1549:(t,e,o)=>{t.exports=o(8251)},1564:(t,e,o)=>{"use strict";var r=o(7725);t.exports=r},1626:(t,e,o)=>{"use strict";var r=o(9447),n=o(4284),i=o(5817);t.exports=r?function(t,e,o){return n.f(t,e,i(1,o))}:function(t,e,o){return t[e]=o,t}},1655:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881).add,i=o(6913),s=o(2332),a=o(2190);t.exports=function(t){var e=r(this),o=s(t).getIterator(),c=i(e);return a(o,(function(t){n(c,t)})),c}},1660:(t,e,o)=>{"use strict";o(366)("species")},1661:(t,e,o)=>{"use strict";o(8537),o(3669);var r=o(560);t.exports=r.f("toPrimitive")},1697:(t,e,o)=>{"use strict";o(366)("customMatcher")},1730:(t,e,o)=>{"use strict";o(9363),o(3643),o(7057),o(4954);var r=o(560);t.exports=r.f("iterator")},1732:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881).has,i=o(5743),s=o(2332),a=o(1330),c=o(2190),l=o(154);t.exports=function(t){var e=r(this),o=s(t);if(i(e)<=o.size)return!1!==a(e,(function(t){if(o.includes(t))return!1}),!0);var u=o.getIterator();return!1!==c(u,(function(t){if(n(e,t))return l(u,"normal",!1)}))}},1747:(t,e,o)=>{"use strict";var r=o(5951),n=o(2046);t.exports=function(t,e){var o=n[t+"Prototype"],i=o&&o[e];if(i)return i;var s=r[t],a=s&&s.prototype;return a&&a[e]}},1759:(t,e,o)=>{"use strict";var r=o(5951),n=o(5463),i=o(2250),s=o(7463),a=o(2647),c=o(6264),l=o(2832),u=o(7376),d=o(798),m=n&&n.prototype,h=c("species"),f=!1,p=i(r.PromiseRejectionEvent),v=s("Promise",(function(){var t=a(n),e=t!==String(n);if(!e&&66===d)return!0;if(u&&(!m.catch||!m.finally))return!0;if(!d||d<51||!/native code/.test(t)){var o=new n((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((o.constructor={})[h]=r,!(f=o.then((function(){}))instanceof r))return!0}return!(e||"BROWSER"!==l&&"DENO"!==l||p)}));t.exports={CONSTRUCTOR:v,REJECTION_EVENT:p,SUBCLASSING:f}},1785:(t,e,o)=>{"use strict";o(1091)({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:o(9197)})},1793:(t,e,o)=>{"use strict";var r=o(5807);t.exports=Array.isArray||function(t){return"Array"===r(t)}},1829:(t,e,o)=>{"use strict";var r=o(6794);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},1852:(t,e,o)=>{"use strict";var r=o(1091),n=o(1732);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("isDisjointFrom",(function(t){return!t}))},{isDisjointFrom:n})},1866:(t,e,o)=>{"use strict";var r=o(1091),n=o(7376),i=o(1759).CONSTRUCTOR,s=o(5463),a=o(5582),c=o(2250),l=o(8055),u=s&&s.prototype;if(r({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!n&&c(s)){var d=a("Promise").prototype.catch;u.catch!==d&&l(u,"catch",d,{unsafe:!0})}},1871:(t,e,o)=>{"use strict";var r=o(1907),n=o(2159);t.exports=function(t,e,o){try{return r(n(Object.getOwnPropertyDescriptor(t,e)[o]))}catch(t){}}},1907:(t,e,o)=>{"use strict";var r=o(1505),n=Function.prototype,i=n.call,s=r&&n.bind.bind(i,i);t.exports=r?s:function(t){return function(){return i.apply(t,arguments)}}},1926:(t,e,o)=>{"use strict";o(6750);var r=o(2046).Object,n=t.exports=function(t,e,o){return r.defineProperty(t,e,o)};r.defineProperty.sham&&(n.sham=!0)},1969:(t,e,o)=>{"use strict";var r=o(2092);t.exports=r},1978:(t,e,o)=>{"use strict";var r=o(1091),n=o(5951),i=o(485)(n.setInterval,!0);r({global:!0,bind:!0,forced:n.setInterval!==i},{setInterval:i})},2046:t=>{"use strict";t.exports={}},2048:(t,e,o)=>{"use strict";var r=o(1091),n=o(8280),i=o(5972),s=o(9192),a=o(9595),c=o(8075),l=o(1626),u=o(5817),d=o(9259),m=o(5884),h=o(4823),f=o(2096),p=o(6264)("toStringTag"),v=Error,g=[].push,y=function(t,e){var o,r=n(w,this);s?o=s(new v,r?i(this):w):(o=r?this:c(w),l(o,p,"Error")),void 0!==e&&l(o,"message",f(e)),m(o,y,o.stack,1),arguments.length>2&&d(o,arguments[2]);var a=[];return h(t,g,{that:a}),l(o,"errors",a),o};s?s(y,v):a(y,v,{name:!0});var w=y.prototype=c(v.prototype,{constructor:u(1,y),message:u(1,""),name:u(1,"AggregateError")});r({global:!0,constructor:!0,arity:2},{AggregateError:y})},2092:(t,e,o)=>{"use strict";o(5650);var r=o(1747);t.exports=r("Array","forEach")},2096:(t,e,o)=>{"use strict";var r=o(160);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},2098:(t,e,o)=>{"use strict";var r=o(5951),n=o(9447),i=Object.getOwnPropertyDescriptor;t.exports=function(t){if(!n)return r[t];var e=i(r,t);return e&&e.value}},2099:(t,e,o)=>{"use strict";var r=o(1091),n=o(1793),i=o(5468),s=o(6285),a=o(4849),c=o(575),l=o(7374),u=o(5543),d=o(6264),m=o(7171),h=o(3427),f=m("slice"),p=d("species"),v=Array,g=Math.max;r({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var o,r,d,m=l(this),f=c(m),y=a(t,f),w=a(void 0===e?f:e,f);if(n(m)&&(o=m.constructor,(i(o)&&(o===v||n(o.prototype))||s(o)&&null===(o=o[p]))&&(o=void 0),o===v||void 0===o))return h(m,y,w);for(r=new(void 0===o?v:o)(g(w-y,0)),d=0;y<w;y++,d++)y in m&&u(r,d,m[y]);return r.length=d,r}})},2156:t=>{"use strict";t.exports=function(){}},2159:(t,e,o)=>{"use strict";var r=o(2250),n=o(4640),i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(n(t)+" is not a function")}},2190:(t,e,o)=>{"use strict";var r=o(3930);t.exports=function(t,e,o){for(var n,i,s=o?t:t.iterator,a=t.next;!(n=r(a,s)).done;)if(void 0!==(i=e(n.value)))return i}},2220:(t,e,o)=>{"use strict";var r=o(9447),n=o(8661),i=o(4284),s=o(6624),a=o(7374),c=o(2875);e.f=r&&!n?Object.defineProperties:function(t,e){s(t);for(var o,r=a(e),n=c(e),l=n.length,u=0;l>u;)i.f(t,o=n[u++],r[o]);return t}},2222:(t,e,o)=>{t.exports=o(1519)},2230:(t,e,o)=>{"use strict";o(366)("replace")},2231:(t,e,o)=>{"use strict";var r=o(9692);t.exports=r},2235:(t,e,o)=>{"use strict";var r=o(5468),n=o(4640),i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(n(t)+" is not a constructor")}},2250:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},2292:(t,e,o)=>{"use strict";var r,n,i,s,a,c=o(5951),l=o(2098),u=o(8311),d=o(9472).set,m=o(9245),h=o(1829),f=o(8606),p=o(9291),v=o(7586),g=c.MutationObserver||c.WebKitMutationObserver,y=c.document,w=c.process,b=c.Promise,E=l("queueMicrotask");if(!E){var S=new m,x=function(){var t,e;for(v&&(t=w.domain)&&t.exit();e=S.get();)try{e()}catch(t){throw S.head&&r(),t}t&&t.enter()};h||v||p||!g||!y?!f&&b&&b.resolve?((s=b.resolve(void 0)).constructor=b,a=u(s.then,s),r=function(){a(x)}):v?r=function(){w.nextTick(x)}:(d=u(d,c),r=function(){d(x)}):(n=!0,i=y.createTextNode(""),new g(x).observe(i,{characterData:!0}),r=function(){i.data=n=!n}),E=function(t){S.head||r(),S.add(t)}}t.exports=E},2321:(t,e,o)=>{"use strict";var r=o(7264);o(3939),o(1785),o(1697),o(4664),o(3422),o(36),o(8703),o(6878),o(9671),o(359),t.exports=r},2332:(t,e,o)=>{"use strict";var r=o(2159),n=o(6624),i=o(3930),s=o(5482),a=o(3316),c="Invalid size",l=RangeError,u=TypeError,d=Math.max,m=function(t,e){this.set=t,this.size=d(e,0),this.has=r(t.has),this.keys=r(t.keys)};m.prototype={getIterator:function(){return a(n(i(this.keys,this.set)))},includes:function(t){return i(this.has,this.set,t)}},t.exports=function(t){n(t);var e=+t.size;if(e!=e)throw new u(c);var o=s(e);if(o<0)throw new l(c);return new m(t,o)}},2361:(t,e,o)=>{"use strict";var r=o(5807),n=o(1907);t.exports=function(t){if("Function"===r(t))return n(t)}},2392:(t,e,o)=>{"use strict";var r=o(5771);t.exports=r},2416:(t,e,o)=>{"use strict";var r=o(5582);t.exports=r("document","documentElement")},2425:(t,e,o)=>{"use strict";o(1091)({target:"Array",stat:!0},{isArray:o(1793)})},2457:(t,e,o)=>{t.exports=o(6796)},2522:(t,e,o)=>{"use strict";var r=o(5816),n=o(6499),i=r("keys");t.exports=function(t){return i[t]||(i[t]=n(t))}},2532:(t,e,o)=>{"use strict";var r=o(5951),n=Object.defineProperty;t.exports=function(t,e){try{n(r,t,{value:e,configurable:!0,writable:!0})}catch(o){r[t]=e}return e}},2560:(t,e,o)=>{"use strict";o(9363);var r=o(9287),n=o(5951),i=o(4840),s=o(3742);for(var a in r)i(n[a],a),s[a]=s.Array},2567:(t,e,o)=>{"use strict";o(9307);var r=o(1747);t.exports=r("Function","bind")},2574:(t,e)=>{"use strict";var o={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,n=r&&!o.call({1:2},1);e.f=n?function(t){var e=r(this,t);return!!e&&e.enumerable}:o},2595:(t,e,o)=>{"use strict";var r=o(5582),n=o(1907),i=r("Symbol"),s=i.keyFor,a=n(i.prototype.valueOf);t.exports=i.isRegisteredSymbol||function(t){try{return void 0!==s(a(t))}catch(t){return!1}}},2596:(t,e,o)=>{"use strict";o(366)("hasInstance")},2616:(t,e,o)=>{"use strict";var r=o(3155);t.exports=r},2623:(t,e,o)=>{"use strict";var r={};r[o(6264)("toStringTag")]="z",t.exports="[object z]"===String(r)},2647:(t,e,o)=>{"use strict";var r=o(1907),n=o(2250),i=o(6128),s=r(Function.toString);n(i.inspectSource)||(i.inspectSource=function(t){return s(t)}),t.exports=i.inspectSource},2657:(t,e,o)=>{"use strict";var r=o(1091),n=o(3763);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("symmetricDifference")},{symmetricDifference:n})},2736:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(2159),s=o(6254),a=o(4420),c=o(4823);r({target:"Promise",stat:!0,forced:o(3282)},{race:function(t){var e=this,o=s.f(e),r=o.reject,l=a((function(){var s=i(e.resolve);c(t,(function(t){n(s,e,t).then(o.resolve,r)}))}));return l.error&&r(l.value),o.promise}})},2802:(t,e,o)=>{"use strict";var r=o(8055);t.exports=function(t,e,o){for(var n in e)o&&o.unsafe&&t[n]?t[n]=e[n]:r(t,n,e[n],o);return t}},2832:(t,e,o)=>{"use strict";var r=o(5951),n=o(6794),i=o(5807),s=function(t){return n.slice(0,t.length)===t};t.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===i(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},2875:(t,e,o)=>{"use strict";var r=o(3045),n=o(376);t.exports=Object.keys||function(t){return r(t,n)}},2911:(t,e,o)=>{"use strict";var r=o(4640),n=TypeError;t.exports=function(t){if("object"==typeof t&&"size"in t&&"has"in t&&"add"in t&&"delete"in t&&"keys"in t)return t;throw new n(r(t)+" is not a set")}},2914:(t,e,o)=>{"use strict";var r=o(726).forEach,n=o(7623)("forEach");t.exports=n?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},3034:(t,e,o)=>{"use strict";var r=o(8280),n=o(2567),i=Function.prototype;t.exports=function(t){var e=t.bind;return t===i||r(i,t)&&e===i.bind?n:e}},3045:(t,e,o)=>{"use strict";var r=o(1907),n=o(9724),i=o(7374),s=o(4436).indexOf,a=o(8530),c=r([].push);t.exports=function(t,e){var o,r=i(t),l=0,u=[];for(o in r)!n(a,o)&&n(r,o)&&c(u,o);for(;e.length>l;)n(r,o=e[l++])&&(~s(u,o)||c(u,o));return u}},3067:(t,e,o)=>{"use strict";var r=o(4712);o(2560),t.exports=r},3121:(t,e,o)=>{"use strict";var r=o(5482),n=Math.min;t.exports=function(t){var e=r(t);return e>0?n(e,9007199254740991):0}},3130:(t,e,o)=>{"use strict";var r=o(9447),n=o(1793),i=TypeError,s=Object.getOwnPropertyDescriptor,a=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,e){if(n(t)&&!s(t,"length").writable)throw new i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},3155:(t,e,o)=>{"use strict";var r=o(8280),n=o(6177),i=Array.prototype;t.exports=function(t){var e=t.filter;return t===i||r(i,t)&&e===i.filter?n:e}},3220:(t,e,o)=>{"use strict";var r=o(9147);t.exports=r},3246:(t,e,o)=>{"use strict";var r=o(8280),n=o(4668),i=Array.prototype;t.exports=function(t){var e=t.find;return t===i||r(i,t)&&e===i.find?n:e}},3266:(t,e,o)=>{"use strict";var r=o(8685);t.exports=r},3269:t=>{"use strict";t.exports=function(){return!1}},3282:(t,e,o)=>{"use strict";var r=o(5463),n=o(473),i=o(1759).CONSTRUCTOR;t.exports=i||!n((function(t){r.all(t).then(void 0,(function(){}))}))},3313:(t,e,o)=>{"use strict";var r=o(1091),n=o(5582),i=o(9724),s=o(160),a=o(5816),c=o(4411),l=a("string-to-symbol-registry"),u=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(t){var e=s(t);if(i(l,e))return l[e];var o=n("Symbol")(e);return l[e]=o,u[o]=e,o}})},3316:t=>{"use strict";t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},3325:(t,e,o)=>{"use strict";o(366)("unscopables")},3342:(t,e,o)=>{"use strict";o(1978),o(6496)},3377:(t,e,o)=>{"use strict";o(366)("matchAll")},3422:(t,e,o)=>{"use strict";o(1091)({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:o(2595)})},3423:(t,e,o)=>{"use strict";var r=o(8280),n=o(7511),i=String.prototype;t.exports=function(t){var e=t.trim;return"string"==typeof t||t===i||r(i,t)&&e===i.trim?n:e}},3427:(t,e,o)=>{"use strict";var r=o(1907);t.exports=r([].slice)},3448:(t,e,o)=>{"use strict";var r=o(3948),n=o(9367),i=o(7136),s=o(3742),a=o(6264)("iterator");t.exports=function(t){if(!i(t))return n(t,a)||n(t,"@@iterator")||s[r(t)]}},3467:(t,e,o)=>{"use strict";var r=o(3930),n=o(5582),i=o(6264),s=o(8055);t.exports=function(){var t=n("Symbol"),e=t&&t.prototype,o=e&&e.valueOf,a=i("toPrimitive");e&&!e[a]&&s(e,a,(function(t){return r(o,this)}),{arity:1})}},3520:(t,e,o)=>{"use strict";var r=o(5779);t.exports=r},3531:(t,e,o)=>{"use strict";o(2425);var r=o(2046);t.exports=r.Array.isArray},3569:(t,e,o)=>{"use strict";var r=o(6624),n=o(6285),i=o(6254);t.exports=function(t,e){if(r(t),n(e)&&e.constructor===t)return e;var o=i.f(t);return(0,o.resolve)(e),o.promise}},3589:(t,e,o)=>{"use strict";var r=o(1091),n=o(9298),i=o(2875);r({target:"Object",stat:!0,forced:o(8828)((function(){i(1)}))},{keys:function(t){return i(n(t))}})},3604:()=>{},3607:(t,e,o)=>{"use strict";o(7057),o(7277);var r=o(2046);t.exports=r.Array.from},3643:()=>{},3648:(t,e,o)=>{"use strict";var r=o(9447),n=o(8828),i=o(9552);t.exports=!r&&!n((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},3669:(t,e,o)=>{"use strict";var r=o(366),n=o(3467);r("toPrimitive"),n()},3674:(t,e,o)=>{"use strict";var r=o(1091),n=o(5951),i=o(3930),s=o(1907),a=o(7376),c=o(9447),l=o(9846),u=o(8828),d=o(9724),m=o(8280),h=o(6624),f=o(7374),p=o(470),v=o(160),g=o(5817),y=o(8075),w=o(2875),b=o(4443),E=o(5407),S=o(7170),x=o(3846),k=o(4284),L=o(2220),_=o(2574),P=o(8055),C=o(9251),I=o(5816),F=o(2522),D=o(8530),R=o(6499),A=o(6264),T=o(560),O=o(366),q=o(3467),j=o(4840),N=o(4932),B=o(726).forEach,H=F("hidden"),M="Symbol",V="prototype",z=N.set,U=N.getterFor(M),Q=Object[V],W=n.Symbol,G=W&&W[V],J=n.RangeError,K=n.TypeError,X=n.QObject,$=x.f,Y=k.f,Z=E.f,tt=_.f,et=s([].push),ot=I("symbols"),rt=I("op-symbols"),nt=I("wks"),it=!X||!X[V]||!X[V].findChild,st=function(t,e,o){var r=$(Q,e);r&&delete Q[e],Y(t,e,o),r&&t!==Q&&Y(Q,e,r)},at=c&&u((function(){return 7!==y(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?st:Y,ct=function(t,e){var o=ot[t]=y(G);return z(o,{type:M,tag:t,description:e}),c||(o.description=e),o},lt=function(t,e,o){t===Q&&lt(rt,e,o),h(t);var r=p(e);return h(o),d(ot,r)?(o.enumerable?(d(t,H)&&t[H][r]&&(t[H][r]=!1),o=y(o,{enumerable:g(0,!1)})):(d(t,H)||Y(t,H,g(1,y(null))),t[H][r]=!0),at(t,r,o)):Y(t,r,o)},ut=function(t,e){h(t);var o=f(e),r=w(o).concat(ft(o));return B(r,(function(e){c&&!i(dt,o,e)||lt(t,e,o[e])})),t},dt=function(t){var e=p(t),o=i(tt,this,e);return!(this===Q&&d(ot,e)&&!d(rt,e))&&(!(o||!d(this,e)||!d(ot,e)||d(this,H)&&this[H][e])||o)},mt=function(t,e){var o=f(t),r=p(e);if(o!==Q||!d(ot,r)||d(rt,r)){var n=$(o,r);return!n||!d(ot,r)||d(o,H)&&o[H][r]||(n.enumerable=!0),n}},ht=function(t){var e=Z(f(t)),o=[];return B(e,(function(t){d(ot,t)||d(D,t)||et(o,t)})),o},ft=function(t){var e=t===Q,o=Z(e?rt:f(t)),r=[];return B(o,(function(t){!d(ot,t)||e&&!d(Q,t)||et(r,ot[t])})),r};l||(P(G=(W=function(){if(m(G,this))throw new K("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?v(arguments[0]):void 0,e=R(t),o=function(t){var r=void 0===this?n:this;r===Q&&i(o,rt,t),d(r,H)&&d(r[H],e)&&(r[H][e]=!1);var s=g(1,t);try{at(r,e,s)}catch(t){if(!(t instanceof J))throw t;st(r,e,s)}};return c&&it&&at(Q,e,{configurable:!0,set:o}),ct(e,t)})[V],"toString",(function(){return U(this).tag})),P(W,"withoutSetter",(function(t){return ct(R(t),t)})),_.f=dt,k.f=lt,L.f=ut,x.f=mt,b.f=E.f=ht,S.f=ft,T.f=function(t){return ct(A(t),t)},c&&(C(G,"description",{configurable:!0,get:function(){return U(this).description}}),a||P(Q,"propertyIsEnumerable",dt,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!l,sham:!l},{Symbol:W}),B(w(nt),(function(t){O(t)})),r({target:M,stat:!0,forced:!l},{useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!c},{create:function(t,e){return void 0===e?y(t):ut(y(t),e)},defineProperty:lt,defineProperties:ut,getOwnPropertyDescriptor:mt}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ht}),q(),j(W,M),D[H]=!0},3701:(t,e,o)=>{"use strict";var r=o(1907),n=o(8828),i=o(1164).start,s=RangeError,a=isFinite,c=Math.abs,l=Date.prototype,u=l.toISOString,d=r(l.getTime),m=r(l.getUTCDate),h=r(l.getUTCFullYear),f=r(l.getUTCHours),p=r(l.getUTCMilliseconds),v=r(l.getUTCMinutes),g=r(l.getUTCMonth),y=r(l.getUTCSeconds);t.exports=n((function(){return"0385-07-25T07:06:39.999Z"!==u.call(new Date(-50000000000001))}))||!n((function(){u.call(new Date(NaN))}))?function(){if(!a(d(this)))throw new s("Invalid time value");var t=this,e=h(t),o=p(t),r=e<0?"-":e>9999?"+":"";return r+i(c(e),r?6:4,0)+"-"+i(g(t)+1,2,0)+"-"+i(m(t),2,0)+"T"+i(f(t),2,0)+":"+i(v(t),2,0)+":"+i(y(t),2,0)+"."+i(o,3,0)+"Z"}:u},3709:(t,e,o)=>{"use strict";var r=o(1091),n=o(1655);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("union")},{union:n})},3742:t=>{"use strict";t.exports={}},3763:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881),i=o(6913),s=o(2332),a=o(2190),c=n.add,l=n.has,u=n.remove;t.exports=function(t){var e=r(this),o=s(t).getIterator(),n=i(e);return a(o,(function(t){l(e,t)?u(n,t):c(n,t)})),n}},3825:(t,e,o)=>{"use strict";var r,n,i,s=o(1091),a=o(7376),c=o(7586),l=o(5951),u=o(3930),d=o(8055),m=o(9192),h=o(4840),f=o(7118),p=o(2159),v=o(2250),g=o(6285),y=o(9596),w=o(8450),b=o(9472).set,E=o(2292),S=o(3904),x=o(4420),k=o(9245),L=o(4932),_=o(5463),P=o(1759),C=o(6254),I="Promise",F=P.CONSTRUCTOR,D=P.REJECTION_EVENT,R=P.SUBCLASSING,A=L.getterFor(I),T=L.set,O=_&&_.prototype,q=_,j=O,N=l.TypeError,B=l.document,H=l.process,M=C.f,V=M,z=!!(B&&B.createEvent&&l.dispatchEvent),U="unhandledrejection",Q=function(t){var e;return!(!g(t)||!v(e=t.then))&&e},W=function(t,e){var o,r,n,i=e.value,s=1===e.state,a=s?t.ok:t.fail,c=t.resolve,l=t.reject,d=t.domain;try{a?(s||(2===e.rejection&&$(e),e.rejection=1),!0===a?o=i:(d&&d.enter(),o=a(i),d&&(d.exit(),n=!0)),o===t.promise?l(new N("Promise-chain cycle")):(r=Q(o))?u(r,o,c,l):c(o)):l(i)}catch(t){d&&!n&&d.exit(),l(t)}},G=function(t,e){t.notified||(t.notified=!0,E((function(){for(var o,r=t.reactions;o=r.get();)W(o,t);t.notified=!1,e&&!t.rejection&&K(t)})))},J=function(t,e,o){var r,n;z?((r=B.createEvent("Event")).promise=e,r.reason=o,r.initEvent(t,!1,!0),l.dispatchEvent(r)):r={promise:e,reason:o},!D&&(n=l["on"+t])?n(r):t===U&&S("Unhandled promise rejection",o)},K=function(t){u(b,l,(function(){var e,o=t.facade,r=t.value;if(X(t)&&(e=x((function(){c?H.emit("unhandledRejection",r,o):J(U,o,r)})),t.rejection=c||X(t)?2:1,e.error))throw e.value}))},X=function(t){return 1!==t.rejection&&!t.parent},$=function(t){u(b,l,(function(){var e=t.facade;c?H.emit("rejectionHandled",e):J("rejectionhandled",e,t.value)}))},Y=function(t,e,o){return function(r){t(e,r,o)}},Z=function(t,e,o){t.done||(t.done=!0,o&&(t=o),t.value=e,t.state=2,G(t,!0))},tt=function(t,e,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===e)throw new N("Promise can't be resolved itself");var r=Q(e);r?E((function(){var o={done:!1};try{u(r,e,Y(tt,o,t),Y(Z,o,t))}catch(e){Z(o,e,t)}})):(t.value=e,t.state=1,G(t,!1))}catch(e){Z({done:!1},e,t)}}};if(F&&(j=(q=function(t){y(this,j),p(t),u(r,this);var e=A(this);try{t(Y(tt,e),Y(Z,e))}catch(t){Z(e,t)}}).prototype,(r=function(t){T(this,{type:I,done:!1,notified:!1,parent:!1,reactions:new k,rejection:!1,state:0,value:null})}).prototype=d(j,"then",(function(t,e){var o=A(this),r=M(w(this,q));return o.parent=!0,r.ok=!v(t)||t,r.fail=v(e)&&e,r.domain=c?H.domain:void 0,0===o.state?o.reactions.add(r):E((function(){W(r,o)})),r.promise})),n=function(){var t=new r,e=A(t);this.promise=t,this.resolve=Y(tt,e),this.reject=Y(Z,e)},C.f=M=function(t){return t===q||void 0===t?new n(t):V(t)},!a&&v(_)&&O!==Object.prototype)){i=O.then,R||d(O,"then",(function(t,e){var o=this;return new q((function(t,e){u(i,o,t,e)})).then(t,e)}),{unsafe:!0});try{delete O.constructor}catch(t){}m&&m(O,j)}s({global:!0,constructor:!0,wrap:!0,forced:F},{Promise:q}),h(q,I,!1,!0),f(I)},3842:(t,e,o)=>{"use strict";o(8545),o(3643),o(4452),o(3997),o(5084),o(2596),o(5721),o(4954),o(4123),o(3377),o(2230),o(5344),o(1660),o(4610),o(3669),o(4810),o(3325),o(7024),o(8172),o(5205);var r=o(2046);t.exports=r.Symbol},3846:(t,e,o)=>{"use strict";var r=o(9447),n=o(3930),i=o(2574),s=o(5817),a=o(7374),c=o(470),l=o(9724),u=o(3648),d=Object.getOwnPropertyDescriptor;e.f=r?d:function(t,e){if(t=a(t),e=c(e),u)try{return d(t,e)}catch(t){}if(l(t,e))return s(!n(i.f,t,e),t[e])}},3881:(t,e,o)=>{"use strict";var r=o(5582),n=o(9841),i=r("Set"),s=i.prototype;t.exports={Set:i,add:n("add",1),has:n("has",1),remove:n("delete",1),proto:s}},3888:(t,e,o)=>{"use strict";var r=o(8828),n=o(5817);t.exports=!r((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)}))},3904:t=>{"use strict";t.exports=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}},3930:(t,e,o)=>{"use strict";var r=o(1505),n=Function.prototype.call;t.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},3939:(t,e,o)=>{"use strict";o(1091)({target:"Symbol",stat:!0},{isRegisteredSymbol:o(2595)})},3948:(t,e,o)=>{"use strict";var r=o(2623),n=o(2250),i=o(5807),s=o(6264)("toStringTag"),a=Object,c="Arguments"===i(function(){return arguments}());t.exports=r?i:function(t){var e,o,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(t,e){try{return t[e]}catch(t){}}(e=a(t),s))?o:c?i(e):"Object"===(r=i(e))&&n(e.callee)?"Arguments":r}},3981:(t,e,o)=>{t.exports=o(6462)},3997:(t,e,o)=>{"use strict";o(366)("asyncIterator")},4002:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881).has,i=o(5743),s=o(2332),a=o(2190),c=o(154);t.exports=function(t){var e=r(this),o=s(t);if(i(e)<o.size)return!1;var l=o.getIterator();return!1!==a(l,(function(t){if(!n(e,t))return c(l,"normal",!1)}))}},4010:(t,e,o)=>{"use strict";var r=o(1793),n=o(5468),i=o(6285),s=o(6264)("species"),a=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(n(e)&&(e===a||r(e.prototype))||i(e)&&null===(e=e[s]))&&(e=void 0)),void 0===e?a:e}},4018:(t,e,o)=>{"use strict";var r=o(6285);t.exports=function(t){return r(t)||null===t}},4123:(t,e,o)=>{"use strict";o(366)("match")},4139:(t,e,o)=>{"use strict";var r=o(3842);o(2560),t.exports=r},4239:(t,e,o)=>{"use strict";var r=o(7136),n=TypeError;t.exports=function(t){if(r(t))throw new n("Can't call method on "+t);return t}},4284:(t,e,o)=>{"use strict";var r=o(9447),n=o(3648),i=o(8661),s=o(6624),a=o(470),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",m="configurable",h="writable";e.f=r?i?function(t,e,o){if(s(t),e=a(e),s(o),"function"==typeof t&&"prototype"===e&&"value"in o&&h in o&&!o[h]){var r=u(t,e);r&&r[h]&&(t[e]=o.value,o={configurable:m in o?o[m]:r[m],enumerable:d in o?o[d]:r[d],writable:!1})}return l(t,e,o)}:l:function(t,e,o){if(s(t),e=a(e),s(o),n)try{return l(t,e,o)}catch(t){}if("get"in o||"set"in o)throw new c("Accessors not supported");return"value"in o&&(t[e]=o.value),t}},4298:(t,e,o)=>{"use strict";var r=o(9447),n=o(8828),i=o(1907),s=o(5972),a=o(2875),c=o(7374),l=i(o(2574).f),u=i([].push),d=r&&n((function(){var t=Object.create(null);return t[2]=2,!l(t,2)})),m=function(t){return function(e){for(var o,n=c(e),i=a(n),m=d&&null===s(n),h=i.length,f=0,p=[];h>f;)o=i[f++],r&&!(m?o in n:l(n,o))||u(p,t?[o,n[o]]:n[o]);return p}};t.exports={entries:m(!0),values:m(!1)}},4321:(t,e,o)=>{"use strict";var r=o(3427),n=Math.floor,i=function(t,e){var o=t.length;if(o<8)for(var s,a,c=1;c<o;){for(a=c,s=t[c];a&&e(t[a-1],s)>0;)t[a]=t[--a];a!==c++&&(t[a]=s)}else for(var l=n(o/2),u=i(r(t,0,l),e),d=i(r(t,l),e),m=u.length,h=d.length,f=0,p=0;f<m||p<h;)t[f+p]=f<m&&p<h?e(u[f],d[p])<=0?u[f++]:d[p++]:f<m?u[f++]:d[p++];return t};t.exports=i},4411:(t,e,o)=>{"use strict";var r=o(9846);t.exports=r&&!!Symbol.for&&!!Symbol.keyFor},4420:t=>{"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},4436:(t,e,o)=>{"use strict";var r=o(7374),n=o(4849),i=o(575),s=function(t){return function(e,o,s){var a=r(e),c=i(a);if(0===c)return!t&&-1;var l,u=n(s,c);if(t&&o!=o){for(;c>u;)if((l=a[u++])!=l)return!0}else for(;c>u;u++)if((t||u in a)&&a[u]===o)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},4443:(t,e,o)=>{"use strict";var r=o(3045),n=o(376).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},4452:(t,e,o)=>{"use strict";o(3674),o(3313),o(751),o(9721),o(5264)},4502:(t,e,o)=>{"use strict";o(2048)},4525:(t,e,o)=>{"use strict";var r=o(3948),n=o(9724),i=o(8280),s=o(1969);o(237);var a=Array.prototype,c={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var e=t.forEach;return t===a||i(a,t)&&e===a.forEach||n(c,r(t))?s:e}},4532:(t,e,o)=>{"use strict";var r=o(30);t.exports=r},4598:(t,e,o)=>{"use strict";var r=o(3423);t.exports=r},4607:(t,e,o)=>{t.exports=o(4674)},4610:(t,e,o)=>{"use strict";o(366)("split")},4640:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},4664:(t,e,o)=>{"use strict";o(366)("observable")},4668:(t,e,o)=>{"use strict";o(6290);var r=o(1747);t.exports=r("Array","find")},4673:(t,e,o)=>{"use strict";var r=o(1907),n=o(2159),i=o(6285),s=o(9724),a=o(3427),c=o(1505),l=Function,u=r([].concat),d=r([].join),m={};t.exports=c?l.bind:function(t){var e=n(this),o=e.prototype,r=a(arguments,1),c=function(){var o=u(r,a(arguments));return this instanceof c?function(t,e,o){if(!s(m,e)){for(var r=[],n=0;n<e;n++)r[n]="a["+n+"]";m[e]=l("C,a","return new C("+d(r,",")+")")}return m[e](t,o)}(e,o.length,o):e.apply(t,o)};return i(o)&&(c.prototype=o),c}},4674:(t,e,o)=>{"use strict";o(3342);var r=o(2046);t.exports=r.setInterval},4712:(t,e,o)=>{"use strict";o(9363),o(7057);var r=o(3448);t.exports=r},4729:(t,e,o)=>{"use strict";var r=o(1091),n=o(4298).entries;r({target:"Object",stat:!0},{entries:function(t){return n(t)}})},4776:(t,e,o)=>{"use strict";o(4452);var r=o(2046);t.exports=r.Object.getOwnPropertySymbols},4787:t=>{"use strict";var e=TypeError;t.exports=function(t,o){if(t<o)throw new e("Not enough arguments");return t}},4791:(t,e,o)=>{"use strict";var r=o(8828),n=o(6264),i=o(9447),s=o(7376),a=n("iterator");t.exports=!r((function(){var t=new URL("b?a=1&b=2&c=3","https://a"),e=t.searchParams,o=new URLSearchParams("a=1&a=2&b=3"),r="";return t.pathname="c%20d",e.forEach((function(t,o){e.delete("b"),r+=o+t})),o.delete("a",2),o.delete("b",void 0),s&&(!t.toJSON||!o.has("a",1)||o.has("a",2)||!o.has("a",void 0)||o.has("b"))||!e.size&&(s||!i)||!e.sort||"https://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host}))},4810:(t,e,o)=>{"use strict";var r=o(5582),n=o(366),i=o(4840);n("toStringTag"),i(r("Symbol"),"Symbol")},4823:(t,e,o)=>{"use strict";var r=o(8311),n=o(3930),i=o(6624),s=o(4640),a=o(7812),c=o(575),l=o(8280),u=o(300),d=o(3448),m=o(154),h=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,o){var v,g,y,w,b,E,S,x=o&&o.that,k=!(!o||!o.AS_ENTRIES),L=!(!o||!o.IS_RECORD),_=!(!o||!o.IS_ITERATOR),P=!(!o||!o.INTERRUPTED),C=r(e,x),I=function(t){return v&&m(v,"normal",t),new f(!0,t)},F=function(t){return k?(i(t),P?C(t[0],t[1],I):C(t[0],t[1])):P?C(t,I):C(t)};if(L)v=t.iterator;else if(_)v=t;else{if(!(g=d(t)))throw new h(s(t)+" is not iterable");if(a(g)){for(y=0,w=c(t);w>y;y++)if((b=F(t[y]))&&l(p,b))return b;return new f(!1)}v=u(t,g)}for(E=L?t.next:v.next;!(S=n(E,v)).done;){try{b=F(S.value)}catch(t){m(v,"throw",t)}if("object"==typeof b&&b&&l(p,b))return b}return new f(!1)}},4840:(t,e,o)=>{"use strict";var r=o(2623),n=o(4284).f,i=o(1626),s=o(9724),a=o(4878),c=o(6264)("toStringTag");t.exports=function(t,e,o,l){var u=o?t:t&&t.prototype;u&&(s(u,c)||n(u,c,{configurable:!0,value:e}),l&&!r&&i(u,"toString",a))}},4849:(t,e,o)=>{"use strict";var r=o(5482),n=Math.max,i=Math.min;t.exports=function(t,e){var o=r(t);return o<0?n(o+e,0):i(o,e)}},4870:(t,e,o)=>{t.exports=o(9709)},4878:(t,e,o)=>{"use strict";var r=o(2623),n=o(3948);t.exports=r?{}.toString:function(){return"[object "+n(this)+"]"}},4908:(t,e,o)=>{"use strict";var r=o(6221);t.exports=r},4932:(t,e,o)=>{"use strict";var r,n,i,s=o(551),a=o(5951),c=o(6285),l=o(1626),u=o(9724),d=o(6128),m=o(2522),h=o(8530),f="Object already initialized",p=a.TypeError,v=a.WeakMap;if(s||d.state){var g=d.state||(d.state=new v);g.get=g.get,g.has=g.has,g.set=g.set,r=function(t,e){if(g.has(t))throw new p(f);return e.facade=t,g.set(t,e),e},n=function(t){return g.get(t)||{}},i=function(t){return g.has(t)}}else{var y=m("state");h[y]=!0,r=function(t,e){if(u(t,y))throw new p(f);return e.facade=t,l(t,y,e),e},n=function(t){return u(t,y)?t[y]:{}},i=function(t){return u(t,y)}}t.exports={set:r,get:n,has:i,enforce:function(t){return i(t)?n(t):r(t,{})},getterFor:function(t){return function(e){var o;if(!c(e)||(o=n(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return o}}}},4944:(t,e,o)=>{"use strict";var r=o(1091),n=o(4823),i=o(5543);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return n(t,(function(t,o){i(e,t,o)}),{AS_ENTRIES:!0}),e}})},4954:(t,e,o)=>{"use strict";o(366)("iterator")},4997:(t,e,o)=>{"use strict";var r=o(6040);t.exports=r},5042:()=>{},5084:()=>{},5092:(t,e,o)=>{"use strict";o(7052);var r=o(2046).Object,n=t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)};r.getOwnPropertyDescriptor.sham&&(n.sham=!0)},5110:(t,e,o)=>{t.exports=o(9703)},5116:(t,e,o)=>{"use strict";var r,n,i,s=o(8828),a=o(2250),c=o(6285),l=o(8075),u=o(5972),d=o(8055),m=o(6264),h=o(7376),f=m("iterator"),p=!1;[].keys&&("next"in(i=[].keys())?(n=u(u(i)))!==Object.prototype&&(r=n):p=!0),!c(r)||s((function(){var t={};return r[f].call(t)!==t}))?r={}:h&&(r=l(r)),a(r[f])||d(r,f,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},5204:(t,e,o)=>{"use strict";var r=o(7027);o(2560),t.exports=r},5205:()=>{},5264:(t,e,o)=>{"use strict";var r=o(1091),n=o(9846),i=o(8828),s=o(7170),a=o(9298);r({target:"Object",stat:!0,forced:!n||i((function(){s.f(1)}))},{getOwnPropertySymbols:function(t){var e=s.f;return e?e(a(t)):[]}})},5265:(t,e,o)=>{"use strict";o(2099);var r=o(1747);t.exports=r("Array","slice")},5331:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881),i=o(5743),s=o(2332),a=o(1330),c=o(2190),l=n.Set,u=n.add,d=n.has;t.exports=function(t){var e=r(this),o=s(t),n=new l;return i(e)>o.size?c(o.getIterator(),(function(t){d(e,t)&&u(n,t)})):a(e,(function(t){o.includes(t)&&u(n,t)})),n}},5344:(t,e,o)=>{"use strict";o(366)("search")},5407:(t,e,o)=>{"use strict";var r=o(5807),n=o(7374),i=o(4443).f,s=o(3427),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"Window"===r(t)?function(t){try{return i(t)}catch(t){return s(a)}}(t):i(n(t))}},5463:(t,e,o)=>{"use strict";var r=o(5951);t.exports=r.Promise},5468:(t,e,o)=>{"use strict";var r=o(1907),n=o(8828),i=o(2250),s=o(3948),a=o(5582),c=o(2647),l=function(){},u=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,m=r(d.exec),h=!d.test(l),f=function(t){if(!i(t))return!1;try{return u(l,[],t),!0}catch(t){return!1}},p=function(t){if(!i(t))return!1;switch(s(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!m(d,c(t))}catch(t){return!0}};p.sham=!0,t.exports=!u||n((function(){var t;return f(f.call)||!f(Object)||!f((function(){t=!0}))||t}))?p:f},5482:(t,e,o)=>{"use strict";var r=o(1176);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},5543:(t,e,o)=>{"use strict";var r=o(9447),n=o(4284),i=o(5817);t.exports=function(t,e,o){r?n.f(t,e,i(0,o)):t[e]=o}},5569:(t,e,o)=>{t.exports=o(6660)},5582:(t,e,o)=>{"use strict";var r=o(2046),n=o(5951),i=o(2250),s=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?s(r[t])||s(n[t]):r[t]&&r[t][e]||n[t]&&n[t][e]}},5594:(t,e,o)=>{"use strict";var r=o(5582),n=o(2250),i=o(8280),s=o(1175),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return n(e)&&i(e.prototype,a(t))}},5650:(t,e,o)=>{"use strict";var r=o(1091),n=o(2914);r({target:"Array",proto:!0,forced:[].forEach!==n},{forEach:n})},5663:(t,e,o)=>{"use strict";var r=o(70);t.exports=r},5681:(t,e,o)=>{"use strict";var r=o(8828);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},5721:(t,e,o)=>{"use strict";o(366)("isConcatSpreadable")},5743:t=>{"use strict";t.exports=function(t){return t.size}},5745:(t,e,o)=>{"use strict";var r=o(1091),n=o(9298),i=o(575),s=o(3130),a=o(8024);r({target:"Array",proto:!0,arity:1,forced:o(8828)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=n(this),o=i(e),r=arguments.length;a(o+r);for(var c=0;c<r;c++)e[o]=arguments[c],o++;return s(e,o),o}})},5762:(t,e,o)=>{"use strict";var r=o(1907),n=Error,i=r("".replace),s=String(new n("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,c=a.test(s);t.exports=function(t,e){if(c&&"string"==typeof t&&!n.prepareStackTrace)for(;e--;)t=i(t,a,"");return t}},5771:(t,e,o)=>{"use strict";o(9363),o(3643);var r=o(1747);t.exports=r("Array","entries")},5779:(t,e,o)=>{"use strict";var r=o(3266);t.exports=r},5807:(t,e,o)=>{"use strict";var r=o(1907),n=r({}.toString),i=r("".slice);t.exports=function(t){return i(n(t),8,-1)}},5816:(t,e,o)=>{"use strict";var r=o(6128);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},5817:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},5819:(t,e,o)=>{"use strict";var r=o(6833).PROPER,n=o(8828),i=o(6395);t.exports=function(t){return n((function(){return!!i[t]()||"​᠎"!=="​᠎"[t]()||r&&i[t].name!==t}))}},5823:(t,e,o)=>{"use strict";var r=o(1091),n=o(6254);r({target:"Promise",stat:!0},{withResolvers:function(){var t=n.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}})},5837:(t,e,o)=>{"use strict";var r=o(8280),n=o(6275),i=Array.prototype;t.exports=function(t){var e=t.concat;return t===i||r(i,t)&&e===i.concat?n:e}},5884:(t,e,o)=>{"use strict";var r=o(1626),n=o(5762),i=o(3888),s=Error.captureStackTrace;t.exports=function(t,e,o,a){i&&(s?s(t,e):r(t,"stack",n(o,a)))}},5905:(t,e,o)=>{"use strict";var r=o(1091),n=o(8828),i=o(5331);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("intersection",(function(t){return 2===t.size&&t.has(1)&&t.has(2)}))||n((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:i})},5931:(t,e,o)=>{"use strict";o(3825),o(6630),o(1866),o(2736),o(7286),o(6761)},5951:function(t,e,o){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof o.g&&o.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},5953:(t,e,o)=>{"use strict";var r=o(2911),n=o(3881),i=o(6913),s=o(5743),a=o(2332),c=o(1330),l=o(2190),u=n.has,d=n.remove;t.exports=function(t){var e=r(this),o=a(t),n=i(e);return s(e)<=o.size?c(e,(function(t){o.includes(t)&&d(n,t)})):l(o.getIterator(),(function(t){u(e,t)&&d(n,t)})),n}},5972:(t,e,o)=>{"use strict";var r=o(9724),n=o(2250),i=o(9298),s=o(2522),a=o(7382),c=s("IE_PROTO"),l=Object,u=l.prototype;t.exports=a?l.getPrototypeOf:function(t){var e=i(t);if(r(e,c))return e[c];var o=e.constructor;return n(o)&&e instanceof o?o.prototype:e instanceof l?u:null}},5993:(t,e,o)=>{"use strict";var r=o(1907),n=o(4239),i=o(160),s=o(6395),a=r("".replace),c=RegExp("^["+s+"]+"),l=RegExp("(^|[^"+s+"])["+s+"]+$"),u=function(t){return function(e){var o=i(n(e));return 1&t&&(o=a(o,c,"")),2&t&&(o=a(o,l,"$1")),o}};t.exports={start:u(1),end:u(2),trim:u(3)}},6024:(t,e,o)=>{"use strict";var r=o(1505),n=Function.prototype,i=n.apply,s=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(i):function(){return s.apply(i,arguments)})},6028:(t,e,o)=>{"use strict";var r=o(3930),n=o(6285),i=o(5594),s=o(9367),a=o(581),c=o(6264),l=TypeError,u=c("toPrimitive");t.exports=function(t,e){if(!n(t)||i(t))return t;var o,c=s(t,u);if(c){if(void 0===e&&(e="default"),o=r(c,t,e),!n(o)||i(o))return o;throw new l("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},6040:(t,e,o)=>{"use strict";var r=o(8251);t.exports=r},6100:(t,e,o)=>{t.exports=o(9563)},6128:(t,e,o)=>{"use strict";var r=o(7376),n=o(5951),i=o(2532),s="__core-js_shared__",a=t.exports=n[s]||i(s,{});(a.versions||(a.versions=[])).push({version:"3.41.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6177:(t,e,o)=>{"use strict";o(9295);var r=o(1747);t.exports=r("Array","filter")},6221:(t,e,o)=>{"use strict";var r=o(6686);t.exports=r},6226:(t,e,o)=>{t.exports=o(4525)},6254:(t,e,o)=>{"use strict";var r=o(2159),n=TypeError,i=function(t){var e,o;this.promise=new t((function(t,r){if(void 0!==e||void 0!==o)throw new n("Bad Promise constructor");e=t,o=r})),this.resolve=r(e),this.reject=r(o)};t.exports.f=function(t){return new i(t)}},6255:(t,e,o)=>{t.exports=o(568)},6264:(t,e,o)=>{"use strict";var r=o(5951),n=o(5816),i=o(9724),s=o(6499),a=o(9846),c=o(1175),l=r.Symbol,u=n("wks"),d=c?l.for||l:l&&l.withoutSetter||s;t.exports=function(t){return i(u,t)||(u[t]=a&&i(l,t)?l[t]:d("Symbol."+t)),u[t]}},6275:(t,e,o)=>{"use strict";o(8545);var r=o(1747);t.exports=r("Array","concat")},6285:(t,e,o)=>{"use strict";var r=o(2250);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},6290:(t,e,o)=>{"use strict";var r=o(1091),n=o(726).find,i=o(2156),s="find",a=!0;s in[]&&Array(1)[s]((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i(s)},6299:(t,e,o)=>{"use strict";o(7105)},6319:(t,e,o)=>{t.exports=o(2616)},6375:(t,e,o)=>{"use strict";var r=o(8828);t.exports=r((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},6395:t=>{"use strict";t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},6415:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(2159),s=o(5582),a=o(6254),c=o(4420),l=o(4823),u=o(3282),d="No one promise resolved";r({target:"Promise",stat:!0,forced:u},{any:function(t){var e=this,o=s("AggregateError"),r=a.f(e),u=r.resolve,m=r.reject,h=c((function(){var r=i(e.resolve),s=[],a=0,c=1,h=!1;l(t,(function(t){var i=a++,l=!1;c++,n(r,e,t).then((function(t){l||h||(h=!0,u(t))}),(function(t){l||h||(l=!0,s[i]=t,--c||m(new o(s,d)))}))})),--c||m(new o(s,d))}));return h.error&&m(h.value),r.promise}})},6450:(t,e,o)=>{"use strict";var r=o(3607);t.exports=r},6462:(t,e,o)=>{"use strict";var r=o(9929);t.exports=r},6490:(t,e,o)=>{"use strict";var r=o(9661);t.exports=r},6496:(t,e,o)=>{"use strict";var r=o(1091),n=o(5951),i=o(485)(n.setTimeout,!0);r({global:!0,bind:!0,forced:n.setTimeout!==i},{setTimeout:i})},6499:(t,e,o)=>{"use strict";var r=o(1907),n=0,i=Math.random(),s=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+i,36)}},6512:(t,e,o)=>{t.exports=o(8348)},6513:(t,e,o)=>{"use strict";var r=o(5092);t.exports=r},6615:(t,e,o)=>{t.exports=o(8402)},6624:(t,e,o)=>{"use strict";var r=o(6285),n=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(n(t)+" is not an object")}},6630:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(2159),s=o(6254),a=o(4420),c=o(4823);r({target:"Promise",stat:!0,forced:o(3282)},{all:function(t){var e=this,o=s.f(e),r=o.resolve,l=o.reject,u=a((function(){var o=i(e.resolve),s=[],a=0,u=1;c(t,(function(t){var i=a++,c=!1;u++,n(o,e,t).then((function(t){c||(c=!0,s[i]=t,--u||r(s))}),l)})),--u||r(s)}));return u.error&&l(u.value),o.promise}})},6648:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(9298),s=o(6028),a=o(3701),c=o(5807);r({target:"Date",proto:!0,forced:o(8828)((function(){return null!==new Date(NaN).toJSON()||1!==n(Date.prototype.toJSON,{toISOString:function(){return 1}})}))},{toJSON:function(t){var e=i(this),o=s(e,"number");return"number"!=typeof o||isFinite(o)?"toISOString"in e||"Date"!==c(e)?e.toISOString():n(a,e):null}})},6656:(t,e,o)=>{"use strict";var r=o(1907),n=o(1793),i=o(2250),s=o(5807),a=o(160),c=r([].push);t.exports=function(t){if(i(t))return t;if(n(t)){for(var e=t.length,o=[],r=0;r<e;r++){var l=t[r];"string"==typeof l?c(o,l):"number"!=typeof l&&"Number"!==s(l)&&"String"!==s(l)||c(o,a(l))}var u=o.length,d=!0;return function(t,e){if(d)return d=!1,e;if(n(this))return e;for(var r=0;r<u;r++)if(o[r]===t)return e}}}},6660:(t,e,o)=>{"use strict";var r=o(317);t.exports=r},6686:(t,e,o)=>{"use strict";var r=o(303);t.exports=r},6687:(t,e,o)=>{"use strict";var r=o(1091),n=o(726).map;r({target:"Array",proto:!0,forced:!o(7171)("map")},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},6750:(t,e,o)=>{"use strict";var r=o(1091),n=o(9447),i=o(4284).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!n},{defineProperty:i})},6751:(t,e,o)=>{t.exports=o(3220)},6761:(t,e,o)=>{"use strict";var r=o(1091),n=o(5582),i=o(7376),s=o(5463),a=o(1759).CONSTRUCTOR,c=o(3569),l=n("Promise"),u=i&&!a;r({target:"Promise",stat:!0,forced:i||a},{resolve:function(t){return c(u&&this===l?s:this,t)}})},6781:(t,e,o)=>{t.exports=o(4139)},6794:(t,e,o)=>{"use strict";var r=o(5951).navigator,n=r&&r.userAgent;t.exports=n?String(n):""},6796:(t,e,o)=>{"use strict";o(2560);var r=o(3948),n=o(9724),i=o(8280),s=o(2392),a=Array.prototype,c={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var e=t.entries;return t===a||i(a,t)&&e===a.entries||n(c,r(t))?s:e}},6818:(t,e,o)=>{"use strict";var r=o(6624),n=o(154);t.exports=function(t,e,o,i){try{return i?e(r(o)[0],o[1]):e(o)}catch(e){n(t,"throw",e)}}},6833:(t,e,o)=>{"use strict";var r=o(9447),n=o(9724),i=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=n(i,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&s(i,"name").configurable);t.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},6878:(t,e,o)=>{"use strict";o(366)("metadataKey")},6913:(t,e,o)=>{"use strict";var r=o(3881),n=o(1330),i=r.Set,s=r.add;t.exports=function(t){var e=new i;return n(t,(function(t){s(e,t)})),e}},6946:(t,e,o)=>{"use strict";var r=o(1907),n=o(8828),i=o(5807),s=Object,a=r("".split);t.exports=n((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===i(t)?a(t,""):s(t)}:s},6951:(t,e,o)=>{"use strict";var r=o(1091),n=o(5953);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("difference",(function(t){return 0===t.size}))},{difference:n})},6968:(t,e,o)=>{"use strict";var r=o(4010);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},7005:(t,e,o)=>{"use strict";var r=o(8828),n=o(6285),i=o(5807),s=o(6375),a=Object.isExtensible,c=r((function(){a(1)}));t.exports=c||s?function(t){return!!n(t)&&(!s||"ArrayBuffer"!==i(t))&&(!a||a(t))}:a},7024:(t,e,o)=>{"use strict";var r=o(5951);o(4840)(r.JSON,"JSON",!0)},7027:(t,e,o)=>{"use strict";o(4502),o(9363),o(3643),o(5931),o(7450),o(6415),o(7380),o(5823),o(7714),o(7057);var r=o(2046);t.exports=r.Promise},7045:(t,e,o)=>{"use strict";var r=o(1730);o(2560),t.exports=r},7052:(t,e,o)=>{"use strict";var r=o(1091),n=o(8828),i=o(7374),s=o(3846).f,a=o(9447);r({target:"Object",stat:!0,forced:!a||n((function(){s(1)})),sham:!a},{getOwnPropertyDescriptor:function(t,e){return s(i(t),e)}})},7057:(t,e,o)=>{"use strict";var r=o(1470).charAt,n=o(160),i=o(4932),s=o(183),a=o(9550),c="String Iterator",l=i.set,u=i.getterFor(c);s(String,"String",(function(t){l(this,{type:c,string:n(t),index:0})}),(function(){var t,e=u(this),o=e.string,n=e.index;return n>=o.length?a(void 0,!0):(t=r(o,n),e.index+=t.length,a(t,!1))}))},7081:(t,e,o)=>{"use strict";var r=o(1091),n=o(5951),i=o(1548),s=o(8828),a=o(1626),c=o(4823),l=o(9596),u=o(2250),d=o(6285),m=o(7136),h=o(4840),f=o(4284).f,p=o(726).forEach,v=o(9447),g=o(4932),y=g.set,w=g.getterFor;t.exports=function(t,e,o){var g,b=-1!==t.indexOf("Map"),E=-1!==t.indexOf("Weak"),S=b?"set":"add",x=n[t],k=x&&x.prototype,L={};if(v&&u(x)&&(E||k.forEach&&!s((function(){(new x).entries().next()})))){var _=(g=e((function(e,o){y(l(e,_),{type:t,collection:new x}),m(o)||c(o,e[S],{that:e,AS_ENTRIES:b})}))).prototype,P=w(t);p(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(t){var e="add"===t||"set"===t;!(t in k)||E&&"clear"===t||a(_,t,(function(o,r){var n=P(this).collection;if(!e&&E&&!d(o))return"get"===t&&void 0;var i=n[t](0===o?0:o,r);return e?this:i}))})),E||f(_,"size",{configurable:!0,get:function(){return P(this).collection.size}})}else g=o.getConstructor(e,t,b,S),i.enable();return h(g,t,!1,!0),L[t]=g,r({global:!0,forced:!0},L),E||o.setStrong(g,t,b),g}},7105:(t,e,o)=>{"use strict";o(9363),o(1074);var r=o(1091),n=o(5951),i=o(2098),s=o(5582),a=o(3930),c=o(1907),l=o(9447),u=o(4791),d=o(8055),m=o(9251),h=o(2802),f=o(4840),p=o(7181),v=o(4932),g=o(9596),y=o(2250),w=o(9724),b=o(8311),E=o(3948),S=o(6624),x=o(6285),k=o(160),L=o(8075),_=o(5817),P=o(300),C=o(3448),I=o(9550),F=o(4787),D=o(6264),R=o(4321),A=D("iterator"),T="URLSearchParams",O=T+"Iterator",q=v.set,j=v.getterFor(T),N=v.getterFor(O),B=i("fetch"),H=i("Request"),M=i("Headers"),V=H&&H.prototype,z=M&&M.prototype,U=n.TypeError,Q=n.encodeURIComponent,W=String.fromCharCode,G=s("String","fromCodePoint"),J=parseInt,K=c("".charAt),X=c([].join),$=c([].push),Y=c("".replace),Z=c([].shift),tt=c([].splice),et=c("".split),ot=c("".slice),rt=c(/./.exec),nt=/\+/g,it=/^[0-9a-f]+$/i,st=function(t,e){var o=ot(t,e,e+2);return rt(it,o)?J(o,16):NaN},at=function(t){for(var e=0,o=128;o>0&&t&o;o>>=1)e++;return e},ct=function(t){var e=null;switch(t.length){case 1:e=t[0];break;case 2:e=(31&t[0])<<6|63&t[1];break;case 3:e=(15&t[0])<<12|(63&t[1])<<6|63&t[2];break;case 4:e=(7&t[0])<<18|(63&t[1])<<12|(63&t[2])<<6|63&t[3]}return e>1114111?null:e},lt=function(t){for(var e=(t=Y(t,nt," ")).length,o="",r=0;r<e;){var n=K(t,r);if("%"===n){if("%"===K(t,r+1)||r+3>e){o+="%",r++;continue}var i=st(t,r+1);if(i!=i){o+=n,r++;continue}r+=2;var s=at(i);if(0===s)n=W(i);else{if(1===s||s>4){o+="�",r++;continue}for(var a=[i],c=1;c<s&&!(3+ ++r>e||"%"!==K(t,r));){var l=st(t,r+1);if(l!=l){r+=3;break}if(l>191||l<128)break;$(a,l),r+=2,c++}if(a.length!==s){o+="�";continue}var u=ct(a);null===u?o+="�":n=G(u)}}o+=n,r++}return o},ut=/[!'()~]|%20/g,dt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},mt=function(t){return dt[t]},ht=function(t){return Y(Q(t),ut,mt)},ft=p((function(t,e){q(this,{type:O,target:j(t).entries,index:0,kind:e})}),T,(function(){var t=N(this),e=t.target,o=t.index++;if(!e||o>=e.length)return t.target=null,I(void 0,!0);var r=e[o];switch(t.kind){case"keys":return I(r.key,!1);case"values":return I(r.value,!1)}return I([r.key,r.value],!1)}),!0),pt=function(t){this.entries=[],this.url=null,void 0!==t&&(x(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===K(t,0)?ot(t,1):t:k(t)))};pt.prototype={type:T,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,o,r,n,i,s,c,l=this.entries,u=C(t);if(u)for(o=(e=P(t,u)).next;!(r=a(o,e)).done;){if(i=(n=P(S(r.value))).next,(s=a(i,n)).done||(c=a(i,n)).done||!a(i,n).done)throw new U("Expected sequence with length 2");$(l,{key:k(s.value),value:k(c.value)})}else for(var d in t)w(t,d)&&$(l,{key:d,value:k(t[d])})},parseQuery:function(t){if(t)for(var e,o,r=this.entries,n=et(t,"&"),i=0;i<n.length;)(e=n[i++]).length&&(o=et(e,"="),$(r,{key:lt(Z(o)),value:lt(X(o,"="))}))},serialize:function(){for(var t,e=this.entries,o=[],r=0;r<e.length;)t=e[r++],$(o,ht(t.key)+"="+ht(t.value));return X(o,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var vt=function(){g(this,gt);var t=q(this,new pt(arguments.length>0?arguments[0]:void 0));l||(this.size=t.entries.length)},gt=vt.prototype;if(h(gt,{append:function(t,e){var o=j(this);F(arguments.length,2),$(o.entries,{key:k(t),value:k(e)}),l||this.length++,o.updateURL()},delete:function(t){for(var e=j(this),o=F(arguments.length,1),r=e.entries,n=k(t),i=o<2?void 0:arguments[1],s=void 0===i?i:k(i),a=0;a<r.length;){var c=r[a];if(c.key!==n||void 0!==s&&c.value!==s)a++;else if(tt(r,a,1),void 0!==s)break}l||(this.size=r.length),e.updateURL()},get:function(t){var e=j(this).entries;F(arguments.length,1);for(var o=k(t),r=0;r<e.length;r++)if(e[r].key===o)return e[r].value;return null},getAll:function(t){var e=j(this).entries;F(arguments.length,1);for(var o=k(t),r=[],n=0;n<e.length;n++)e[n].key===o&&$(r,e[n].value);return r},has:function(t){for(var e=j(this).entries,o=F(arguments.length,1),r=k(t),n=o<2?void 0:arguments[1],i=void 0===n?n:k(n),s=0;s<e.length;){var a=e[s++];if(a.key===r&&(void 0===i||a.value===i))return!0}return!1},set:function(t,e){var o=j(this);F(arguments.length,1);for(var r,n=o.entries,i=!1,s=k(t),a=k(e),c=0;c<n.length;c++)(r=n[c]).key===s&&(i?tt(n,c--,1):(i=!0,r.value=a));i||$(n,{key:s,value:a}),l||(this.size=n.length),o.updateURL()},sort:function(){var t=j(this);R(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,o=j(this).entries,r=b(t,arguments.length>1?arguments[1]:void 0),n=0;n<o.length;)r((e=o[n++]).value,e.key,this)},keys:function(){return new ft(this,"keys")},values:function(){return new ft(this,"values")},entries:function(){return new ft(this,"entries")}},{enumerable:!0}),d(gt,A,gt.entries,{name:"entries"}),d(gt,"toString",(function(){return j(this).serialize()}),{enumerable:!0}),l&&m(gt,"size",{get:function(){return j(this).entries.length},configurable:!0,enumerable:!0}),f(vt,T),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:vt}),!u&&y(M)){var yt=c(z.has),wt=c(z.set),bt=function(t){if(x(t)){var e,o=t.body;if(E(o)===T)return e=t.headers?new M(t.headers):new M,yt(e,"content-type")||wt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),L(t,{body:_(0,k(o)),headers:_(0,e)})}return t};if(y(B)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return B(t,arguments.length>1?bt(arguments[1]):{})}}),y(H)){var Et=function(t){return g(this,V),new H(t,arguments.length>1?bt(arguments[1]):{})};V.constructor=Et,Et.prototype=V,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Et})}}t.exports={URLSearchParams:vt,getState:j}},7118:(t,e,o)=>{"use strict";var r=o(5582),n=o(9251),i=o(6264),s=o(9447),a=i("species");t.exports=function(t){var e=r(t);s&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},7136:t=>{"use strict";t.exports=function(t){return null==t}},7152:(t,e,o)=>{"use strict";o(366)("dispose")},7170:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},7171:(t,e,o)=>{"use strict";var r=o(8828),n=o(6264),i=o(798),s=n("species");t.exports=function(t){return i>=51||!r((function(){var e=[];return(e.constructor={})[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},7181:(t,e,o)=>{"use strict";var r=o(5116).IteratorPrototype,n=o(8075),i=o(5817),s=o(4840),a=o(3742),c=function(){return this};t.exports=function(t,e,o,l){var u=e+" Iterator";return t.prototype=n(r,{next:i(+!l,o)}),s(t,u,!1,!0),a[u]=c,t}},7213:(t,e,o)=>{"use strict";var r=o(5951),n=o(8828),i=o(1907),s=o(160),a=o(5993).trim,c=o(6395),l=i("".charAt),u=r.parseFloat,d=r.Symbol,m=d&&d.iterator,h=1/u(c+"-0")!=-1/0||m&&!n((function(){u(Object(m))}));t.exports=h?function(t){var e=a(s(t)),o=u(e);return 0===o&&"-"===l(e,0)?-0:o}:u},7264:(t,e,o)=>{"use strict";var r=o(4139);o(768),o(8549),o(7152),o(1372),t.exports=r},7277:(t,e,o)=>{"use strict";var r=o(1091),n=o(1229);r({target:"Array",stat:!0,forced:!o(473)((function(t){Array.from(t)}))},{from:n})},7286:(t,e,o)=>{"use strict";var r=o(1091),n=o(6254);r({target:"Promise",stat:!0,forced:o(1759).CONSTRUCTOR},{reject:function(t){var e=n.f(this);return(0,e.reject)(t),e.promise}})},7374:(t,e,o)=>{"use strict";var r=o(6946),n=o(4239);t.exports=function(t){return r(n(t))}},7376:t=>{"use strict";t.exports=!0},7380:(t,e,o)=>{"use strict";var r=o(1091),n=o(5951),i=o(6024),s=o(3427),a=o(6254),c=o(2159),l=o(4420),u=n.Promise,d=!1;r({target:"Promise",stat:!0,forced:!u||!u.try||l((function(){u.try((function(t){d=8===t}),8)})).error||!d},{try:function(t){var e=arguments.length>1?s(arguments,1):[],o=a.f(this),r=l((function(){return i(c(t),void 0,e)}));return(r.error?o.reject:o.resolve)(r.value),o.promise}})},7382:(t,e,o)=>{"use strict";var r=o(8828);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},7450:(t,e,o)=>{"use strict";var r=o(1091),n=o(3930),i=o(2159),s=o(6254),a=o(4420),c=o(4823);r({target:"Promise",stat:!0,forced:o(3282)},{allSettled:function(t){var e=this,o=s.f(e),r=o.resolve,l=o.reject,u=a((function(){var o=i(e.resolve),s=[],a=0,l=1;c(t,(function(t){var i=a++,c=!1;l++,n(o,e,t).then((function(t){c||(c=!0,s[i]={status:"fulfilled",value:t},--l||r(s))}),(function(t){c||(c=!0,s[i]={status:"rejected",reason:t},--l||r(s))}))})),--l||r(s)}));return u.error&&l(u.value),o.promise}})},7463:(t,e,o)=>{"use strict";var r=o(8828),n=o(2250),i=/#|\.prototype\./,s=function(t,e){var o=c[a(t)];return o===u||o!==l&&(n(e)?r(e):!!e)},a=s.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},7491:(t,e,o)=>{"use strict";var r=o(2911),n=o(5743),i=o(1330),s=o(2332);t.exports=function(t){var e=r(this),o=s(t);return!(n(e)>o.size)&&!1!==i(e,(function(t){if(!o.includes(t))return!1}),!0)}},7511:(t,e,o)=>{"use strict";o(727);var r=o(1747);t.exports=r("String","trim")},7586:(t,e,o)=>{"use strict";var r=o(2832);t.exports="NODE"===r},7623:(t,e,o)=>{"use strict";var r=o(8828);t.exports=function(t,e){var o=[][t];return!!o&&r((function(){o.call(null,e||function(){return 1},1)}))}},7649:()=>{},7714:(t,e,o)=>{"use strict";var r=o(1091),n=o(7376),i=o(5463),s=o(8828),a=o(5582),c=o(2250),l=o(8450),u=o(3569),d=o(8055),m=i&&i.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!i&&s((function(){m.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=l(this,a("Promise")),o=c(t);return this.then(o?function(o){return u(e,t()).then((function(){return o}))}:t,o?function(o){return u(e,t()).then((function(){throw o}))}:t)}}),!n&&c(i)){var h=a("Promise").prototype.finally;m.finally!==h&&d(m,"finally",h,{unsafe:!0})}},7725:(t,e,o)=>{"use strict";var r=o(8402);t.exports=r},7809:(t,e,o)=>{"use strict";var r=o(1091),n=o(7491);r({target:"Set",proto:!0,real:!0,forced:!o(3269)("isSubsetOf",(function(t){return t}))},{isSubsetOf:n})},7810:(t,e,o)=>{"use strict";var r=o(1091),n=o(9447),i=o(2220).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==i,sham:!n},{defineProperties:i})},7812:(t,e,o)=>{"use strict";var r=o(6264),n=o(3742),i=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||s[i]===t)}},7985:(t,e,o)=>{"use strict";var r=o(6450);t.exports=r},8024:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},8055:(t,e,o)=>{"use strict";var r=o(1626);t.exports=function(t,e,o,n){return n&&n.enumerable?t[e]=o:r(t,e,o),t}},8075:(t,e,o)=>{"use strict";var r,n=o(6624),i=o(2220),s=o(376),a=o(8530),c=o(2416),l=o(9552),u=o(2522),d="prototype",m="script",h=u("IE_PROTO"),f=function(){},p=function(t){return"<"+m+">"+t+"</"+m+">"},v=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},g=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}var t,e,o;g="undefined"!=typeof document?document.domain&&r?v(r):(e=l("iframe"),o="java"+m+":",e.style.display="none",c.appendChild(e),e.src=String(o),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):v(r);for(var n=s.length;n--;)delete g[d][s[n]];return g()};a[h]=!0,t.exports=Object.create||function(t,e){var o;return null!==t?(f[d]=n(t),o=new f,f[d]=null,o[h]=t):o=g(),void 0===e?o:i.f(o,e)}},8079:(t,e,o)=>{t.exports=o(8894)},8172:()=>{},8251:(t,e,o)=>{"use strict";var r=o(1926);t.exports=r},8253:(t,e,o)=>{"use strict";o(6687);var r=o(1747);t.exports=r("Array","map")},8280:(t,e,o)=>{"use strict";var r=o(1907);t.exports=r({}.isPrototypeOf)},8311:(t,e,o)=>{"use strict";var r=o(2361),n=o(2159),i=o(1505),s=r(r.bind);t.exports=function(t,e){return n(t),void 0===e?t:i?s(t,e):function(){return t.apply(e,arguments)}}},8348:(t,e,o)=>{"use strict";var r=o(9076);o(2560),t.exports=r},8402:(t,e,o)=>{"use strict";var r=o(3531);t.exports=r},8435:(t,e,o)=>{"use strict";var r=o(24);o(2560),t.exports=r},8450:(t,e,o)=>{"use strict";var r=o(6624),n=o(2235),i=o(7136),s=o(6264)("species");t.exports=function(t,e){var o,a=r(t).constructor;return void 0===a||i(o=r(a)[s])?e:n(o)}},8530:t=>{"use strict";t.exports={}},8537:()=>{},8545:(t,e,o)=>{"use strict";var r=o(1091),n=o(8828),i=o(1793),s=o(6285),a=o(9298),c=o(575),l=o(8024),u=o(5543),d=o(6968),m=o(7171),h=o(6264),f=o(798),p=h("isConcatSpreadable"),v=f>=51||!n((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),g=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:i(t)};r({target:"Array",proto:!0,arity:1,forced:!v||!m("concat")},{concat:function(t){var e,o,r,n,i,s=a(this),m=d(s,0),h=0;for(e=-1,r=arguments.length;e<r;e++)if(g(i=-1===e?s:arguments[e]))for(n=c(i),l(h+n),o=0;o<n;o++,h++)o in i&&u(m,h,i[o]);else l(h+1),u(m,h++,i);return m.length=h,m}})},8549:(t,e,o)=>{"use strict";o(366)("asyncDispose")},8573:(t,e,o)=>{t.exports=o(4532)},8606:(t,e,o)=>{"use strict";var r=o(6794);t.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},8661:(t,e,o)=>{"use strict";var r=o(9447),n=o(8828);t.exports=r&&n((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8685:(t,e,o)=>{"use strict";var r=o(8280),n=o(1127),i=Array.prototype;t.exports=function(t){var e=t.push;return t===i||r(i,t)&&e===i.push?n:e}},8690:(t,e,o)=>{"use strict";var r=o(3067);t.exports=r},8703:(t,e,o)=>{"use strict";o(366)("matcher")},8828:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},8894:(t,e,o)=>{"use strict";var r=o(9299);t.exports=r},8928:(t,e,o)=>{t.exports=o(6513)},8970:(t,e,o)=>{"use strict";o(7810);var r=o(2046).Object,n=t.exports=function(t,e){return r.defineProperties(t,e)};r.defineProperties.sham&&(n.sham=!0)},8979:(t,e,o)=>{t.exports=o(6686)},8980:(t,e,o)=>{"use strict";var r=o(7985);t.exports=r},9029:(t,e,o)=>{"use strict";var r=o(8690);t.exports=r},9076:(t,e,o)=>{"use strict";o(6299),o(5042),o(7649),o(3604);var r=o(2046);t.exports=r.URLSearchParams},9147:(t,e,o)=>{"use strict";o(179);var r=o(2046);t.exports=r.Object.getOwnPropertyDescriptors},9157:(t,e,o)=>{"use strict";var r=o(9378);o(2560),t.exports=r},9192:(t,e,o)=>{"use strict";var r=o(1871),n=o(6285),i=o(4239),s=o(43);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,o={};try{(t=r(Object.prototype,"__proto__","set"))(o,[]),e=o instanceof Array}catch(t){}return function(o,r){return i(o),s(r),n(o)?(e?t(o,r):o.__proto__=r,o):o}}():void 0)},9197:(t,e,o)=>{"use strict";for(var r=o(5816),n=o(5582),i=o(1907),s=o(5594),a=o(6264),c=n("Symbol"),l=c.isWellKnownSymbol,u=n("Object","getOwnPropertyNames"),d=i(c.prototype.valueOf),m=r("wks"),h=0,f=u(c),p=f.length;h<p;h++)try{var v=f[h];s(c[v])&&a(v)}catch(t){}t.exports=function(t){if(l&&l(t))return!0;try{for(var e=d(t),o=0,r=u(m),n=r.length;o<n;o++)if(m[r[o]]==e)return!0}catch(t){}return!1}},9245:t=>{"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},o=this.tail;o?o.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},9251:(t,e,o)=>{"use strict";var r=o(4284);t.exports=function(t,e,o){return r.f(t,e,o)}},9259:(t,e,o)=>{"use strict";var r=o(6285),n=o(1626);t.exports=function(t,e){r(e)&&"cause"in e&&n(t,"cause",e.cause)}},9261:(t,e,o)=>{t.exports=o(9157)},9280:(t,e,o)=>{"use strict";var r=o(5663);t.exports=r},9287:t=>{"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},9291:(t,e,o)=>{"use strict";var r=o(6794);t.exports=/web0s(?!.*chrome)/i.test(r)},9295:(t,e,o)=>{"use strict";var r=o(1091),n=o(726).filter;r({target:"Array",proto:!0,forced:!o(7171)("filter")},{filter:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},9298:(t,e,o)=>{"use strict";var r=o(4239),n=Object;t.exports=function(t){return n(r(t))}},9299:(t,e,o)=>{"use strict";var r=o(8280),n=o(8253),i=Array.prototype;t.exports=function(t){var e=t.map;return t===i||r(i,t)&&e===i.map?n:e}},9307:(t,e,o)=>{"use strict";var r=o(1091),n=o(4673);r({target:"Function",proto:!0,forced:Function.bind!==n},{bind:n})},9314:(t,e,o)=>{"use strict";var r=o(5482),n=o(160),i=o(4239),s=RangeError;t.exports=function(t){var e=n(i(this)),o="",a=r(t);if(a<0||a===1/0)throw new s("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(o+=e);return o}},9363:(t,e,o)=>{"use strict";var r=o(7374),n=o(2156),i=o(3742),s=o(4932),a=o(4284).f,c=o(183),l=o(9550),u=o(7376),d=o(9447),m="Array Iterator",h=s.set,f=s.getterFor(m);t.exports=c(Array,"Array",(function(t,e){h(this,{type:m,target:r(t),index:0,kind:e})}),(function(){var t=f(this),e=t.target,o=t.index++;if(!e||o>=e.length)return t.target=null,l(void 0,!0);switch(t.kind){case"keys":return l(o,!1);case"values":return l(e[o],!1)}return l([o,e[o]],!1)}),"values");var p=i.Arguments=i.Array;if(n("keys"),n("values"),n("entries"),!u&&d&&"values"!==p.name)try{a(p,"name",{value:"values"})}catch(t){}},9367:(t,e,o)=>{"use strict";var r=o(2159),n=o(7136);t.exports=function(t,e){var o=t[e];return n(o)?void 0:r(o)}},9378:(t,e,o)=>{"use strict";o(9363),o(3643),o(1542),o(6951),o(5905),o(1852),o(7809),o(106),o(2657),o(3709),o(7057);var r=o(2046);t.exports=r.Set},9447:(t,e,o)=>{"use strict";var r=o(8828);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},9472:(t,e,o)=>{"use strict";var r,n,i,s,a=o(5951),c=o(6024),l=o(8311),u=o(2250),d=o(9724),m=o(8828),h=o(2416),f=o(3427),p=o(9552),v=o(4787),g=o(1829),y=o(7586),w=a.setImmediate,b=a.clearImmediate,E=a.process,S=a.Dispatch,x=a.Function,k=a.MessageChannel,L=a.String,_=0,P={},C="onreadystatechange";m((function(){r=a.location}));var I=function(t){if(d(P,t)){var e=P[t];delete P[t],e()}},F=function(t){return function(){I(t)}},D=function(t){I(t.data)},R=function(t){a.postMessage(L(t),r.protocol+"//"+r.host)};w&&b||(w=function(t){v(arguments.length,1);var e=u(t)?t:x(t),o=f(arguments,1);return P[++_]=function(){c(e,void 0,o)},n(_),_},b=function(t){delete P[t]},y?n=function(t){E.nextTick(F(t))}:S&&S.now?n=function(t){S.now(F(t))}:k&&!g?(s=(i=new k).port2,i.port1.onmessage=D,n=l(s.postMessage,s)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!m(R)?(n=R,a.addEventListener("message",D,!1)):n=C in p("script")?function(t){h.appendChild(p("script"))[C]=function(){h.removeChild(this),I(t)}}:function(t){setTimeout(F(t),0)}),t.exports={set:w,clear:b}},9502:(t,e,o)=>{"use strict";var r=o(1091),n=o(7213);r({global:!0,forced:parseFloat!==n},{parseFloat:n})},9538:(t,e,o)=>{"use strict";var r=o(9447),n=o(1907),i=o(3930),s=o(8828),a=o(2875),c=o(7170),l=o(2574),u=o(9298),d=o(6946),m=Object.assign,h=Object.defineProperty,f=n([].concat);t.exports=!m||s((function(){if(r&&1!==m({b:1},m(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},o=Symbol("assign detection"),n="abcdefghijklmnopqrst";return t[o]=7,n.split("").forEach((function(t){e[t]=t})),7!==m({},t)[o]||a(m({},e)).join("")!==n}))?function(t,e){for(var o=u(t),n=arguments.length,s=1,m=c.f,h=l.f;n>s;)for(var p,v=d(arguments[s++]),g=m?f(a(v),m(v)):a(v),y=g.length,w=0;y>w;)p=g[w++],r&&!i(h,v,p)||(o[p]=v[p]);return o}:m},9544:(t,e,o)=>{t.exports=o(975)},9550:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},9552:(t,e,o)=>{"use strict";var r=o(5951),n=o(6285),i=r.document,s=n(i)&&n(i.createElement);t.exports=function(t){return s?i.createElement(t):{}}},9563:(t,e,o)=>{"use strict";var r=o(4776);t.exports=r},9595:(t,e,o)=>{"use strict";var r=o(9724),n=o(1042),i=o(3846),s=o(4284);t.exports=function(t,e,o){for(var a=n(e),c=s.f,l=i.f,u=0;u<a.length;u++){var d=a[u];r(t,d)||o&&r(o,d)||c(t,d,l(e,d))}}},9596:(t,e,o)=>{"use strict";var r=o(8280),n=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new n("Incorrect invocation")}},9617:(t,e,o)=>{"use strict";var r=o(3246);t.exports=r},9661:(t,e,o)=>{"use strict";o(3589);var r=o(2046);t.exports=r.Object.keys},9671:(t,e,o)=>{"use strict";o(366)("patternMatch")},9692:(t,e,o)=>{"use strict";var r=o(7045);t.exports=r},9703:(t,e,o)=>{"use strict";var r=o(8970);t.exports=r},9709:(t,e,o)=>{"use strict";var r=o(3034);t.exports=r},9721:(t,e,o)=>{"use strict";var r=o(1091),n=o(5582),i=o(6024),s=o(3930),a=o(1907),c=o(8828),l=o(2250),u=o(5594),d=o(3427),m=o(6656),h=o(9846),f=String,p=n("JSON","stringify"),v=a(/./.exec),g=a("".charAt),y=a("".charCodeAt),w=a("".replace),b=a(1..toString),E=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,k=!h||c((function(){var t=n("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))})),L=c((function(){return'"\\udf06\\ud834"'!==p("\udf06\ud834")||'"\\udead"'!==p("\udead")})),_=function(t,e){var o=d(arguments),r=m(e);if(l(r)||void 0!==t&&!u(t))return o[1]=function(t,e){if(l(r)&&(e=s(r,this,f(t),e)),!u(e))return e},i(p,null,o)},P=function(t,e,o){var r=g(o,e-1),n=g(o,e+1);return v(S,t)&&!v(x,n)||v(x,t)&&!v(S,r)?"\\u"+b(y(t,0),16):t};p&&r({target:"JSON",stat:!0,arity:3,forced:k||L},{stringify:function(t,e,o){var r=d(arguments),n=i(k?_:p,null,r);return L&&"string"==typeof n?w(n,E,P):n}})},9724:(t,e,o)=>{"use strict";var r=o(1907),n=o(9298),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(n(t),e)}},9748:(t,e,o)=>{"use strict";o(1340);var r=o(2046);t.exports=r.Object.assign},9763:(t,e,o)=>{t.exports=o(6450)},9841:t=>{"use strict";t.exports=function(t,e){return 1===e?function(e,o){return e[t](o)}:function(e,o,r){return e[t](o,r)}}},9846:(t,e,o)=>{"use strict";var r=o(798),n=o(8828),i=o(5951).String;t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol("symbol detection");return!i(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},9929:(t,e,o)=>{"use strict";o(9502);var r=o(2046);t.exports=r.parseFloat}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=o(6255),e=o.n(t),r=o(6512),n=o.n(r);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=o(4997),a=o(2321),c=o(2231);function l(t){return l="function"==typeof a&&"symbol"==typeof c?function(t){return typeof t}:function(t){return t&&"function"==typeof a&&t.constructor===a&&t!==a.prototype?"symbol":typeof t},l(t)}var u=o(9280);function d(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[u];if(void 0!==e){var o=e.call(t,"string");if("object"!=l(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function m(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),s(t,d(r.key),r)}}function h(t,e,o){return e&&m(t.prototype,e),o&&m(t,o),s(t,"prototype",{writable:!1}),t}var f=o(9544),p=o.n(f),v=o(6226),g=o.n(v),y=o(1393),w=o.n(y),b=o(8979),E=o.n(b),S=o(9763),x=o.n(S),k=o(6781),L=o.n(k),_=o(2222),P=o.n(_),C=o(6615),I=o.n(C),F=o(1564),D=o(9029),R=o(3520),A=o(4908),T=o(8980);function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=Array(e);o<e;o++)r[o]=t[o];return r}function q(t,e){return function(t){if(F(t))return t}(t)||function(t,e){var o=null==t?null:void 0!==a&&D(t)||t["@@iterator"];if(null!=o){var r,n,i,s,c=[],l=!0,u=!1;try{if(i=(o=o.call(t)).next,0===e){if(Object(o)!==o)return;l=!1}else for(;!(l=(r=i.call(o)).done)&&(R(c).call(c,r.value),c.length!==e);l=!0);}catch(t){u=!0,n=t}finally{try{if(!l&&null!=o.return&&(s=o.return(),Object(s)!==s))return}finally{if(u)throw n}}return c}}(t,e)||function(t,e){if(t){var o;if("string"==typeof t)return O(t,e);var r=A(o={}.toString.call(t)).call(o,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?T(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var j=o(1240),N=o.n(j),B=o(8573),H=o.n(B),M=o(1212),V=o.n(M),z=o(2457),U=o.n(z);function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=Array(e);o<e;o++)r[o]=t[o];return r}var W=function(){return h((function t(){var e,o,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,t),window._dataServiceInstance)return console.log("Using existing DataService instance"),window._dataServiceInstance;this.config=p()({debug:!1,ajaxUrl:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.ajax_url)||"/wp-admin/admin-ajax.php",nonce:(null===(o=window.productEstimatorVars)||void 0===o?void 0:o.nonce)||"",i18n:(null===(r=window.productEstimatorVars)||void 0===r?void 0:r.i18n)||{}},n),this.cache={estimatesData:null,estimatesList:null,rooms:{},suggestedProducts:{}},window._dataServiceLogged||(this.log("DataService initialized"),window._dataServiceLogged=!0),window._dataServiceInstance=this}),[{key:"request",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.log("Making request to '".concat(t,"'"),o),new(N())((function(r,n){var i,s=new FormData;s.append("action",t),s.append("nonce",e.config.nonce),g()(i=H()(o)).call(i,(function(t){var e=q(t,2),o=e[0],r=e[1];null!=r&&s.append(o,String(r))})),e.config.debug&&console.log("Request details:",{url:e.config.ajaxUrl,action:t,nonce:e.config.nonce,data:V()(s)}),fetch(e.config.ajaxUrl,{method:"POST",credentials:"same-origin",body:s}).then((function(t){var e;if(!t.ok)throw console.error(w()(e="Network response error (".concat(t.status,"): ")).call(e,t.statusText)),new Error("Network response was not ok: ".concat(t.status));return t.json()})).then((function(o){if(o.success)e.log("Request '".concat(t,"' succeeded:"),o.data),r(o.data);else{var i,s=new Error((null===(i=o.data)||void 0===i?void 0:i.message)||"Unknown error");s.data=o.data,e.log("Request '".concat(t,"' failed:"),s),n(s)}})).catch((function(o){e.log("Request '".concat(t,"' error:"),o);var r=new Error("AJAX request failed: ".concat(o.message));r.originalError=o,r.action=t,n(r)}))}))}},{key:"checkEstimatesExist",value:function(){return this.request("check_estimates_exist").then((function(t){return!!t.has_estimates}))}},{key:"bindCreateEstimateButton",value:function(){var t=this,e=this.modal.querySelector("#create-estimate-btn");e&&(console.log("Found Create Estimate button, binding event handler"),this._createEstimateBtnHandler&&e.removeEventListener("click",this._createEstimateBtnHandler),this._createEstimateBtnHandler=function(e){e.preventDefault(),console.log("Create Estimate button clicked"),t.showNewEstimateForm()},e.addEventListener("click",this._createEstimateBtnHandler))}},{key:"getEstimatesList",value:function(){var t=this;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.cache.estimatesList?this.request("get_estimates_list").then((function(o){return t.cache.estimatesList=o.html,e()((function(){return t.bindCreateEstimateButton()}),100),o.html})):(this.log("Returning cached estimates list"),e()((function(){return t.bindCreateEstimateButton()}),100),N().resolve(this.cache.estimatesList))}},{key:"getEstimatesData",value:function(){var t=this;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.cache.estimatesData?this.request("get_estimates_data").then((function(e){return t.cache.estimatesData=e.estimates,e.estimates})):(this.log("Returning cached estimates data"),N().resolve(this.cache.estimatesData))}},{key:"getRoomsForEstimate",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="estimate_".concat(t);return!r&&this.cache.rooms[n]?(this.log("Returning cached rooms for estimate ".concat(t)),N().resolve(this.cache.rooms[n])):this.request("get_rooms_for_estimate",{estimate_id:t,product_id:o||""}).then((function(t){return e.cache.rooms[n]=t,t}))}},{key:"addProductToRoom",value:function(t,e){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("DataService: Adding product to room",{roomId:t,productId:e,estimateId:r});var n={room_id:t,product_id:e};return null!==r&&(n.estimate_id=r),this.request("add_product_to_room",n).then((function(t){return console.log("DataService: Product added successfully",t),o.invalidateCache(),t})).catch((function(t){throw console.error("DataService: Error adding product to room",t),t}))}},{key:"addNewEstimate",value:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={form_data:this.formatFormData(t)};return o&&(r.product_id=o),this.request("add_new_estimate",r).then((function(t){return e.invalidateCache(),t}))}},{key:"addNewRoom",value:function(t,e){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("DataService: Adding new room",{estimateId:e,productId:r,formData:t instanceof FormData?V()(t):t});var n={form_data:this.formatFormData(t),estimate_id:e};return r&&(n.product_id=r),this.request("add_new_room",n).then((function(t){return console.log("DataService: Room added successfully",t),o.invalidateCache(),t})).catch((function(t){throw console.error("DataService: Error adding room",t),t}))}},{key:"removeProductFromRoom",value:function(t,e,o){var r=this;return this.request("remove_product_from_room",{estimate_id:t,room_id:e,product_index:o}).then((function(t){return r.invalidateCache(),t}))}},{key:"removeRoom",value:function(t,e){var o=this;console.log("DataService: Removing room",{estimateId:t,roomId:e});var r={estimate_id:String(t),room_id:String(e)};return this.request("remove_room",r).then((function(t){return console.log("DataService: Room removed successfully",t),o.invalidateCache(),t})).catch((function(t){throw console.error("DataService: Error removing room",t),t}))}},{key:"removeEstimate",value:function(t){var e=this;return this.request("remove_estimate",{estimate_id:t}).then((function(t){return e.invalidateCache(),t}))}},{key:"getSuggestedProducts",value:function(t,e){var o,r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=w()(o="estimate_".concat(t,"_room_")).call(o,e);return!n&&this.cache.suggestedProducts[i]?(this.log("Returning cached suggestions for room ".concat(e)),N().resolve(this.cache.suggestedProducts[i])):this.request("get_suggested_products",{estimate_id:t,room_id:e}).then((function(t){return r.cache.suggestedProducts[i]=t.suggestions,t.suggestions}))}},{key:"addSuggestionToRoom",value:function(t,e,o){var r=this;return this.request("add_product_to_room",{estimate_id:t,room_id:e,product_id:o}).then((function(t){return r.invalidateCache(),t}))}},{key:"getVariationEstimator",value:function(t){return this.request("get_variation_estimator",{variation_id:t})}},{key:"formatFormData",value:function(t){if("string"==typeof t)return t;if(t instanceof FormData){var e,o=new(n()),r=function(t,e){var o=void 0!==L()&&P()(t)||t["@@iterator"];if(!o){if(I()(t)||(o=function(t,e){if(t){var o;if("string"==typeof t)return Q(t,e);var r=E()(o={}.toString.call(t)).call(o,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?x()(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw i}}}}(U()(t).call(t));try{for(r.s();!(e=r.n()).done;){var i=q(e.value,2),s=i[0],a=i[1];o.append(s,a)}}catch(t){r.e(t)}finally{r.f()}return o.toString()}return new(n())(t).toString()}},{key:"invalidateCache",value:function(){this.log("Invalidating caches"),this.cache.estimatesData=null,this.cache.estimatesList=null,this.cache.rooms={},this.cache.suggestedProducts={}}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[DataService]"]).call(e,r))}}}])}();const G=W;var J=o(9261),K=o.n(J),X=o(4607),$=o.n(X),Y=o(697),Z=o.n(Y),tt=o(1265),et=o.n(tt),ot=o(8079),rt=o.n(ot),nt=o(1426),it=o.n(nt),st=o(5569),at=o.n(st),ct=o(6100),lt=o.n(ct),ut=o(6319),dt=o.n(ut),mt=o(8928),ht=o.n(mt),ft=o(6751),pt=o.n(ft),vt=o(5110),gt=o.n(vt),yt=o(1549),wt=o.n(yt);function bt(t,e,o){return(e=d(e))in t?s(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Et(t,e){var o=Z()(t);if(lt()){var r=lt()(t);e&&(r=dt()(r).call(r,(function(e){return ht()(t,e).enumerable}))),o.push.apply(o,r)}return o}function St(t){for(var e=1;e<arguments.length;e++){var o,r,n=null!=arguments[e]?arguments[e]:{};e%2?g()(o=Et(Object(n),!0)).call(o,(function(e){bt(t,e,n[e])})):pt()?gt()(t,pt()(n)):g()(r=Et(Object(n))).call(r,(function(e){wt()(t,e,ht()(n,e))}))}return t}var xt=function(){return h((function t(){i(this,t),this.dialog=null,this.backdropElement=null,this.initialized=!1,this.callbacks={confirm:null,cancel:null},this.init()}),[{key:"init",value:function(){this.initialized||(this.createDialogElements(),this.bindEvents(),this.initialized=!0,productEstimatorVars&&productEstimatorVars.debug&&console.log("[ConfirmationDialog] Initialized"))}},{key:"createDialogElements",value:function(){this.backdropElement=document.createElement("div"),this.backdropElement.className="pe-dialog-backdrop",this.dialog=document.createElement("div"),this.dialog.className="pe-confirmation-dialog",this.dialog.setAttribute("role","dialog"),this.dialog.setAttribute("aria-modal","true"),this.dialog.innerHTML='\n    <div class="dialog-content">\n      <div class="pe-dialog-header">\n        <h3 class="pe-dialog-title">Confirm Action</h3>\n        <button type="button" class="pe-dialog-close" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="pe-dialog-body">\n        <p class="pe-dialog-message">Are you sure you want to proceed?</p>\n      </div>\n      <div class="pe-dialog-footer">\n        <button type="button" class="pe-dialog-btn pe-dialog-cancel">Cancel</button>\n        <button type="button" class="pe-dialog-btn pe-dialog-confirm">Confirm</button>\n      </div>\n    </div>\n  ';var t=document.querySelector(".pe-dialog-backdrop"),e=document.querySelector(".pe-confirmation-dialog");t&&t.remove(),e&&e.remove(),document.body.appendChild(this.backdropElement),document.body.appendChild(this.dialog)}},{key:"bindEvents",value:function(){var t=this,e=this.dialog.querySelector(".pe-dialog-close"),o=this.dialog.querySelector(".pe-dialog-cancel"),r=this.dialog.querySelector(".pe-dialog-confirm");e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.hide(),"function"==typeof t.callbacks.cancel&&t.callbacks.cancel()})),o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.hide(),"function"==typeof t.callbacks.cancel&&t.callbacks.cancel()})),r.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.hide(),"function"==typeof t.callbacks.confirm&&t.callbacks.confirm()})),this.backdropElement.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),e.target===t.backdropElement&&(t.hide(),"function"==typeof t.callbacks.cancel&&t.callbacks.cancel())})),this.dialog.addEventListener("click",(function(t){t.stopPropagation()})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&t.isVisible()&&(e.preventDefault(),e.stopPropagation(),t.hide(),"function"==typeof t.callbacks.cancel&&t.callbacks.cancel())}))}},{key:"show",value:function(){var t,o=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null===(t=window.productEstimatorVars)||void 0===t?void 0:t.i18n)||{},i=St(St({},{title:"Confirm Action",message:"Are you sure you want to proceed?",type:"",confirmText:n.confirm||"Confirm",cancelText:n.cancel||"Cancel",onConfirm:null,onCancel:null}),r);this.callbacks.confirm=i.onConfirm,this.callbacks.cancel=i.onCancel;var s=this.dialog.querySelector(".pe-dialog-title"),a=this.dialog.querySelector(".pe-dialog-message"),c=this.dialog.querySelector(".pe-dialog-confirm"),l=this.dialog.querySelector(".pe-dialog-cancel");s&&(s.textContent=i.title),a&&(a.textContent=i.message),c&&(c.textContent=i.confirmText),l&&(l.textContent=i.cancelText),this.dialog.classList.remove("pe-dialog-type-product","pe-dialog-type-room","pe-dialog-type-estimate"),i.type&&this.dialog.classList.add("pe-dialog-type-".concat(i.type)),this.backdropElement&&(this.backdropElement.style.display="block"),this.dialog&&(this.dialog.style.display="block"),this.dialog&&this.dialog.classList.add("active"),e()((function(){var t=o.dialog.querySelector(".pe-dialog-cancel");t&&t.focus()}),100)}},{key:"hide",value:function(){this.backdropElement&&(this.backdropElement.style.display="none"),this.dialog&&(this.dialog.classList.remove("active"),this.dialog.style.display="none")}},{key:"isVisible",value:function(){return this.dialog&&"block"===this.dialog.style.display}},{key:"log",value:function(){if(productEstimatorVars&&productEstimatorVars.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[ConfirmationDialog]"]).call(e,r))}}}])}();const kt=new xt;var Lt=o(4870),_t=o.n(Lt),Pt=o(3981),Ct=o.n(Pt),It=function(){return h((function t(e){var o,r;i(this,t),this.id="carousel_"+Math.random().toString(36).substr(2,9),this.container=e,this.itemsContainer=e.querySelector(".suggestions-container"),this.items=e.querySelectorAll(".suggestion-item"),this.prevBtn=e.querySelector(".suggestions-nav.prev"),this.nextBtn=e.querySelector(".suggestions-nav.next"),this.isSimilarProducts=e.classList.contains("similar-products-carousel"),console.log(w()(o=w()(r="[".concat(this.id,"] Initializing carousel with ")).call(r,this.items.length," items, isSimilarProducts: ")).call(o,this.isSimilarProducts)),this.itemsContainer&&this.items.length?(e.carouselInstance=this,this.isSimilarProducts?(this.itemWidth=130,this.itemGap=5):(this.itemWidth=200,this.itemGap=15),this.visibleItems=this.calculateVisibleItems(),this.currentPosition=0,this.maxPosition=Math.max(0,this.items.length-this.visibleItems),this.setContainerSize(),this.bindEvents(),this.updateButtons()):console.warn("[".concat(this.id,"] Carousel missing items container or has no items"))}),[{key:"getContainerWidth",value:function(){var t;if(this.isSimilarProducts){var e=this.container.closest(".product-item");if(e){var o,r=e.offsetWidth;return console.log(w()(o="[".concat(this.id,"] Found product-item parent: ")).call(o,r,"px")),r-10}}var n=this.container.offsetWidth;return console.log(w()(t="[".concat(this.id,"] Using container width: ")).call(t,n,"px")),n}},{key:"setContainerSize",value:function(){if(this.isSimilarProducts){var t,e=this.container.closest(".product-item");if(e){var o,r=e.offsetWidth;console.log(w()(o="[".concat(this.id,"] Similar products parent width: ")).call(o,r,"px")),this.container.style.maxWidth="".concat(r-10,"px")}g()(t=x()(this.items)).call(t,(function(t){t.style.flexShrink="0",t.style.flexGrow="0"})),this.itemsContainer.style.gap="".concat(this.itemGap,"px")}}},{key:"calculateVisibleItems",value:function(){var t,e,o,r=this.getContainerWidth(),n=r-50,i=(this.isSimilarProducts?130:this.itemWidth)+(this.isSimilarProducts?5:this.itemGap),s=Math.max(1,Math.floor(n/i));return console.log(w()(t=w()(e=w()(o="[".concat(this.id,"] Container width: ")).call(o,r,"px, available: ")).call(e,n,"px, visible items: ")).call(t,s)),s}},{key:"bindEvents",value:function(){var t,o,r,n=this;this.handlePrevClick=_t()(t=this.handlePrevClick).call(t,this),this.handleNextClick=_t()(o=this.handleNextClick).call(o,this),this.handleResize=_t()(r=this.handleResize).call(r,this),this.prevBtn&&(this.prevBtn.removeEventListener("click",this.handlePrevClick),this.prevBtn.addEventListener("click",this.handlePrevClick)),this.nextBtn&&(this.nextBtn.removeEventListener("click",this.handleNextClick),this.nextBtn.addEventListener("click",this.handleNextClick)),this.resizeTimeout=null,window.addEventListener("resize",(function(){clearTimeout(n.resizeTimeout),n.resizeTimeout=e()(n.handleResize,150)})),console.log("[".concat(this.id,"] Events bound"))}},{key:"handlePrevClick",value:function(t){var e;t.preventDefault(),t.stopPropagation(),console.log(w()(e="[".concat(this.id,"] Prev button clicked, current position: ")).call(e,this.currentPosition)),this.currentPosition>0&&(this.currentPosition--,this.updatePosition(),this.updateButtons())}},{key:"handleNextClick",value:function(t){var e,o;t.preventDefault(),t.stopPropagation(),console.log(w()(e=w()(o="[".concat(this.id,"] Next button clicked, current position: ")).call(o,this.currentPosition,", max: ")).call(e,this.maxPosition)),this.currentPosition<this.maxPosition&&(this.currentPosition++,this.updatePosition(),this.updateButtons())}},{key:"handleResize",value:function(){var t,e;this.setContainerSize(),this.visibleItems,this.visibleItems=this.calculateVisibleItems(),this.maxPosition=Math.max(0,this.items.length-this.visibleItems),console.log(w()(t=w()(e="[".concat(this.id,"] Window resized, visible items: ")).call(e,this.visibleItems,", max position: ")).call(t,this.maxPosition)),this.currentPosition>this.maxPosition&&(this.currentPosition=this.maxPosition),this.updatePosition(),this.updateButtons()}},{key:"getAvailableWidth",value:function(){var t=this.container.clientWidth-50;if(this.isSimilarProducts){var e=this.container.closest(".product-item");if(e){var o,r=window.getComputedStyle(e),n=e.clientWidth-(Ct()(r.paddingLeft)+Ct()(r.paddingRight));t=Math.min(t,n),console.log(w()(o="Product item width: ".concat(n,"px, Available width: ")).call(o,t,"px"))}}else{var i=this.container.closest(".accordion-content");if(i){var s,a=i.clientWidth-30;t=Math.min(t,a),console.log(w()(s="Accordion content width: ".concat(a,"px, Available width: ")).call(s,t,"px"))}}return Math.max(t,100)}},{key:"updatePosition",value:function(){var t,e;if(this.itemsContainer){var o=this.itemWidth+this.itemGap,r=-this.currentPosition*o;this.itemsContainer.style.transition="transform 0.3s ease",this.itemsContainer.style.transform="translateX(".concat(r,"px)"),console.log(w()(t=w()(e="[".concat(this.id,"] Position updated to ")).call(e,this.currentPosition,", translateX: ")).call(t,r,"px"))}}},{key:"updateButtons",value:function(){var t,e;this.prevBtn&&(this.currentPosition<=0?(this.prevBtn.classList.add("disabled"),this.prevBtn.setAttribute("aria-disabled","true")):(this.prevBtn.classList.remove("disabled"),this.prevBtn.removeAttribute("aria-disabled"))),this.nextBtn&&(this.currentPosition>=this.maxPosition?(this.nextBtn.classList.add("disabled"),this.nextBtn.setAttribute("aria-disabled","true")):(this.nextBtn.classList.remove("disabled"),this.nextBtn.removeAttribute("aria-disabled"))),console.log(w()(t=w()(e="[".concat(this.id,"] Buttons updated - prev ")).call(e,this.prevBtn?this.prevBtn.classList.contains("disabled")?"disabled":"enabled":"missing",", next ")).call(t,this.nextBtn?this.nextBtn.classList.contains("disabled")?"disabled":"enabled":"missing"))}},{key:"destroy",value:function(){this.prevBtn&&this.prevBtn.removeEventListener("click",this.handlePrevClick),this.nextBtn&&this.nextBtn.removeEventListener("click",this.handleNextClick),window.removeEventListener("resize",this.handleResize),this.container&&delete this.container.carouselInstance,console.log("[".concat(this.id,"] Carousel destroyed"))}}])}();function Ft(){console.log("Initializing all suggestion carousels");var t=document.querySelectorAll(".suggestions-carousel");console.log("Found ".concat(t.length," carousel containers")),g()(t).call(t,(function(t){t.carouselInstance&&t.carouselInstance.destroy()}));var e=[];return g()(t).call(t,(function(t){var o=new It(t);e.push(o)})),e}function Dt(){var t=document.querySelectorAll(".accordion-header");console.log("Setting up ".concat(t.length," accordion headers for carousel initialization")),g()(t).call(t,(function(t){t.removeEventListener("click",Rt),t.addEventListener("click",Rt)}))}function Rt(t){e()((function(){var e=t.currentTarget.closest(".accordion-item");if(e){var o=e.querySelector(".accordion-content");if(o&&"none"!==window.getComputedStyle(o).display){console.log("Accordion opened, checking for carousels to initialize");var r=o.querySelectorAll(".suggestions-carousel");console.log("Found ".concat(r.length," carousels in opened accordion")),g()(r).call(r,(function(t){t.carouselInstance&&t.carouselInstance.destroy(),new It(t)}))}}}),300)}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=Array(e);o<e;o++)r[o]=t[o];return r}document.addEventListener("DOMContentLoaded",(function(){console.log("DOM loaded, initializing carousels"),Ft(),Dt()}));var Tt=function(){return h((function t(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;i(this,t),this.config=p()({debug:!1,selectors:{modalContainer:"#product-estimator-modal",estimatorButtons:".product-estimator-button, .single_add_to_estimator_button",modalOverlay:".product-estimator-modal-overlay",closeButton:".product-estimator-modal-close",contentContainer:".product-estimator-modal-form-container",loadingIndicator:".product-estimator-modal-loading",estimatesList:"#estimates",estimateSelection:"#estimate-selection-wrapper",roomSelection:"#room-selection-form-wrapper",newEstimateForm:"#new-estimate-form-wrapper",newRoomForm:"#new-room-form-wrapper"},i18n:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.i18n)||{}},o),this.dataService=r,this.modal=null,this.overlay=null,this.closeButton=null,this.contentContainer=null,this.loadingIndicator=null,this.estimatesList=null,this.estimateSelection=null,this.estimateSelectionForm=null,this.roomSelectionForm=null,this.newEstimateForm=null,this.newRoomForm=null,this.isOpen=!1,this.currentView=null,this.currentProductId=null,this.initialized=!1,this.eventHandlers={},this.escKeyHandler=null,this.init()}),[{key:"init",value:function(){var t=this;this.initialized?this.log("ModalManager already initialized"):(this.modal=document.querySelector(this.config.selectors.modalContainer),this.modal?this.log("Found existing modal in DOM, initializing elements"):this.log("Warning: Modal element not found in DOM. The PHP partial may not be included."),this.modal&&(this.initializeElements(),this.bindEvents(),this.setupLoaderSafety(),e()((function(){t.ensureLoaderHidden()}),500)),this.initializeJQueryAccordions(),this.initialized=!0,this.log("ModalManager initialized"))}},{key:"initializeElements",value:function(){this.modal?(this.overlay=this.modal.querySelector(this.config.selectors.modalOverlay),this.closeButton=this.modal.querySelector(this.config.selectors.closeButton),this.contentContainer=this.modal.querySelector(this.config.selectors.contentContainer),this.loadingIndicator=this.modal.querySelector(this.config.selectors.loadingIndicator),this.loadingIndicator||(console.warn("[ModalManager] Loading indicator not found, creating one"),this.loadingIndicator=document.createElement("div"),this.loadingIndicator.className="product-estimator-modal-loading",this.loadingIndicator.innerHTML='\n      <div class="loading-spinner"></div>\n      <div class="loading-text">'.concat(this.config.i18n.loading||"Loading...","</div>\n    "),this.modal.appendChild(this.loadingIndicator)),this.estimatesList=this.modal.querySelector("#estimates"),this.estimateSelection=this.modal.querySelector("#estimate-selection-wrapper"),this.estimateSelectionForm=this.modal.querySelector("#estimate-selection-form-wrapper"),this.roomSelectionForm=this.modal.querySelector("#room-selection-form-wrapper"),this.newEstimateForm=this.modal.querySelector("#new-estimate-form-wrapper"),this.newRoomForm=this.modal.querySelector("#new-room-form-wrapper"),!this.estimateSelection&&this.contentContainer&&(console.warn("Creating estimate selection container"),this.estimateSelection=document.createElement("div"),this.estimateSelection.id="estimate-selection-wrapper",this.contentContainer.appendChild(this.estimateSelection),this.estimateSelectionForm||(this.estimateSelectionForm=document.createElement("div"),this.estimateSelectionForm.id="estimate-selection-form-wrapper",this.estimateSelection.appendChild(this.estimateSelectionForm))),!this.roomSelectionForm&&this.contentContainer&&(console.warn("Creating room selection form container"),this.roomSelectionForm=document.createElement("div"),this.roomSelectionForm.id="room-selection-form-wrapper",this.roomSelectionForm.style.display="none",this.contentContainer.appendChild(this.roomSelectionForm)),this.bindExistingForms()):console.error("[ModalManager] Modal element not available for initializing elements")}},{key:"showLoading",value:function(){if(this.loadingIndicator)this.loadingIndicator.style.display="flex";else if(console.warn("Loading indicator not available - creating one"),this.modal){var t=document.createElement("div");t.className="product-estimator-modal-loading",t.style.display="flex",t.innerHTML='\n        <div class="loading-spinner"></div>\n        <div class="loading-text">'.concat(this.config.i18n.loading||"Loading...","</div>\n      "),this.modal.appendChild(t),this.loadingIndicator=t}else console.error("Cannot create loading indicator - modal not available")}},{key:"hideLoading",value:function(){this.loadingStartTime=0,this.loadingIndicator?(this.loadingIndicator.style.display="none",console.log("Loading indicator hidden at:",(new Date).toISOString())):console.warn("Loading indicator not available during hide operation")}},{key:"initializeCarousels",value:function(){console.log("Initializing carousels in modal");var t=this.modal.querySelectorAll(".suggestions-carousel");if(t.length>0){var e;console.log("Found ".concat(t.length," carousel containers in modal"));var o=this.modal.querySelectorAll(".product-suggestions .suggestions-carousel").length,r=this.modal.querySelectorAll(".product-similar-products .suggestions-carousel").length;console.log(w()(e="Carousel types: ".concat(o," suggestion carousels, ")).call(e,r," similar product carousels")),Ft()}else console.log("No carousel containers found in modal")}},{key:"bindExistingForms",value:function(){var t=this;if(this.newRoomForm){var e=this.newRoomForm.querySelector("form#new-room-form");if(e){console.log("Found existing room form, binding event handlers"),this._newRoomFormSubmitHandler&&e.removeEventListener("submit",this._newRoomFormSubmitHandler),this._newRoomFormSubmitHandler=function(o){o.preventDefault(),console.log("Existing room form submitted"),t.handleNewRoomSubmission(e,o)},e.addEventListener("submit",this._newRoomFormSubmitHandler);var o=e.querySelector(".cancel-btn");o&&o.addEventListener("click",(function(){t.cancelForm("room")}))}}if(this.newEstimateForm){var r=this.newEstimateForm.querySelector("form#new-estimate-form");r&&(this._estimateFormSubmitHandler&&r.removeEventListener("submit",this._estimateFormSubmitHandler),this._estimateFormSubmitHandler=function(e){e.preventDefault(),t.handleNewEstimateSubmission(r,e)},r.addEventListener("submit",this._estimateFormSubmitHandler))}this.bindRoomSelectionFormEvents()}},{key:"bindEvents",value:function(){var t=this;if(this.modal){this._modalClickHandler&&this.modal.removeEventListener("click",this._modalClickHandler),this._modalClickHandler=function(e){e.target.closest(t.config.selectors.closeButton)&&(e.preventDefault(),e.stopPropagation(),t.log("Close button clicked"),t.closeModal()),e.target.classList.contains("product-estimator-modal-overlay")&&(e.preventDefault(),e.stopPropagation(),t.log("Overlay clicked"),t.closeModal())},this.modal.addEventListener("click",this._modalClickHandler);var e=function(e){"Escape"===e.key&&t.isOpen&&(t.log("Escape key pressed"),t.closeModal())};document.removeEventListener("keydown",this.escKeyHandler),document.addEventListener("keydown",e),this.escKeyHandler=e,this.log("Modal events bound")}else this.log("Modal element not available, cannot bind events")}},{key:"openModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("MODAL OPEN CALLED WITH:",{productId:e,forceListView:o,typeOfProductId:l(e)}),this.modal?(this.resetModalState(),this.currentProductId=e,e?this.modal.dataset.productId=e:delete this.modal.dataset.productId,this.showLoading(),this.modal.style.display="block",document.body.classList.add("modal-open"),this.isOpen=!0,console.log("FLOW DECISION:",{hasProductId:!!e,forceListView:o,willShowProductFlow:!!e&&!o,willShowListView:!e||o}),e&&!o?(console.log("STARTING PRODUCT FLOW with product ID:",e),this.estimatesList&&(this.estimatesList.style.display="none","undefined"!=typeof jQuery&&jQuery(this.estimatesList).hide()),this.dataService.checkEstimatesExist().then((function(e){console.log("Has estimates check result:",e),e?t.showEstimateSelection():(t.showNewEstimateForm(),t.hideLoading())})).catch((function(e){console.error("Error checking estimates:",e),t.showError("Error checking estimates. Please try again."),t.hideLoading()}))):(console.log("STARTING LIST VIEW FLOW"),this.estimatesList&&(this.estimatesList.style.display="block"),this.estimateSelection&&(this.estimateSelection.style.display="none"),this.newEstimateForm&&(this.newEstimateForm.style.display="none"),this.newRoomForm&&(this.newRoomForm.style.display="none"),this.loadEstimatesList().then((function(){var e=t.modal.querySelector("#create-estimate-btn");e&&(t._createEstimateBtnHandler&&e.removeEventListener("click",t._createEstimateBtnHandler),t._createEstimateBtnHandler=function(){t.showNewEstimateForm()},e.addEventListener("click",t._createEstimateBtnHandler),console.log("Updated event handler for list view create estimate button"))})).catch((function(e){console.error("Error loading estimates list:",e),t.showError("Error loading estimates list.")})).finally((function(){t.hideLoading()})))):console.error("Cannot open modal - not found in DOM")}},{key:"showEstimateSelection",value:function(){var t=this;console.log("Showing estimate selection"),this.estimatesList&&(this.estimatesList.style.display="none"),this.estimateSelection?(this.forceElementVisibility(this.estimateSelection),this.estimateSelectionForm&&this.forceElementVisibility(this.estimateSelectionForm),this.estimateSelectionForm&&this.estimateSelectionForm.querySelector("form")?(this.loadEstimatesData(),this.bindEstimateSelectionFormEvents(),this.hideLoading()):this.loadEstimateSelectionForm().then((function(){t.bindEstimateSelectionFormEvents()})).catch((function(t){console.error("Error loading form:",t)}))):console.error("Estimate selection container not found")}},{key:"forceElementVisibility",value:function(t){var e;if(!t)return console.error("Cannot show null element"),null;console.log("Forcing visibility for:",t.id||t.tagName),t.style.cssText+="display: block !important; visibility: visible !important; opacity: 1 !important; height: auto !important;",g()(e=["hidden","hide","invisible","d-none","display-none"]).call(e,(function(e){t.classList.contains(e)&&t.classList.remove(e)})),t.classList.add("visible","d-block");for(var o=t.parentElement,r=new(K());o&&o!==document.body&&!r.has(o);)r.add(o),"none"===window.getComputedStyle(o).display&&(o.style.cssText+="display: block !important;"),o=o.parentElement;return"undefined"!=typeof jQuery&&jQuery(t).show(),t}},{key:"closeModal",value:function(){this.isOpen&&(this.modal?(this.modal.style.display="none",delete this.modal.dataset.productId,this.ensureLoaderHidden(),document.body.classList.remove("modal-open"),this.isOpen=!1,this.currentProductId=null,this.currentView=null,this.resetModalState(),this.emit("modal:closed")):this.log("Cannot close modal - element not found"))}},{key:"setupLoaderSafety",value:function(){var t=this;$()((function(){if(t.isOpen&&t.loadingIndicator&&"none"!==window.getComputedStyle(t.loadingIndicator).display){var e=t.loadingStartTime||0,o=(new Date).getTime();e&&o-e>1e4&&(console.warn("Loading indicator has been visible for more than 10 seconds, hiding it."),t.hideLoading(),t.showError("The operation is taking longer than expected or may have failed silently."))}}),2e3);var e=this.showLoading;this.showLoading=function(){return t.loadingStartTime=(new Date).getTime(),e.call(t)};var o=this.hideLoading;this.hideLoading=function(){return t.loadingStartTime=0,o.call(t)},console.log("Loader safety system installed")}},{key:"ensureLoaderHidden",value:function(){this.loadingIndicator&&"none"!==window.getComputedStyle(this.loadingIndicator).display&&(console.log("Force hiding loader that was left visible"),this.hideLoading());var t=document.querySelectorAll(".product-estimator-modal-loading");if(t.length>1){console.warn("Found ".concat(t.length," loading indicators, cleaning up duplicates"));for(var e=1;e<t.length;e++)t[e].remove()}g()(t).call(t,(function(t){t.style.display="none"}))}},{key:"resetModalState",value:function(){console.log("Resetting modal state");var t=function(t){t&&(t.style.display="none","undefined"!=typeof jQuery&&jQuery(t).hide())};t(this.estimatesList),t(this.estimateSelection),t(this.estimateSelectionForm),t(this.roomSelectionForm),t(this.newEstimateForm),t(this.newRoomForm),this.roomSelectionForm&&this.roomSelectionForm.removeAttribute("data-estimate-id"),this.newRoomForm&&(this.newRoomForm.removeAttribute("data-estimate-id"),this.newRoomForm.removeAttribute("data-product-id"))}},{key:"loadEstimatesList",value:function(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(N())((function(n,i){var s;t.showLoading(),t.estimatesList?(t.estimatesList.style.display="block",console.log(w()(s="Loading estimates list with expansion params - Room: ".concat(o,", Estimate: ")).call(s,r)),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"get_estimates_list",nonce:productEstimatorVars.nonce},success:function(s){if(s.success&&s.data.html)t.estimatesList.innerHTML=s.data.html,e()((function(){if(r&&!t.modal.querySelector('.estimate-section[data-estimate-id="'.concat(r,'"]'))){var n=t.modal.querySelectorAll(".estimate-section");console.log("Adding missing data-estimate-id attributes to ".concat(n.length," estimates")),g()(n).call(n,(function(t,e){if(!t.dataset.estimateId){var o=t.querySelector(".remove-estimate");o&&o.dataset.estimateId?(t.dataset.estimateId=o.dataset.estimateId,console.log("Added estimate ID ".concat(o.dataset.estimateId," to section"))):(t.dataset.estimateId=String(e),console.log("Added fallback estimate ID ".concat(e," to section")))}}))}e()((function(){t.updateEstimatesList(o,r)}),150),t.initializeAccordions(o,r),t.bindProductRemovalEvents(),t.bindRoomRemovalEvents(),t.bindEstimateRemovalEvents(),t.bindEstimateListEventHandlers(),Dt(),t.initializeCarousels(),t.bindSuggestedProductButtons()}),150),n(s.data.html);else{var a=new Error("Failed to load estimates list");console.error(a),i(a)}},error:function(t){console.error("Error loading estimates list:",t),i(t)},complete:function(){t.hideLoading()}})):i(new Error("Estimates list container not found"))}))}},{key:"handleProductRemoval",value:function(t,o,r){var n,i,s=this;this.showLoading(),console.log(w()(n=w()(i="Removing product at index ".concat(r," from room ")).call(i,o," in estimate ")).call(n,t)),this.dataService.removeProductFromRoom(t,o,r).then((function(r){return s.loadEstimatesList(o,t).then((function(){var r,n;console.log(w()(r="Estimates list refreshed, attempting to expand room ".concat(o," in estimate ")).call(r,t));var i=s.modal.querySelector('.estimate-section[data-estimate-id="'.concat(t,'"]'));if(i){i.classList.remove("collapsed");var a=i.querySelector(".estimate-content");a&&(a.style.display="block")}var c=s.modal.querySelector(w()(n='.accordion-item[data-room-id="'.concat(o,'"][data-estimate-id="')).call(n,t,'"]'));if(c||(console.log("Using fallback room selector"),s.modal.querySelector('.accordion-item[data-room-id="'.concat(o,'"]')),function(){throw new TypeError('"roomElement" is read-only')}()),c){console.log("Found room element, expanding it");var l=c.querySelector(".accordion-header"),u=c.querySelector(".accordion-content");l&&l.classList.add("active"),u&&(u.style.display="block"),e()((function(){c.scrollIntoView({behavior:"smooth",block:"center"})}),200)}else console.warn("Could not find room element for room ID ".concat(o));s.showMessage("Product removed successfully","success")}))})).catch((function(t){console.error("Error removing product:",t),s.showError(t.message||"Error removing product. Please try again.")})).finally((function(){s.hideLoading()}))}},{key:"handleAddSuggestedProduct",value:function(t,o,r,n){var i,s,a=this;this.showLoading(),n&&(n.disabled=!0,n.classList.add("loading"),n.innerHTML='<span class="loading-dots">Adding...</span>'),console.log(w()(i=w()(s="Adding suggested product ".concat(t," to room ")).call(s,r," in estimate ")).call(i,o)),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"add_product_to_room",nonce:productEstimatorVars.nonce,product_id:t,room_id:r,estimate_id:o},success:function(t){var n,i;console.log("Add suggested product response:",t),t.success?a.loadEstimatesList(r,o).then((function(){e()((function(){var t=a.modal.querySelector('.accordion-item[data-room-id="'.concat(r,'"]'));if(t){var e=t.querySelector(".accordion-header");e&&!e.classList.contains("active")&&e.click()}}),300),a.showMessage("Product added successfully!","success")})).catch((function(t){console.error("Error refreshing estimates list:",t),a.showError("Error refreshing list. Please try again.")})):null!==(n=t.data)&&void 0!==n&&n.duplicate?(console.log("Duplicate suggested product detected:",t.data),a.showMessage(t.data.message||"This product already exists in this room.","error")):a.showError((null===(i=t.data)||void 0===i?void 0:i.message)||"Error adding product. Please try again.")},error:function(t,e,o){console.error("AJAX error:",e,o),a.showError("Error adding product. Please try again.")},complete:function(){n&&(n.disabled=!1,n.classList.remove("loading"),n.textContent="Add"),a.hideLoading()}})}},{key:"bindSuggestedProductButtons",value:function(){var t=this;console.log("Binding suggested product buttons");var e=this.modal.querySelectorAll(".add-suggestion-to-room");e.length?(console.log("Found ".concat(e.length," suggestion buttons to bind")),g()(e).call(e,(function(e){e._suggestionButtonHandler&&e.removeEventListener("click",e._suggestionButtonHandler),e._suggestionButtonHandler=function(o){o.preventDefault(),o.stopPropagation();var r=e.dataset.productId,n=e.dataset.estimateId,i=e.dataset.roomId;console.log("Add suggestion button clicked:",{productId:r,estimateId:n,roomId:i}),r&&n&&i?t.handleAddSuggestedProduct(r,n,i,e):console.error("Missing required data attributes for adding suggested product")},e.addEventListener("click",e._suggestionButtonHandler)})),console.log("Suggestion buttons bound successfully")):console.log("No suggestion buttons found to bind")}},{key:"handleRoomRemoval",value:function(t,o){var r,n=this,i=this.modal.querySelector('.accordion-item[data-room-id="'.concat(o,'"]')),s=i&&(null===(r=i.querySelector(".room-name"))||void 0===r?void 0:r.textContent)||"room";this.showLoading(),console.log("Removing room with parameters:",{estimate_id:t,room_id:o}),this.dataService.removeRoom(t,o).then((function(o){console.log("Room removal response:",o),n.loadEstimatesList(null,t).then((function(){if(n.showMessage("".concat(s," removed successfully"),"success"),!1===o.has_rooms){console.log("Estimate has no rooms left after removal");var r=n.modal.querySelector('.estimate-section[data-estimate-id="'.concat(t,'"] .add-room'));r&&(r.classList.add("highlight-btn"),e()((function(){r.classList.remove("highlight-btn")}),2e3))}})).catch((function(t){n.log("Error refreshing estimates list:",t),n.showError("Error refreshing estimates list. Please try again.")}))})).catch((function(t){n.log("Error removing room:",t),n.showError(t.message||"Error removing room. Please try again.")})).finally((function(){n.hideLoading()}))}},{key:"handleEstimateRemoval",value:function(t){var e=this;this.showLoading(),this.dataService.removeEstimate(t).then((function(){e.loadEstimatesList().then((function(){e.showMessage("Estimate removed successfully","success")})).catch((function(t){e.log("Error refreshing estimates list:",t),e.showError("Error refreshing estimates list. Please try again.")}))})).catch((function(t){e.log("Error removing estimate:",t),e.showError(t.message||"Error removing estimate. Please try again.")})).finally((function(){e.hideLoading()}))}},{key:"bindProductRemovalEvents",value:function(){var t=this;console.log("Binding product removal events"),this.estimatesList&&(this._productRemovalHandler&&this.estimatesList.removeEventListener("click",this._productRemovalHandler),this._productRemovalHandler=function(e){var o=e.target.closest(".remove-product");if(o){e.preventDefault(),e.stopPropagation();var r=o.dataset.estimateId,n=o.dataset.roomId,i=o.dataset.productIndex;console.log("Remove product button clicked:",{estimateId:r,roomId:n,productIndex:i}),r&&n&&void 0!==i?t.confirmDelete("product",r,n,i):console.error("Missing data attributes for product removal")}},this.estimatesList.addEventListener("click",this._productRemovalHandler)),console.log("Product removal events bound with duplicate prevention")}},{key:"bindRoomRemovalEvents",value:function(){var t=this;this.estimatesList&&(this._roomRemovalHandler&&this.estimatesList.removeEventListener("click",this._roomRemovalHandler),this._roomRemovalHandler=function(e){var o=e.target.closest(".remove-room");if(o){e.preventDefault(),e.stopPropagation();var r=o.dataset.estimateId,n=o.dataset.roomId;console.log("Remove room button clicked:",{estimateId:r,roomId:n}),r&&n&&t.confirmDelete("room",r,n)}},this.estimatesList.addEventListener("click",this._roomRemovalHandler))}},{key:"bindEstimateRemovalEvents",value:function(){var t=this;this.estimatesList&&(this._estimateRemovalHandler&&this.estimatesList.removeEventListener("click",this._estimateRemovalHandler),this._estimateRemovalHandler=function(e){var o=e.target.closest(".remove-estimate");if(o){e.preventDefault(),e.stopPropagation();var r=o.dataset.estimateId;console.log("Remove estimate button clicked:",{estimateId:r}),r&&t.confirmDelete("estimate",r)}},this.estimatesList.addEventListener("click",this._estimateRemovalHandler))}},{key:"confirmDelete",value:function(t,e,o,r){var n,i,s=this,a=(null===(n=window.productEstimatorVars)||void 0===n?void 0:n.i18n)||{},c=a.dialog_titles||{},l=a.dialog_messages||{},u="",d="",m="";switch(t){case"estimate":u=c.estimate||"Delete Estimate",d=l.estimate||"Are you sure you want to delete this estimate and all its rooms?",m=a.delete||"Delete";break;case"room":u=c.room||"Delete Room",d=l.room||"Are you sure you want to delete this room and all its products?",m=a.delete||"Delete";break;case"product":u=c.product||"Remove Product",d=l.product||"Are you sure you want to remove this product from the room?",m=a.remove||"Remove"}this.log(w()(i="Confirming deletion of ".concat(t," - ID: ")).call(i,"product"===t?r:"room"===t?o:e)),kt.show({title:u,message:d,type:t,confirmText:m,onConfirm:function(){switch(s.log("User confirmed deletion of ".concat(t)),t){case"estimate":s.handleEstimateRemoval(e);break;case"room":s.handleRoomRemoval(e,o);break;case"product":s.handleProductRemoval(e,o,r)}},onCancel:function(){s.log("User cancelled deletion of ".concat(t))}})}},{key:"loadEstimateSelectionForm",value:function(){var t=this;return new(N())((function(e,o){t.estimateSelectionForm?(t.showLoading(),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"get_estimate_selection_form",nonce:productEstimatorVars.nonce},success:function(r){if(r.success&&r.data.html)t.estimateSelectionForm.innerHTML=r.data.html,t.loadEstimatesData(),t.bindEstimateSelectionFormEvents(),e(r.data.html);else{var n=new Error("Failed to load estimate selection form");console.error(n),o(n)}},error:function(t){console.error("Error loading estimate selection form:",t),o(t)},complete:function(){t.hideLoading()}})):o(new Error("Estimate selection form container not found"))}))}},{key:"bindEstimateSelectionFormEvents",value:function(){var t=this;console.log("Binding estimate selection form events");var e=this.estimateSelectionForm.querySelector("form");if(e){console.log("Form found:",e),this._estimateFormSubmitHandler&&e.removeEventListener("submit",this._estimateFormSubmitHandler),this._estimateFormSubmitHandler=function(o){o.preventDefault(),console.log("Estimate selection form submitted"),t.handleEstimateSelection(e)},e.addEventListener("submit",this._estimateFormSubmitHandler);var o=e.querySelector("#create-estimate-btn");o&&(this._createEstimateHandler&&o.removeEventListener("click",this._createEstimateHandler),this._createEstimateHandler=function(e){console.log("Create estimate button clicked"),t.showNewEstimateForm()},o.addEventListener("click",this._createEstimateHandler)),console.log("Form events bound successfully")}else console.error("Cannot bind events - form not found in estimate selection form")}},{key:"loadEstimatesData",value:function(){var t=this;this.showLoading(),this.dataService.getEstimatesData().then((function(e){t.estimateSelectionForm.querySelector("#estimate-dropdown")?(t.populateEstimateDropdown(e),t.hideLoading()):t.loadEstimateSelectionForm().then((function(){return t.populateEstimateDropdown(e)})).catch((function(e){t.log("Error loading estimate selection form:",e),t.showError("Error loading estimate selection form. Please try again.")})).finally((function(){t.hideLoading()}))})).catch((function(e){t.log("Error loading estimates data:",e),t.showError("Error loading estimates data. Please try again."),t.hideLoading()}))}},{key:"populateEstimateDropdown",value:function(t){var e=this.estimateSelectionForm?this.estimateSelectionForm.querySelector("#estimate-dropdown"):null;if(e){e.innerHTML="";var o=document.createElement("option");o.value="",o.textContent=productEstimatorVars.i18n.select_estimate||"-- Select an Estimate --",e.appendChild(o),I()(t)&&g()(t).call(t,(function(t){if(t){var o,r=t.rooms?Z()(t.rooms).length:0,n=1===r?"1 room":"".concat(r," rooms"),i=document.createElement("option");i.value=t.id,i.textContent=w()(o="".concat(t.name||"Unnamed Estimate"," (")).call(o,n,")"),e.appendChild(i)}})),this.log("Populated dropdown with ".concat(t?t.length:0," estimates"))}else this.log("Estimate dropdown not found, cannot populate")}},{key:"showNewEstimateForm",value:function(){var t=this;this.estimatesList&&(this.estimatesList.style.display="none"),this.estimateSelection&&(this.estimateSelection.style.display="none"),this.forceElementVisibility(this.newEstimateForm),this.newEstimateForm.querySelector("form")?(this.hideLoading(),this.bindCancelButton(this.newEstimateForm,"estimate")):this.loadNewEstimateForm().finally((function(){t.hideLoading(),t.bindCancelButton(t.newEstimateForm,"estimate")}))}},{key:"bindCancelButton",value:function(t,e){var o=this;if(t){var r=t.querySelector(".cancel-btn");r?(r.removeEventListener("click",this._cancelFormHandler),this._cancelFormHandler=function(){console.log("Cancel button clicked for ".concat(e," form")),o.cancelForm(e)},r.addEventListener("click",this._cancelFormHandler),console.log("Cancel button bound for ".concat(e," form"))):console.warn("No cancel button found in ".concat(e," form"))}}},{key:"loadNewEstimateForm",value:function(){var t=this;return new(N())((function(o,r){t.showLoading(),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"get_new_estimate_form",nonce:productEstimatorVars.nonce},success:function(n){if(n.success&&n.data.html){t.newEstimateForm.innerHTML=n.data.html,window.productEstimator&&window.productEstimator.core&&window.productEstimator.core.customerDetailsManager&&e()((function(){window.productEstimator.core.customerDetailsManager.init()}),100);var i=t.newEstimateForm.querySelector("form");if(i){i.addEventListener("submit",(function(e){e.preventDefault(),t.handleNewEstimateSubmission(i)}));var s=i.querySelector(".cancel-btn");s&&s.addEventListener("click",(function(){t.cancelForm("estimate")}))}document.dispatchEvent(new CustomEvent("product_estimator_modal_loaded")),o(n.data.html)}else r(new Error("Failed to load new estimate form"))},error:function(t){console.error("Error loading new estimate form:",t),r(t)},complete:function(){t.hideLoading()}})}))}},{key:"showNewRoomForm",value:function(t){if(console.log("Showing new room form for estimate:",t),this.newRoomForm){this.newRoomForm.dataset.estimateId=t;var e=this.newRoomForm.querySelector("form");e&&(e.dataset.estimateId=t)}if(this.estimatesList&&(this.estimatesList.style.display="none"),this.estimateSelection&&(this.estimateSelection.style.display="none"),this.roomSelectionForm&&(this.roomSelectionForm.style.display="none"),this.forceElementVisibility(this.newRoomForm),this.newRoomForm.querySelector("form")){var o=this.newRoomForm.querySelector("form");o&&(o.dataset.estimateId=t)}else this.loadNewRoomForm(t)}},{key:"loadNewRoomForm",value:function(t){var e=this;return new(N())((function(o,r){e.showLoading(),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"get_new_room_form",nonce:productEstimatorVars.nonce},success:function(n){if(n.success&&n.data.html){e.newRoomForm.innerHTML=n.data.html;var i=e.newRoomForm.querySelector("form");if(i){i.dataset.estimateId=t,e._newRoomFormSubmitHandler&&i.removeEventListener("submit",e._newRoomFormSubmitHandler),e._newRoomFormSubmitHandler=function(t){t.preventDefault(),console.log("New room form submitted"),e.handleNewRoomSubmission(i)},i.addEventListener("submit",e._newRoomFormSubmitHandler);var s=i.querySelector(".cancel-btn");s&&s.addEventListener("click",(function(){e.cancelForm("room")}))}o(n.data.html)}else r(new Error("Failed to load new room form"))},error:function(t){console.error("Error loading new room form:",t),r(t)},complete:function(){e.hideLoading()}})}))}},{key:"bindEstimateListEventHandlers",value:function(){var t=this;this.estimatesList?(this._addRoomButtonHandler&&this.estimatesList.removeEventListener("click",this._addRoomButtonHandler),this._addRoomButtonHandler=function(e){var o=e.target.closest(".add-room");if(o){e.preventDefault(),e.stopPropagation();var r=o.dataset.estimate;console.log("Add room button clicked for estimate:",r),r?t.showNewRoomForm(r):console.error("No estimate ID found for add room button")}},this.estimatesList.addEventListener("click",this._addRoomButtonHandler),console.log("Add room button event handler bound")):console.error("Cannot bind events - estimates list container not found")}},{key:"bindRoomSelectionFormEvents",value:function(){var t=this;console.log("Binding room selection form events");var e=this.roomSelectionForm.querySelector("form");if(e){console.log("Room selection form found:",e),this._roomFormSubmitHandler&&e.removeEventListener("submit",this._roomFormSubmitHandler),this._roomFormSubmitHandler=function(o){o.preventDefault(),console.log("Room selection form submitted"),t.handleRoomSelection(e)},e.addEventListener("submit",this._roomFormSubmitHandler);var o=e.querySelector(".back-btn");o&&(this._backButtonHandler&&o.removeEventListener("click",this._backButtonHandler),this._backButtonHandler=function(){console.log("Back button clicked"),t.forceElementVisibility(t.estimateSelectionForm),t.forceElementVisibility(t.estimateSelection),t.roomSelectionForm.style.display="none"},o.addEventListener("click",this._backButtonHandler));var r=e.querySelector("#add-new-room-from-selection");r?(this._addNewRoomHandler&&r.removeEventListener("click",this._addNewRoomHandler),this._addNewRoomHandler=function(){console.log("Add new room button clicked in form");var e=t.roomSelectionForm.dataset.estimateId;console.log("Estimate ID for new room:",e),e?t.showNewRoomForm(e):console.error("No estimate ID found for new room")},r.addEventListener("click",this._addNewRoomHandler),console.log("Add new room button handler bound")):console.warn("Add new room button not found in room selection form"),console.log("Room selection form events bound successfully")}else console.error("Cannot bind events - form not found in room selection form")}},{key:"handleEstimateSelection",value:function(t){var e=this,o=t.querySelector("#estimate-dropdown").value,r=this.currentProductId;o?(this.showLoading(),this.dataService.getRoomsForEstimate(o,r).then((function(t){if(e.estimateSelectionForm.style.display="none",t.has_rooms){var n=document.getElementById("room-dropdown");if(n){var i;n.innerHTML="",n.appendChild(new Option("-- Select a Room --","")),g()(i=t.rooms).call(i,(function(t){var e;n.appendChild(new Option(w()(e="".concat(t.name," (")).call(e,t.dimensions,")"),t.id))})),e.roomSelectionForm.dataset.estimateId=o;var s=document.getElementById("add-new-room-from-selection");s&&(s.dataset.estimate=o),e.forceElementVisibility(e.roomSelectionForm),e.bindRoomSelectionFormEvents()}else e.loadRoomSelectionForm(o).then((function(){e.roomSelectionForm.dataset.estimateId=o,e.forceElementVisibility(e.roomSelectionForm),e.bindRoomSelectionFormEvents()})).catch((function(t){e.log("Error loading room selection form:",t),e.showError("Error loading room selection form. Please try again.")}))}else e.newRoomForm.dataset.estimateId=o,e.newRoomForm.dataset.productId=r,e.forceElementVisibility(e.newRoomForm)})).catch((function(t){e.log("Error getting rooms:",t),e.showError("Error getting rooms. Please try again.")})).finally((function(){e.hideLoading()}))):this.showError("Please select an estimate")}},{key:"loadRoomSelectionForm",value:function(t){var e=this;return new(N())((function(o,r){e.roomSelectionForm?(e.showLoading(),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"get_room_selection_form",nonce:productEstimatorVars.nonce,estimate_id:t},success:function(n){if(n.success&&n.data.html)e.roomSelectionForm.innerHTML=n.data.html,e.roomSelectionForm.dataset.estimateId=t,e.bindRoomSelectionFormEvents(),o(n.data.html);else{var i=new Error("Failed to load room selection form");console.error(i),r(i)}},error:function(t){console.error("Error loading room selection form:",t),r(t)},complete:function(){e.hideLoading()}})):r(new Error("Room selection form container not found"))}))}},{key:"handleRoomSelection",value:function(t){var o,r,n,i=this,s=et()(o=String(t.querySelector("#room-dropdown").value||"")).call(o),a=et()(r=String(this.currentProductId||"")).call(r),c=et()(n=String(this.roomSelectionForm.dataset.estimateId||"")).call(n);return null==s||""===s?(this.showError("Please select a room"),void console.error("Room selection requires a valid room ID but it was empty or invalid")):null==a||""===a||"0"===a?(this.showError("No product selected"),void console.error("Room selection requires a valid product ID but it was empty or invalid")):(console.log("Room selection validated with:",{roomId:s,productId:a,estimateId:c,formData:V()(new FormData(t))}),this.showLoading(),void jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"add_product_to_room",nonce:productEstimatorVars.nonce,room_id:s,product_id:a,estimate_id:c},success:function(t){if(console.log("Add product AJAX response:",t),t.success){var o,r,n;i.estimateSelection.style.display="none",i.roomSelectionForm.style.display="none",delete i.modal.dataset.productId,i.currentProductId=null;var a=(null===(o=t.data)||void 0===o?void 0:o.estimate_id)||c,l=(null===(r=t.data)||void 0===r?void 0:r.room_id)||s;console.log(w()(n="Product added to estimate ".concat(a,", room ")).call(n,l)),i.loadEstimatesList(l,a).then((function(){i.showMessage("Product added successfully!","success")})).catch((function(t){i.log("Error refreshing estimates list:",t),i.showError("Error refreshing estimates list. Please try again.")}))}else{var u;if(null!==(u=t.data)&&void 0!==u&&u.duplicate){console.log("Duplicate product detected:",t.data),i.estimateSelection.style.display="none",i.roomSelectionForm.style.display="none",delete i.modal.dataset.productId,i.currentProductId=null;var d=t.data.estimate_id,m=t.data.room_id;i.showError(t.data.message||"This product already exists in the selected room."),i.loadEstimatesList(m,d).then((function(){console.log("Estimates list refreshed to show duplicate product location"),e()((function(){var t=i.modal.querySelector('.estimate-section[data-estimate-id="'.concat(d,'"]'));if(t&&t.classList.contains("collapsed")){t.classList.remove("collapsed");var e=t.querySelector(".estimate-content");e&&("undefined"!=typeof jQuery?jQuery(e).slideDown(200):e.style.display="block")}var o=i.modal.querySelector('.accordion-item[data-room-id="'.concat(m,'"]'));if(o){var r=o.querySelector(".accordion-header");if(r&&!r.classList.contains("active")){r.classList.add("active");var n=o.querySelector(".accordion-content");n&&("undefined"!=typeof jQuery?jQuery(n).slideDown(300,(function(){o.scrollIntoView({behavior:"smooth",block:"center"})})):(n.style.display="block",o.scrollIntoView({behavior:"smooth",block:"center"})))}else o.scrollIntoView({behavior:"smooth",block:"center"})}}),300)})).catch((function(t){console.error("Error refreshing estimates list:",t)}))}else{var h,f=(null===(h=t.data)||void 0===h?void 0:h.message)||"Error adding product to room. Please try again.";i.showError(f),console.error("AJAX error response:",t)}}},error:function(t,e,o){i.log("Error adding product to room:",e,o),i.showError("Error adding product to room. Please try again."),console.error("AJAX error details:",{jqXHR:t,textStatus:e,errorThrown:o})},complete:function(){i.hideLoading()}}))}},{key:"handleNewEstimateSubmission",value:function(t){var e=this,o=new FormData(t),r=this.currentProductId;this.showLoading(),console.log("Submitting new estimate form"),this.dataService.addNewEstimate(o,r).then((function(o){if(console.log("New estimate created with ID:",o.estimate_id),t.reset(),e.newEstimateForm.style.display="none",r){var n=o.estimate_id;console.log("Setting new room form with estimate ID:",n),e.newRoomForm.dataset.estimateId=n;var i=e.newRoomForm.querySelector("form");i?(i.dataset.estimateId=n,console.log("Form dataset updated:",i.dataset)):console.error("Could not find room form element"),e.newRoomForm.dataset.productId=r,e.forceElementVisibility(e.newRoomForm),e.hideLoading()}else e.loadEstimatesList().catch((function(t){e.log("Error refreshing estimates list:",t),e.showError("Error refreshing estimates list. Please try again.")})).finally((function(){e.hideLoading()}))})).catch((function(t){e.log("Error creating estimate:",t),e.showError(t.message||"Error creating estimate. Please try again."),e.hideLoading()}))}},{key:"handleNewRoomSubmission",value:function(t,e){var o=this;if(console.log("Processing new room form submission via AJAX"),e?e.preventDefault():void 0!==window.event&&window.event.preventDefault(),!t.checkValidity())return console.error("Form validation failed"),void t.reportValidity();var r=new FormData(t),n=t.dataset.estimateId,i=this.currentProductId||t.dataset.productId;console.log("Room form submission data:",{formElement:t,formDataset:t.dataset,containerDataset:this.newRoomForm.dataset,estimateId:n,productId:i,formData:V()(r)}),null!=n&&""!==n?(this.showLoading(),console.log("Submitting room for estimate ID:",n),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"add_new_room",nonce:productEstimatorVars.nonce,estimate_id:n,product_id:i||"",form_data:jQuery(t).serialize()},success:function(e){if(e.success){var r,i;console.log("Room added successfully:",e.data),t.reset(),o.newRoomForm.style.display="none",delete o.modal.dataset.productId,o.currentProductId=null;var s=(null===(r=e.data)||void 0===r?void 0:r.estimate_id)||n,a=(null===(i=e.data)||void 0===i?void 0:i.room_id)||"0";o.loadEstimatesList(a,s).then((function(){o.showMessage("Room added successfully!","success")})).catch((function(t){console.error("Error refreshing estimates list:",t),o.showError("Error refreshing estimates list. Please try again.")}))}else console.error("Error adding room:",e.data.message),o.showError(e.data.message||"Error adding room. Please try again.")},error:function(t,e,r){console.error("AJAX error:",e,r),o.showError("Error adding room. Please try again.")},complete:function(){o.hideLoading()}})):this.showError("No estimate selected for this room.")}},{key:"cancelForm",value:function(t){var e=this;switch(console.log("Canceling form type: ".concat(t)),t){case"estimate":this.newEstimateForm&&(this.newEstimateForm.style.display="none"),this.currentProductId?this.dataService.checkEstimatesExist().then((function(t){t?(e.forceElementVisibility(e.estimateSelectionForm),e.forceElementVisibility(e.estimateSelection)):e.forceElementVisibility(e.estimatesList)})).catch((function(t){console.error("Error checking estimates:",t),e.forceElementVisibility(e.estimatesList)})):this.forceElementVisibility(this.estimatesList);break;case"room":this.newRoomForm&&(this.newRoomForm.style.display="none"),this.currentProductId&&this.roomSelectionForm.dataset.estimateId?(this.forceElementVisibility(this.roomSelectionForm),this.forceElementVisibility(this.estimateSelection)):this.forceElementVisibility(this.estimatesList);break;default:console.warn("Unknown form type: ".concat(t)),this.forceElementVisibility(this.estimatesList)}}},{key:"initializeEstimateAccordions",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=document.querySelectorAll(".estimate-header");if(g()(e).call(e,(function(t){t._estimateAccordionHandler&&t.removeEventListener("click",t._estimateAccordionHandler),t._estimateAccordionHandler=function(e){if(!e.target.closest(".remove-estimate")){var o=t.closest(".estimate-section");if(o&&(o.classList.toggle("collapsed"),"undefined"!=typeof jQuery)){var r=o.querySelector(".estimate-content");r&&(o.classList.contains("collapsed")?jQuery(r).slideUp(200):jQuery(r).slideDown(200))}}},t.addEventListener("click",t._estimateAccordionHandler)})),t){var o=document.querySelector('.estimate-section[data-estimate-id="'.concat(t,'"]'));if(o&&o.classList.contains("collapsed")){if(o.classList.remove("collapsed"),"undefined"!=typeof jQuery){var r=o.querySelector(".estimate-content");r&&jQuery(r).slideDown(200)}window.productEstimatorVars&&window.productEstimatorVars.debug&&console.log("Auto-expanded estimate ID: ".concat(t))}}}},{key:"toggleEstimateAccordion",value:function(t){this.log("Toggling estimate accordion");var e=t.closest(".estimate-section");if(e){e.classList.toggle("collapsed");var o=e.querySelector(".estimate-content");o?e.classList.contains("collapsed")?(this.log("Collapsing estimate content"),"undefined"!=typeof jQuery?jQuery(o).slideUp(200):o.style.display="none"):(this.log("Expanding estimate content"),"undefined"!=typeof jQuery?jQuery(o).slideDown(200):o.style.display="block"):this.log("No estimate content found")}else this.log("No parent estimate section found")}},{key:"initializeAccordions",value:function(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.modal){if(this.accordionHandler&&this.estimatesList.removeEventListener("click",this.accordionHandler),this.accordionHandler=function(o){var r=o.target.closest(".accordion-header");if(r){o.preventDefault(),o.stopPropagation(),t.log("Accordion header clicked via delegation"),t.toggleAccordionItem(r);var n=r.closest(".accordion-item");if(n){var i=n.querySelector(".accordion-content");i&&"none"!==window.getComputedStyle(i).display&&e()((function(){var e=i.querySelectorAll(".suggestions-carousel");e.length&&(t.log("Found ".concat(e.length," carousels in opened accordion")),Ft())}),100)}}},this.estimatesList&&(this.estimatesList.addEventListener("click",this.accordionHandler),this.log("Accordion event handler (re)attached"),o)){var n,i='.accordion-item[data-room-id="'.concat(o,'"]');r&&(i=w()(n='.estimate-section[data-estimate-id="'.concat(r,'"] ')).call(n,i));var s=this.modal.querySelector(i);if(s){this.log("Found room element to expand: ".concat(i));var a=s.closest(".estimate-section");a&&(a.style.display="block");var c=s.querySelector(".accordion-header");if(c){var l;c.classList.add("active");var u=s.querySelector(".accordion-content");u&&(u.style.display="block","undefined"!=typeof jQuery&&jQuery(u).show(300),e()((function(){Ft()}),150)),e()((function(){s.scrollIntoView({behavior:"smooth",block:"center"})}),150),this.log(w()(l="Auto-expanded room ID: ".concat(o," in estimate: ")).call(l,r||"any"))}}else{var d;this.log("Room ID ".concat(o," not found for auto-expansion"));var m=this.modal.querySelectorAll(".accordion-item[data-room-id]");this.log("Available rooms: ".concat(rt()(d=x()(m)).call(d,(function(t){return t.dataset.roomId})).join(", ")))}}}else console.error("[ModalManager] Modal not available for initializing accordions")}},{key:"toggleAccordionItem",value:function(t){this.log("Toggling accordion item"),t.classList.toggle("active");var e=t.closest(".accordion-item");if(e){var o=e.querySelector(".accordion-content");o?t.classList.contains("active")?(this.log("Opening accordion content"),"undefined"!=typeof jQuery?jQuery(o).slideDown(200):o.style.display="block"):(this.log("Closing accordion content"),"undefined"!=typeof jQuery?jQuery(o).slideUp(200):o.style.display="none"):this.log("No accordion content found")}else this.log("No parent accordion item found")}},{key:"initializeJQueryAccordions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"undefined"!=typeof jQuery?(jQuery(document).off("click",".accordion-header"),jQuery(document).on("click",".accordion-header",(function(t){var e;t.preventDefault(),t.stopPropagation(),console.log("jQuery accordion handler triggered");var o=jQuery(this);o.toggleClass("active");var r=it()(e=o.closest(".accordion-item")).call(e,".accordion-content");r.length&&(o.hasClass("active")?r.slideDown(200):r.slideUp(200))})),t&&e()((function(){var e,r='.accordion-item[data-room-id="'.concat(t,'"]');o&&(r=w()(e='.estimate-section[data-estimate-id="'.concat(o,'"] ')).call(e,r)),console.log("Looking for room with selector: ".concat(r));var n=jQuery(r);if(n.length){console.log("Found room element using jQuery: ".concat(r));var i=n.closest(".estimate-section");i.length&&i.show();var s=it()(n).call(n,".accordion-header");if(s.length){var a;s.addClass("active");var c=it()(n).call(n,".accordion-content");c.length&&c.slideDown(300,(function(){n[0].scrollIntoView({behavior:"smooth",block:"center"})})),console.log(w()(a="jQuery auto-expanded room ID: ".concat(t," in estimate: ")).call(a,o||"any"))}}else{var l;console.warn("Room element not found with jQuery using selector: ".concat(r)),console.log("Available room elements:",rt()(l=jQuery(".accordion-item[data-room-id]")).call(l,(function(){return jQuery(this).data("roomId")})).get())}}),300)):this.log("jQuery not available for fallback")}},{key:"updateEstimatesList",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.modal.querySelector(".estimate-section")){var r=this.modal.querySelector(".no-estimates");r&&(r.style.display="none")}else{var n=this.modal.querySelector(".no-estimates");if(n){n.style.display="block";var i=n.querySelector("#create-estimate-btn");i&&(this._createEstimateBtnHandler&&i.removeEventListener("click",this._createEstimateBtnHandler),this._createEstimateBtnHandler=function(){t.showNewEstimateForm()},i.addEventListener("click",this._createEstimateBtnHandler),console.log("Added event handler to existing create estimate button"))}}this.updateAllSuggestionsVisibility(),this.initializeEstimateAccordions(e,o),this.initializeAccordions(e,o),this.initializeCarousels(),this.bindReplaceProductButtons(),this.bindSuggestedProductButtons()}},{key:"updateSuggestionVisibility",value:function(t,e){var o=this.modal.querySelector('.accordion-item[data-room-id="'.concat(e,'"]'));if(o){var r=o.querySelectorAll(".product-item:not(.product-note-item)").length>0,n=o.querySelector(".product-suggestions");n&&(n.style.display=r?"block":"none")}}},{key:"updateAllSuggestionsVisibility",value:function(){var t=this.modal.querySelectorAll(".accordion-item");g()(t).call(t,(function(t){var e,o=t.dataset.roomId,r=null===(e=t.closest(".estimate-section"))||void 0===e?void 0:e.dataset.estimateId;if(o&&r){var n=t.querySelectorAll(".product-item:not(.product-note-item)").length>0,i=t.querySelector(".product-suggestions");i&&(i.style.display=n?"block":"none")}}))}},{key:"showMessage",value:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=this.contentContainer||document.querySelector(".product-estimator-modal-form-container");if(r){var n=document.querySelectorAll(".modal-message");g()(n).call(n,(function(t){return t.remove()}));var i="error"===o?"modal-error-message":"modal-success-message",s=document.createElement("div");s.className="modal-message ".concat(i),s.textContent=t;try{r.prepend(s)}catch(t){console.error("Error adding message to container:",t)}e()((function(){s.parentNode&&s.remove()}),5e3)}else console.error("Form container not found for message display:",t)}},{key:"showError",value:function(t){this.showMessage(t,"error")}},{key:"on",value:function(t,e){return this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(e),this}},{key:"emit",value:function(t,e){var o;return this.eventHandlers[t]&&g()(o=this.eventHandlers[t]).call(o,(function(t){return t(e)})),this}},{key:"checkModalElements",value:function(){console.group("🔍 MODAL ELEMENTS CHECK");var t=function(t,e){var o,r=document.querySelectorAll(t);return console.log(w()(o="".concat(e,": ")).call(o,r.length," elements found")),r.length};t("#product-estimator-modal","Modal container"),t(".product-estimator-modal-form-container","Form container"),t("#estimates","Estimates list"),t("#estimate-selection-wrapper","Estimate selection"),t("#estimate-selection-form-wrapper","Estimate selection form"),t("#new-estimate-form-wrapper","New estimate form");var e=document.querySelector("#estimate-selection-wrapper");e?console.log("Estimate selection container:",{display:e.style.display,computedDisplay:window.getComputedStyle(e).display,visibility:window.getComputedStyle(e).visibility,opacity:window.getComputedStyle(e).opacity,parent:e.parentElement?e.parentElement.tagName:"none"}):console.warn("Estimate selection container not found"),console.groupEnd()}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[ModalManager]"]).call(e,r))}}},{key:"bindReplaceProductButtons",value:function(){var t=this;console.log("[BUTTON BINDING] Binding replace product buttons");var e=this.modal.querySelectorAll(".replace-product-in-room");e.length?(console.log("[BUTTON BINDING] Found ".concat(e.length," replace buttons to bind")),g()(e).call(e,(function(e,o){console.log("[BUTTON BINDING] Button #".concat(o+1," attributes:"),{productId:e.dataset.productId,estimateId:e.dataset.estimateId,roomId:e.dataset.roomId,replaceProductId:e.dataset.replaceProductId,replaceType:e.dataset.replaceType||"main"}),e._replaceButtonHandler&&e.removeEventListener("click",e._replaceButtonHandler),e._replaceButtonHandler=function(o){o.preventDefault(),o.stopPropagation();var r=e.dataset.productId,n=e.dataset.estimateId,i=e.dataset.roomId,s=e.dataset.replaceProductId,a=e.hasAttribute("data-replace-type")?e.getAttribute("data-replace-type"):"main";console.log("[BUTTON CLICKED] Replace product button clicked:",{estimateId:n,roomId:i,oldProductId:s,newProductId:r,replaceType:a}),t.handleReplaceProduct(n,i,s,r,e,a)},e.addEventListener("click",e._replaceButtonHandler)})),console.log("[BUTTON BINDING] Replace product buttons bound successfully")):console.log("[BUTTON BINDING] No replace product buttons found to bind")}},{key:"handleReplaceProduct",value:function(t,e,o,r,n){var i,s,a,c,l,u=this,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"main";console.log(w()(i=w()(s=w()(a=w()(c="[PRODUCT REPLACEMENT] Starting product replacement process\n    Type: ".concat(d,"\n    Old Product ID: ")).call(c,o,"\n    New Product ID: ")).call(a,r,"\n    Room ID: ")).call(s,e,"\n    Estimate ID: ")).call(i,t,"\n  "));var m="this product",h="the selected product";try{if(n){var f=n.closest(".suggestion-item, .upgrade-tile");if(f){var p,v=f.querySelector(".suggestion-name, .tile-label");v&&(h=et()(p=v.textContent).call(p))}if("additional_products"===d){console.log("Looking for additional product name to replace");var g=n.closest(".product-item");if(g){var y=g.querySelectorAll(".include-item");console.log("Found ".concat(y.length," include items to search through"));var b,S=function(t,e){var o=void 0!==L()&&P()(t)||t["@@iterator"];if(!o){if(I()(t)||(o=function(t,e){if(t){var o;if("string"==typeof t)return At(t,e);var r=E()(o={}.toString.call(t)).call(o,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?x()(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?At(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw i}}}}(y);try{for(S.s();!(b=S.n()).done;){var k=b.value,_=k.querySelector(".include-item-name");if(_){var C,F=k.closest("[data-product-id]");if(F&&F.dataset.productId===o){var D;m=et()(D=_.textContent).call(D),console.log("Found matching additional product: ".concat(m));break}m=et()(C=_.textContent).call(C)}}}catch(t){S.e(t)}finally{S.f()}}}else{var R=n.closest(".product-item");if(R){var A,T=R.querySelector(".product-name, .price-title");T&&(m=et()(A=T.textContent).call(A),console.log("Found main product name: ".concat(m)))}}}}catch(t){console.warn("Could not determine product names for confirmation dialog:",t)}var O=w()(l='Are you sure you want to replace "'.concat(m,'" with "')).call(l,h,'"?');window.productEstimator&&window.productEstimator.dialog?window.productEstimator.dialog.show({title:"Confirm Upgrade",message:O,type:"product",confirmText:"Upgrade",cancelText:"Cancel",onConfirm:function(){u.executeProductReplacement(t,e,o,r,n,d)},onCancel:function(){n&&(n.disabled=!1,n.classList.remove("loading"),n.textContent="Upgrade"),console.log("Product upgrade cancelled")}}):confirm(O)?this.executeProductReplacement(t,e,o,r,n,d):n&&(n.disabled=!1,n.classList.remove("loading"),n.textContent="Upgrade")}},{key:"reloadAndExpandEstimatesList",value:function(t,o){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new(N())((function(i,s){var a,c;r.showLoading(),console.log(w()(a=w()(c="Reloading estimates list with expansion params - Room: ".concat(t,", Estimate: ")).call(c,o,", Product: ")).call(a,n)),r.loadEstimatesList(t,o).then((function(){e()((function(){var s=r.modal.querySelector('.estimate-section[data-estimate-id="'.concat(o,'"]'));if(s){console.log("Found estimate section: ".concat(o)),s.classList.remove("collapsed");var a=s.querySelector(".estimate-content");a&&(a.style.display="block",e()((function(){var i,s=r.modal.querySelector(w()(i='.accordion-item[data-room-id="'.concat(t,'"][data-estimate-id="')).call(i,o,'"]'))||r.modal.querySelector('.accordion-item[data-room-id="'.concat(t,'"]'));if(s){console.log("Found and expanding room: ".concat(t));var a=s.querySelector(".accordion-header");a&&a.classList.add("active");var c=s.querySelector(".accordion-content");c&&(c.style.display="block",e()((function(){if(Ft(),n){var t=c.querySelectorAll(".product-item");g()(t).call(t,(function(t){(t.dataset.productId===n||t.querySelector('[data-product-id="'.concat(n,'"]')))&&(t.classList.add("highlight-product"),e()((function(){t.classList.remove("highlight-product")}),2e3),t.scrollIntoView({behavior:"smooth",block:"center"}))}))}else s.scrollIntoView({behavior:"smooth",block:"center"})}),150))}else console.warn("Room ID ".concat(t," not found for auto-expansion"))}),150))}else console.warn("Estimate ID ".concat(o," not found for auto-expansion"));i()}),200)})).catch((function(t){console.error("Error reloading estimates list:",t),s(t)})).finally((function(){r.hideLoading()}))}))}},{key:"executeProductReplacement",value:function(t,o,r,n,i){var s,a,c,l,u=this,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"main";this.showLoading(),i&&(i.disabled=!0,i.classList.add("loading"),i.innerHTML='<span class="loading-dots">Upgrading...</span>'),console.log(w()(s=w()(a=w()(c=w()(l="[PRODUCT REPLACEMENT] Executing replacement:\n    Type: ".concat(d,"\n    Old Product ID: ")).call(l,r,"\n    New Product ID: ")).call(c,n,"\n    Room ID: ")).call(a,o,"\n    Estimate ID: ")).call(s,t)),jQuery.ajax({url:productEstimatorVars.ajax_url,type:"POST",data:{action:"replace_product_in_room",nonce:productEstimatorVars.nonce,estimate_id:t,room_id:o,product_id:n,replace_product_id:r,replace_type:d},success:function(i){var s,a,c;console.log("[PRODUCT REPLACEMENT] Server response:",i),i.success?(window._productReplacementChains=window._productReplacementChains||{},window._productReplacementChains[w()(s="".concat(o,"_")).call(s,n)]=i.data.replacement_chain||[],u.loadEstimatesList(o,t).then((function(){var i;console.log("[PRODUCT REPLACEMENT] Estimates list refreshed");var s=u.modal.querySelector('.estimate-section[data-estimate-id="'.concat(t,'"]'));if(s){s.classList.remove("collapsed");var a=s.querySelector(".estimate-content");a&&(a.style.display="block")}var c=u.modal.querySelector(w()(i='.accordion-item[data-room-id="'.concat(o,'"][data-estimate-id="')).call(i,t,'"]'))||u.modal.querySelector('.accordion-item[data-room-id="'.concat(o,'"]'));if(c){console.log("[PRODUCT REPLACEMENT] Found room element, expanding");var l=c.querySelector(".accordion-header");l&&l.classList.add("active");var m=c.querySelector(".accordion-content");m&&(m.style.display="block","additional_products"===d&&u.updateAdditionalProductUpgradeButtons(c,n,r),e()((function(){Ft(),c.scrollIntoView({behavior:"smooth",block:"center"}),u.bindReplaceProductButtons(),u.bindSuggestedProductButtons(),u.updateAllReplacementChains(c),u.showMessage("Product upgraded successfully!","success")}),300))}else console.warn("[PRODUCT REPLACEMENT] Could not find room element for room ID ".concat(o)),u.showMessage("Product upgraded successfully!","success")})).catch((function(t){console.error("[PRODUCT REPLACEMENT] Error refreshing estimates list:",t),u.showError("Error refreshing list after upgrade. Please try again.")}))):(u.showError((null===(a=i.data)||void 0===a?void 0:a.message)||"Error upgrading product. Please try again."),null!==(c=i.data)&&void 0!==c&&c.debug&&console.error("[PRODUCT REPLACEMENT] Server reported error details:",i.data.debug))},error:function(t,e,o){console.error("[PRODUCT REPLACEMENT] AJAX error:",e,o),u.showError("Error upgrading product. Please try again.")},complete:function(){i&&(i.disabled=!1,i.classList.remove("loading"),i.textContent="Upgrade"),u.hideLoading()}})}},{key:"updateAllReplacementChains",value:function(t){if(t&&window._productReplacementChains){console.log("[REPLACEMENT CHAINS] Updating all buttons with replacement chains");var e=t.querySelectorAll('button.replace-product-in-room[data-replace-type="additional_products"]');g()(e).call(e,(function(t){t.dataset.productId;var e,o=t.dataset.roomId,r=t.dataset.replaceProductId,n=w()(e="".concat(o,"_")).call(e,r),i=window._productReplacementChains[n];i&&(console.log("[REPLACEMENT CHAINS] Found chain for ".concat(n,":"),i),t.dataset.replacementChain=at()(i),console.log("[REPLACEMENT CHAINS] Updated button ".concat(t.textContent," with chain data")))}))}}},{key:"updateAdditionalProductUpgradeButtons",value:function(t,e,o){var r;if(t){console.log(w()(r="Updating additional product upgrade buttons: newProductId=".concat(e,", oldProductId=")).call(r,o));var n=t.querySelectorAll('button.replace-product-in-room[data-replace-product-id="'.concat(o,'"][data-replace-type="additional_products"]'));n.length>0?(console.log("Found ".concat(n.length," additional product upgrade buttons to update")),g()(n).call(n,(function(t){var r;console.log(w()(r="Updating button data-replace-product-id from ".concat(o," to ")).call(r,e)),t.dataset.replaceProductId=e}))):console.log("No additional product upgrade buttons found that need updating");var i=t.querySelectorAll('.product-upgrades[data-product-id="'.concat(o,'"]'));g()(i).call(i,(function(t){var r;t.dataset.productId=e,console.log(w()(r="Updated product-upgrades container data-product-id from ".concat(o," to ")).call(r,e))}))}}},{key:"updateUpgradeButtonProductIds",value:function(t,e,o){var r;if(t){console.log(w()(r="Updating upgrade buttons: replacing ".concat(e," with ")).call(r,o));var n=t.querySelectorAll('button.replace-product-in-room[data-replace-product-id="'.concat(e,'"]'));n.length>0?(console.log("Found ".concat(n.length," upgrade buttons to update")),g()(n).call(n,(function(t){t.dataset.replaceProductId=o,console.log("Updated button to use new product ID: ".concat(o))}))):console.log("No upgrade buttons found that need updating")}}}])}();const Ot=Tt,qt=function(){return h((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.config=p()({debug:!0,selectors:{variationsForm:".variations_form",estimatorButton:".single_add_to_estimator_button, .button.alt.open-estimator-modal, .product-estimator-button, [data-product-id]",variationIdInput:'input[name="variation_id"]'}},e),this.variationsForm=document.querySelector(this.config.selectors.variationsForm),this.estimatorButton=document.querySelector(this.config.selectors.estimatorButton),this.variationIdInput=this.variationsForm?this.variationsForm.querySelector(this.config.selectors.variationIdInput):null,this.variationsData=window.product_estimator_variations||{},this.currentVariationId=null,this.initialized=!1,this.eventHandlers={},this.variationsForm?this.init():this.log("No variations form found, VariationHandler not initialized")}),[{key:"init",value:function(){if(this.initialized)return this.log("VariationHandler already initialized"),this;if(this.log("Initializing VariationHandler with variations data:",this.variationsData),this.log("Estimator button found:",!!this.estimatorButton),this.estimatorButton){this.log("Initial button data-product-id:",this.estimatorButton.dataset.productId);var t=this.estimatorButton.dataset.productId;t&&this.isParentEstimatorEnabled(t)&&(this.log("Parent product has estimator enabled, ensuring button is visible"),this.estimatorButton.style.display="",this.estimatorButton.classList.remove("hidden"))}return this.bindEvents(),this.checkCurrentVariation(),this.initialized=!0,this.log("VariationHandler initialized"),this.emit("initialized"),this}},{key:"ensureEstimatorButton",value:function(t){if(this.log("Ensuring estimator button exists for variation: ".concat(t)),document.querySelector(this.config.selectors.estimatorButton))return this.log("Estimator button already exists, updating visibility"),void this.updateEstimatorButton(!0,t);if(this.isEstimatorEnabled(t)){this.log("Creating estimator button dynamically");var e=document.querySelector(".single_add_to_cart_button");if(e){var o=document.createElement("button");o.type="button",o.className="single_add_to_estimator_button button alt open-estimator-modal",o.dataset.productId=t,o.textContent="Add to Estimate",e.insertAdjacentElement("afterend",o),this.log("Estimator button created and inserted")}else this.log("Cannot find add to cart button to insert after")}else this.log("Estimator not enabled for this variation, not creating button")}},{key:"isParentEstimatorEnabled",value:function(t){if(document.querySelector(".single_add_to_estimator_button"))return!0;var e=document.querySelector('input[name="_enable_estimator"], [data-enable-estimator]');return!!e&&("yes"===e.value||"yes"===e.dataset.enableEstimator)}},{key:"bindEvents",value:function(){var t,e,o,r,n=this;this.variationsForm&&(this.log("Binding variation events"),this.variationsForm.addEventListener("found_variation",_t()(t=this.handleFoundVariation).call(t,this)),this.variationsForm.addEventListener("reset_data",_t()(e=this.handleResetVariation).call(e,this)),this.variationsForm.addEventListener("check_variations",_t()(o=this.handleCheckVariations).call(o,this)),document.addEventListener("woocommerce_variation_has_changed",_t()(r=this.checkCurrentVariation).call(r,this)),this.variationIdInput&&this.variationIdInput.addEventListener("change",(function(){var t=n.variationIdInput.value;if(t){n.log("Variation ID input changed to: ".concat(t)),n.currentVariationId=t;var e=n.isEstimatorEnabled(t);n.updateEstimatorButton(e,t)}})),"undefined"!=typeof jQuery&&jQuery(this.variationsForm).on("change",'input[name="variation_id"]',(function(t){var e=t.target.value;if(e){n.log("jQuery variation ID change detected: ".concat(e)),n.currentVariationId=e;var o=n.isEstimatorEnabled(e);n.updateEstimatorButton(o,e)}})),this.log("Variation events bound"))}},{key:"handleFoundVariation",value:function(t){var e,o=void 0!==t.detail?t.detail:t.target.variation;if(o&&o.variation_id){var r=o.variation_id;this.currentVariationId=r,this.log("Found variation: ".concat(r));var n=this.isEstimatorEnabled(r);this.log(w()(e="Variation ".concat(r," has estimator enabled: ")).call(e,n)),this.ensureEstimatorButton(r),this.updateEstimatorButton(n,r),this.emit("variation:changed",{variationId:r,enableEstimator:n,variation:o})}else this.log("Found variation event received but no valid variation data")}},{key:"handleResetVariation",value:function(){this.log("Reset variation"),this.currentVariationId=null,this.updateEstimatorButton(!1),this.emit("variation:reset")}},{key:"handleCheckVariations",value:function(){this.log("Check variations"),this.checkCurrentVariation()}},{key:"checkCurrentVariation",value:function(){var t=this;if(this.variationsForm){var e=document.querySelectorAll(this.config.selectors.estimatorButton);this.log("Found ".concat(e.length," estimator buttons during checkCurrentVariation")),e.length>1&&(this.log("WARNING: Found multiple estimator buttons - this may cause issues. Check for duplicates."),g()(e).call(e,(function(e,o){var r;t.log(w()(r="Button ".concat(o+1," HTML: ")).call(r,e.outerHTML))})));var o=this.getCurrentVariation();if(o){this.log("Current variation detected: ".concat(o.variation_id)),this.currentVariationId=o.variation_id;var r=this.isEstimatorEnabled(o.variation_id);this.updateEstimatorButton(r,o.variation_id)}else this.log("No current variation detected"),this.currentVariationId=null,this.updateEstimatorButton(this.isParentProductEstimatorEnabled())}}},{key:"isParentProductEstimatorEnabled",value:function(){return void 0===window.product_estimator_variations||!window.product_estimator_variations._parent_enabled||"yes"===window.product_estimator_variations._parent_enabled}},{key:"getCurrentVariation",value:function(){if(!this.variationsForm)return null;if(this.variationsForm.currentVariation)return this.variationsForm.currentVariation;var t=this.variationsForm.querySelector('input[name="variation_id"]');if(t&&t.value)return{variation_id:t.value};var e=this.variationsForm.dataset.productVariations;if(e)return{variation_id:e};if("undefined"!=typeof jQuery){var o=jQuery(this.variationsForm),r=(o.data("product_variations"),it()(o).call(o,'input[name="variation_id"]').val());if(r)return{variation_id:r}}return null}},{key:"isEstimatorEnabled",value:function(t){if(!t)return!1;if(this.log("Checking if estimator is enabled for variation: ".concat(t)),this.log("Available variations data:",this.variationsData),this.variationsData[t]){var e="yes"===this.variationsData[t].enable_estimator;return this.log("Found variation data, estimator enabled: ".concat(e)),e}var o=document.querySelector(".single_add_to_estimator_button[data-product-id]:not([data-variation-id])");if(o){var r=!o.classList.contains("hidden")&&"none"!==getComputedStyle(o).display;return this.log("Using parent product as fallback, estimator enabled: ".concat(r)),r}return this.log("No variation or parent data found, estimator disabled by default"),!1}},{key:"updateEstimatorButton",value:function(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.querySelector(".single_add_to_estimator_button");r?(this.log(w()(e="Updating button visibility: ".concat(t?"show":"hide",", variation ID: ")).call(e,o)),t?(r.style.display="",o&&(this.log("Setting button data-product-id to variation ID: ".concat(o)),r.dataset.productId=o)):(r.style.display="none",this.log("Hiding estimator button"))):this.log("Estimator button not found")}},{key:"on",value:function(t,e){return this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(e),this}},{key:"emit",value:function(t,e){var o;return this.eventHandlers[t]&&g()(o=this.eventHandlers[t]).call(o,(function(t){return t(e)})),this}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[VariationHandler]"]).call(e,r))}}}])}();var jt=function(){return h((function t(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;i(this,t),this.config=p()({debug:!1,selectors:{editButton:"#edit-customer-details-btn",deleteButton:"#delete-customer-details-btn",saveButton:"#save-customer-details-btn",cancelButton:"#cancel-edit-customer-details-btn",detailsContainer:".saved-customer-details",detailsHeader:".customer-details-header",editForm:".customer-details-edit-form",formContainer:".product-estimator-modal-form-container"},i18n:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.i18n)||{}},o),this.dataService=r,this.initialized=!1,this.eventHandlers={},!1!==o.autoInit&&this.init()}),[{key:"init",value:function(){var t;return this.initialized?(this.log("CustomerDetailsManager already initialized"),this):(this.bindEvents(),document.addEventListener("customer_details_updated",_t()(t=this.onCustomerDetailsUpdated).call(t,this)),this.initialized=!0,this.log("CustomerDetailsManager initialized"),this)}},{key:"onCustomerDetailsUpdated",value:function(t){t.detail&&t.detail.details&&(this.log("Received customer_details_updated event",t.detail),this.updateDisplayedDetails(t.detail.details),this.checkAndUpdateEmailField(t.detail.details))}},{key:"checkAndUpdateEmailField",value:function(t){var e,o=t&&t.email&&""!==et()(e=t.email).call(e);this.log("Checking for email field updates: hasEmail=".concat(o));var r=document.querySelector(this.config.selectors.editForm);if(r&&o){var n=r.querySelector("#edit-customer-email");if(!n&&o){this.log("Adding email field to edit form");var i=document.createElement("div");i.className="form-group";var s=document.createElement("label");s.setAttribute("for","edit-customer-email"),s.textContent="Email Address",(n=document.createElement("input")).type="email",n.id="edit-customer-email",n.name="edit_customer_email",n.value=t.email,i.appendChild(s),i.appendChild(n);var a=r.querySelector("#edit-customer-name");if(a){var c=a.closest(".form-group");c?c.parentNode.insertBefore(i,c.nextSibling):r.querySelector("h4").after(i)}}else n&&o&&(n.value=t.email)}var l=document.querySelector("#new-estimate-form");l&&l.setAttribute("data-has-email",o?"true":"false")}},{key:"bindEvents",value:function(){var t,e,o,r,n=document.querySelector(this.config.selectors.editButton),i=document.querySelector(this.config.selectors.deleteButton),s=document.querySelector(this.config.selectors.saveButton),a=document.querySelector(this.config.selectors.cancelButton);n?(this.bindButtonWithHandler(n,"click",_t()(t=this.handleEditClick).call(t,this)),i&&this.bindButtonWithHandler(i,"click",_t()(e=this.handleDeleteClick).call(e,this)),s&&this.bindButtonWithHandler(s,"click",_t()(o=this.handleSaveClick).call(o,this)),a&&this.bindButtonWithHandler(a,"click",_t()(r=this.handleCancelClick).call(r,this)),this.log("Customer details events bound")):this.log("Edit button not found, skipping event binding")}},{key:"bindButtonWithHandler",value:function(t,e,o){if(t){var r="_".concat(e,"Handler");t[r]&&t.removeEventListener(e,t[r]),t[r]=o,t.addEventListener(e,o)}}},{key:"handleEditClick",value:function(t){t.preventDefault(),t.stopPropagation();var e=document.querySelector(this.config.selectors.detailsContainer),o=document.querySelector(this.config.selectors.detailsHeader),r=document.querySelector(this.config.selectors.editForm);e&&(e.style.display="none"),o&&(o.style.display="none"),r&&(r.style.display="block"),this.log("Edit form displayed")}},{key:"handleCancelClick",value:function(t){t.preventDefault(),t.stopPropagation();var e=document.querySelector(this.config.selectors.detailsContainer),o=document.querySelector(this.config.selectors.detailsHeader),r=document.querySelector(this.config.selectors.editForm);r&&(r.style.display="none"),e&&(e.style.display="block"),o&&(o.style.display="flex"),this.log("Edit form hidden")}},{key:"handleSaveClick",value:function(t){var e,o,r=this;t.preventDefault(),t.stopPropagation();var i=t.target,s=i.textContent;i.textContent=this.config.i18n.saving||"Saving...",i.disabled=!0;var a={name:(null===(e=document.getElementById("edit-customer-name"))||void 0===e?void 0:e.value)||"",postcode:(null===(o=document.getElementById("edit-customer-postcode"))||void 0===o?void 0:o.value)||""},c=document.getElementById("edit-customer-email");c&&(a.email=c.value||"");var l,u,d=document.getElementById("edit-customer-phone");d&&(a.phone=d.value||""),this.dataService&&"function"==typeof this.dataService.request?this.dataService.request("update_customer_details",{details:at()(a)}).then((function(t){r.handleSaveSuccess(t,a),i.textContent=s,i.disabled=!1})).catch((function(t){r.handleSaveError(t),i.textContent=s,i.disabled=!1})):fetch((null===(l=window.productEstimatorVars)||void 0===l?void 0:l.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"update_customer_details",nonce:(null===(u=window.productEstimatorVars)||void 0===u?void 0:u.nonce)||"",details:at()(a)})}).then((function(t){return t.json()})).then((function(t){var e;t.success?r.handleSaveSuccess(t.data,a):r.handleSaveError(new Error((null===(e=t.data)||void 0===e?void 0:e.message)||"Error updating details"))})).catch((function(t){r.handleSaveError(t)})).finally((function(){i.textContent=s,i.disabled=!1}))}},{key:"handleSaveSuccess",value:function(t,e){this.updateDisplayedDetails(t.details||e),this.checkAndUpdateEmailField(t.details||e),this.showMessage("success",t.message||"Details updated successfully!");var o=document.querySelector(this.config.selectors.detailsContainer),r=document.querySelector(this.config.selectors.detailsHeader),n=document.querySelector(this.config.selectors.editForm);n&&(n.style.display="none"),o&&(o.style.display="block"),r&&(r.style.display="flex");var i=new CustomEvent("customer_details_updated",{bubbles:!0,detail:{details:t.details||e}});document.dispatchEvent(i),this.log("Customer details updated successfully",t)}},{key:"handleSaveError",value:function(t){this.showMessage("error",t.message||"Error updating details. Please try again."),this.log("Error saving customer details:",t)}},{key:"handleDeleteClick",value:function(t){var e=this;t.preventDefault(),t.stopPropagation(),window.productEstimator&&window.productEstimator.dialog?window.productEstimator.dialog.show({title:this.config.i18n.delete_customer_details||"Delete Customer Details",message:this.config.i18n.confirm_delete_details||"Are you sure you want to delete your saved details?",confirmText:this.config.i18n.delete||"Delete",cancelText:this.config.i18n.cancel||"Cancel",onConfirm:function(){e.deleteCustomerDetails()}}):confirm(this.config.i18n.confirm_delete_details||"Are you sure you want to delete your saved details?")&&this.deleteCustomerDetails()}},{key:"deleteCustomerDetails",value:function(){var t,e,o=this,r=document.querySelector(".customer-details-confirmation");r&&r.classList.add("loading"),this.dataService&&"function"==typeof this.dataService.request?this.dataService.request("delete_customer_details").then((function(t){o.handleDeleteSuccess(t,r)})).catch((function(t){o.handleDeleteError(t,r)})):fetch((null===(t=window.productEstimatorVars)||void 0===t?void 0:t.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"delete_customer_details",nonce:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.nonce)||""})}).then((function(t){return t.json()})).then((function(t){var e;t.success?o.handleDeleteSuccess(t.data,r):o.handleDeleteError(new Error((null===(e=t.data)||void 0===e?void 0:e.message)||"Error deleting details"),r)})).catch((function(t){o.handleDeleteError(t,r)}))}},{key:"handleDeleteSuccess",value:function(t,e){if(e&&t.html){var o=document.createElement("div");o.innerHTML=t.html,e.parentNode.replaceChild(o.firstElementChild,e)}this.showMessage("success",t.message||"Details deleted successfully!");var r=document.querySelector("#new-estimate-form");r&&r.setAttribute("data-has-email","false");var n=new CustomEvent("customer_details_deleted",{bubbles:!0});document.dispatchEvent(n),this.log("Customer details deleted")}},{key:"handleDeleteError",value:function(t,e){this.showMessage("error",t.message||"Error deleting details!"),this.log("Error deleting details:",t),e&&e.classList.remove("loading")}},{key:"updateDisplayedDetails",value:function(t){var e=document.querySelector(this.config.selectors.detailsContainer);if(e){var o="<p><strong>".concat(t.name,"</strong><br>");t.email&&(o+="".concat(t.email,"<br>")),t.phone&&(o+="".concat(t.phone,"<br>")),o+="".concat(t.postcode,"</p>"),e.innerHTML=o}}},{key:"showMessage",value:function(t,o){var r=document.querySelectorAll(".modal-message");g()(r).call(r,(function(t){return t.remove()}));var n="error"===t?"modal-error-message":"modal-success-message",i=document.createElement("div");i.className="modal-message ".concat(n),i.textContent=o;var s=document.querySelector(this.config.selectors.formContainer);s&&(s.prepend(i),e()((function(){i.remove()}),5e3))}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[CustomerDetailsManager]"]).call(e,r))}}}])}();const Nt=jt,Bt=new(function(){return h((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.config=p()({debug:!1,selectors:{estimatorButtons:".product-estimator-button, .single_add_to_estimator_button, .open-estimator-modal",estimatorMenuButtons:".product-estimator-menu-item a, a.product-estimator-menu-item",modalContainer:"#product-estimator-modal"},autoInit:!0},e),this.dataService=null,this.modalManager=null,this.variationHandler=null,this.customerDetailsManager=null,this.initialized=!1,this.eventHandlers={},this.config.autoInit&&this.init()}),[{key:"init",value:function(){var t=this;if(this.initialized)return this.log("EstimatorCore already initialized - aborting"),this;if(window._productEstimatorInitialized&&window.productEstimator&&window.productEstimator.core)return this.log("EstimatorCore detected as already initialized globally - aborting"),this.initialized=!0,this;this.log("Initializing EstimatorCore");try{if("undefined"==typeof jQuery)return console.error("jQuery is not loaded, cannot initialize EstimatorCore"),this;this.dataService||(this.dataService=new G({debug:this.config.debug})),console.log("%c=== PRODUCT ESTIMATOR INITIALIZATION START ===","background: #f0f0f0; color: #333; padding: 3px; border-radius: 3px;");var e=function(){t.modalManager?t.log("Components already initialized - skipping"):(t.modalManager=new Ot({debug:t.config.debug,selectors:t.config.selectors},t.dataService),t.customerDetailsManager=new Nt({debug:t.config.debug},t.dataService),t.isWooCommerceProductPage()&&(t.log("WooCommerce product page detected, initializing VariationHandler"),t.variationHandler=new qt({debug:t.config.debug})),t.bindGlobalEvents(),t.initialized=!0,t.log("EstimatorCore initialized successfully"),t.emit("core:initialized"),console.log("%c=== PRODUCT ESTIMATOR INITIALIZATION COMPLETE ===","background: #f0f0f0; color: #333; padding: 3px; border-radius: 3px;"))};"complete"===document.readyState?e():window.addEventListener("load",e,{once:!0})}catch(t){console.error("EstimatorCore initialization error:",t)}return this}},{key:"bindGlobalEvents",value:function(){var t=this;try{this._clickHandler&&document.removeEventListener("click",this._clickHandler),this._clickHandler=function(e){var o=e.target.closest(t.config.selectors.estimatorMenuButtons);if(o)return e.preventDefault(),e.stopPropagation(),t.log("Menu button clicked - opening modal in list view"),void(t.modalManager&&t.modalManager.openModal(null,!0));var r=e.target.closest(t.config.selectors.estimatorButtons);if(r&&!o){e.preventDefault(),e.stopPropagation();var n=r.dataset.productId||null;console.log("PRODUCT BUTTON CLICKED:",{productId:n,buttonElement:r,dataAttribute:r.dataset}),t.modalManager&&(console.log("OPENING MODAL WITH:",{productId:n,forceListView:!1}),t.modalManager.openModal(n,!1))}},document.addEventListener("click",this._clickHandler),this.emit("core:eventsbound"),this.log("Global events bound")}catch(t){console.error("Error binding global events:",t)}}},{key:"closeModal",value:function(){this.modalManager&&this.modalManager.closeModal()}},{key:"isWooCommerceProductPage",value:function(){return document.body.classList.contains("single-product")||document.body.classList.contains("product-template-default")||!!document.querySelector(".product.type-product")}},{key:"on",value:function(t,e){return this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(e),this}},{key:"emit",value:function(t,e){var o;return this.eventHandlers[t]&&g()(o=this.eventHandlers[t]).call(o,(function(t){return t(e)})),this}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[EstimatorCore]"]).call(e,r))}}}])}())({debug:!0});var Ht,Mt,Vt,zt,Ut,Qt,Wt=new(function(){return h((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.config=p()({debug:!1,selectors:{productToggleButton:".product-details-toggle",notesToggleButton:".product-notes-toggle",includesToggleButton:".product-includes-toggle",productItem:".product-item",similarProductsContainer:".similar-products-container",productIncludes:".product-includes",similarProducts:".product-similar-products",productNotes:".product-notes",notesContainer:".notes-container",includesContainer:".includes-container",suggestionsContainer:".suggestions-container"},i18n:{showProducts:"Similar Products",hideProducts:"Similar Products",showNotes:"Product Notes",hideNotes:"Product Notes",showIncludes:"Product Includes",hideIncludes:"Product Includes",showSuggestions:"Suggested Products",hideSuggestions:"Suggested Products",loading:"Loading..."}},e),this.initialized=!1,this.init()}),[{key:"init",value:function(){var t=this;this.initialized?this.log("Already initialized, skipping"):("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){return t.setup()})):this.setup(),document.addEventListener("product_estimator_modal_loaded",(function(){t.log("Modal content loaded, initializing toggles"),t.setup()})),this.setupMutationObserver(),this.initialized=!0,this.log("ProductDetailsToggle initialized"))}},{key:"prepareSuggestionsToggle",value:function(){var t=this,e=document.querySelectorAll(this.config.selectors.accordionContent);this.log("Found ".concat(e.length," accordion content elements to process for suggestions toggle")),g()(e).call(e,(function(e){if(!e.classList.contains("suggestions-toggle-processed")){var o=e.querySelector(t.config.selectors.productSuggestions);if(o){t.log("Found suggestions section, processing",o),e.classList.add("has-suggestions");var r=e.querySelector(t.config.selectors.suggestionsContainer);if(!r){if(t.log("Creating new suggestions container"),(r=document.createElement("div")).className="suggestions-container visible",o.parentNode!==r){var n=o.cloneNode(!0);r.appendChild(n),o.parentNode.removeChild(o)}e.appendChild(r)}var i=e.querySelector(t.config.selectors.suggestionsToggleButton);i||(t.log("Adding suggestions toggle button to accordion content"),(i=document.createElement("button")).className="product-suggestions-toggle expanded",i.setAttribute("data-toggle-type","suggestions"),i.innerHTML="\n        ".concat(t.config.i18n.hideSuggestions,'\n        <span class="toggle-icon dashicons dashicons-arrow-up-alt2"></span>\n      '),e.insertBefore(i,r)),r.style.display="block",r.classList.add("visible"),e.classList.add("suggestions-toggle-processed"),t.log("Accordion content processed for suggestions toggle")}else t.log("No suggestions section found for accordion content, skipping",e)}}))}},{key:"setupMutationObserver",value:function(){var t=this;new MutationObserver((function(o){var r=!1;g()(o).call(o,(function(e){var o;e.addedNodes.length&&g()(o=x()(e.addedNodes)).call(o,(function(e){e.nodeType===Node.ELEMENT_NODE&&(e.matches(t.config.selectors.productItem)||e.matches(t.config.selectors.productToggleButton)||e.matches(t.config.selectors.notesToggleButton)||e.querySelector(t.config.selectors.productItem)||e.querySelector(t.config.selectors.productToggleButton)||e.querySelector(t.config.selectors.notesToggleButton))&&(r=!0)}))})),r&&(t.log("New toggle-related content detected, re-initializing"),e()((function(){return t.setup()}),100))})).observe(document.body,{childList:!0,subtree:!0}),this.log("Mutation observer set up")}},{key:"setup",value:function(){this.log("Setting up product details toggles"),this.prepareProductsToggle(),this.prepareNotesToggle(),this.prepareIncludesToggle(),this.prepareSuggestionsToggle(),this.bindEvents(),this.initializeAllCarousels()}},{key:"prepareProductsToggle",value:function(){var t=this,e=document.querySelectorAll(this.config.selectors.productItem);this.log("Found ".concat(e.length," product items to process for similar products toggle")),g()(e).call(e,(function(e){if(!e.classList.contains("products-toggle-processed")){var o=e.querySelector(t.config.selectors.similarProducts);if(o){t.log("Found similar products section, processing",o),e.classList.add("has-similar-products");var r=e.querySelector(t.config.selectors.similarProductsContainer);if(!r){if(t.log("Creating new similar products container"),(r=document.createElement("div")).className="similar-products-container visible",o.parentNode!==r){var n=o.cloneNode(!0);r.appendChild(n),o.parentNode.removeChild(o)}e.appendChild(r)}var i=e.querySelector(t.config.selectors.productToggleButton);if(i){i.classList.add("expanded");var s=i.querySelector(".toggle-icon");s&&(s.classList.remove("dashicons-arrow-down-alt2"),s.classList.add("dashicons-arrow-up-alt2"))}else t.log("Adding similar products toggle button to product item"),(i=document.createElement("button")).className="product-details-toggle expanded",i.setAttribute("data-toggle-type","similar-products"),i.innerHTML="\n        ".concat(t.config.i18n.hideProducts,'\n        <span class="toggle-icon dashicons dashicons-arrow-up-alt2"></span>\n      '),e.insertBefore(i,r);r.style.display="block",r.classList.add("visible"),e.classList.add("products-toggle-processed"),t.log("Product item processed for similar products toggle")}else t.log("No similar products section found for product item, skipping",e)}}))}},{key:"prepareNotesToggle",value:function(){var t=this,e=document.querySelectorAll(this.config.selectors.productItem);this.log("Found ".concat(e.length," product items to process for notes toggle")),g()(e).call(e,(function(e){if(!e.classList.contains("notes-toggle-processed")){var o=e.querySelector(t.config.selectors.productNotes);if(o){t.log("Found notes section, processing",o),e.classList.add("has-notes");var r=e.querySelector(t.config.selectors.notesContainer);if(!r){if(t.log("Creating new notes container"),(r=document.createElement("div")).className="notes-container visible",o.parentNode!==r){var n=o.cloneNode(!0);r.appendChild(n),o.parentNode.removeChild(o)}e.appendChild(r)}var i=e.querySelector(t.config.selectors.notesToggleButton);if(i){i.classList.add("expanded");var s=i.querySelector(".toggle-icon");s&&(s.classList.remove("dashicons-arrow-down-alt2"),s.classList.add("dashicons-arrow-up-alt2"))}else t.log("Adding notes toggle button to product item"),(i=document.createElement("button")).className="product-notes-toggle expanded",i.setAttribute("data-toggle-type","notes"),i.innerHTML="\n        ".concat(t.config.i18n.hideNotes,'\n        <span class="toggle-icon dashicons dashicons-arrow-up-alt2"></span>\n      '),e.insertBefore(i,r);r.style.display="block",r.classList.add("visible"),e.classList.add("notes-toggle-processed"),t.log("Product item processed for notes toggle")}else t.log("No notes section found for product item, skipping",e)}}))}},{key:"bindEvents",value:function(){var t=this,e=document.querySelectorAll(this.config.selectors.productToggleButton);this.log("Found ".concat(e.length," similar products toggle buttons to bind")),g()(e).call(e,(function(e){e._toggleBound||(e._toggleHandler=function(o){o.preventDefault(),o.stopPropagation(),t.toggleSimilarProducts(e)},e.addEventListener("click",e._toggleHandler),e._toggleBound=!0)}));var o=document.querySelectorAll(this.config.selectors.notesToggleButton);this.log("Found ".concat(o.length," notes toggle buttons to bind")),g()(o).call(o,(function(e){e._toggleBound||(e._toggleHandler=function(o){o.preventDefault(),o.stopPropagation(),t.toggleNotes(e)},e.addEventListener("click",e._toggleHandler),e._toggleBound=!0)}));var r=document.querySelectorAll(this.config.selectors.includesToggleButton);this.log("Found ".concat(r.length," includes toggle buttons to bind")),g()(r).call(r,(function(e){e._toggleBound||(e._toggleHandler=function(o){o.preventDefault(),o.stopPropagation(),t.toggleIncludes(e)},e.addEventListener("click",e._toggleHandler),e._toggleBound=!0)}));var n=document.querySelectorAll(this.config.selectors.suggestionsToggleButton);this.log("Found ".concat(n.length," suggestions toggle buttons to bind")),g()(n).call(n,(function(e){e._toggleBound||(e._toggleHandler=function(o){o.preventDefault(),o.stopPropagation(),t.toggleSuggestions(e)},e.addEventListener("click",e._toggleHandler),e._toggleBound=!0)})),this.log("All toggle events bound")}},{key:"toggleSuggestions",value:function(t){var e=t.closest(this.config.selectors.accordionContent);if(e){var o=e.querySelector(this.config.selectors.suggestionsContainer);if(o){var r=t.classList.contains("expanded");if(this.log("Suggestions toggle clicked, current expanded state: ".concat(r)),r){o.classList.remove("visible"),o.style.display="none",t.classList.remove("expanded");var n=t.querySelector(".toggle-icon");n&&(n.classList.remove("dashicons-arrow-up-alt2"),n.classList.add("dashicons-arrow-down-alt2")),t.innerHTML=t.innerHTML.replace(this.config.i18n.hideSuggestions,this.config.i18n.showSuggestions),this.log("Suggestions hidden")}else{o.classList.add("visible"),o.style.display="block",t.classList.add("expanded");var i=t.querySelector(".toggle-icon");i&&(i.classList.remove("dashicons-arrow-down-alt2"),i.classList.add("dashicons-arrow-up-alt2")),t.innerHTML=t.innerHTML.replace(this.config.i18n.showSuggestions,this.config.i18n.hideSuggestions),this.initializeCarousels(o),this.log("Suggestions shown")}}else this.log("Suggestions container not found")}else this.log("Accordion content not found for toggle button")}},{key:"toggleSimilarProducts",value:function(t){var e=t.closest(this.config.selectors.productItem);if(e){var o=e.querySelector(this.config.selectors.similarProductsContainer);if(o){var r=t.classList.contains("expanded");this.log("Similar products toggle clicked, current expanded state: ".concat(r));var n=t.querySelector(".toggle-icon");r?(o.classList.remove("visible"),o.style.display="none",t.classList.remove("expanded"),n&&(n.classList.remove("dashicons-arrow-up-alt2"),n.classList.add("dashicons-arrow-down-alt2")),this.log("Similar products hidden")):(o.classList.add("visible"),o.style.display="block",t.classList.add("expanded"),n&&(n.classList.remove("dashicons-arrow-down-alt2"),n.classList.add("dashicons-arrow-up-alt2")),this.log("Similar products shown"),this.initializeCarousels(o))}else this.log("Similar products container not found")}else this.log("Product item not found for toggle button")}},{key:"toggleNotes",value:function(t){var e=t.closest(this.config.selectors.productItem);if(e){var o=e.querySelector(this.config.selectors.notesContainer);if(o){var r=t.classList.contains("expanded");this.log("Notes toggle clicked, current expanded state: ".concat(r));var n=t.querySelector(".toggle-icon");r?(o.classList.remove("visible"),o.style.display="none",t.classList.remove("expanded"),n&&(n.classList.remove("dashicons-arrow-up-alt2"),n.classList.add("dashicons-arrow-down-alt2")),this.log("Notes hidden")):(o.classList.add("visible"),o.style.display="block",t.classList.add("expanded"),n&&(n.classList.remove("dashicons-arrow-down-alt2"),n.classList.add("dashicons-arrow-up-alt2")),this.log("Notes shown"))}else this.log("Notes container not found")}else this.log("Product item not found for notes toggle button")}},{key:"initializeCarousels",value:function(t){"function"==typeof window.initSuggestionsCarousels?(this.log("Initializing carousels in similar products container"),window.initSuggestionsCarousels()):"function"==typeof initSuggestionsCarousels?(this.log("Using local initSuggestionsCarousels function"),initSuggestionsCarousels()):this.log("Carousel initialization function not found",window.initSuggestionsCarousels)}},{key:"initializeAllCarousels",value:function(){"function"==typeof window.initSuggestionsCarousels?(this.log("Initializing all carousels"),window.initSuggestionsCarousels()):"function"==typeof initSuggestionsCarousels&&initSuggestionsCarousels()}},{key:"prepareIncludesToggle",value:function(){var t=this,e=document.querySelectorAll(this.config.selectors.productItem);this.log("Found ".concat(e.length," product items to process for includes toggle")),g()(e).call(e,(function(e){if(!e.classList.contains("includes-toggle-processed")){var o=e.querySelector(t.config.selectors.productIncludes);if(o){t.log("Found includes section, processing",o),e.classList.add("has-includes");var r=e.querySelector(".includes-container");if(!r){if(t.log("Creating new includes container"),(r=document.createElement("div")).className="includes-container visible",o.parentNode!==r){var n=o.cloneNode(!0);r.appendChild(n),o.parentNode.removeChild(o)}e.appendChild(r)}var i=e.querySelector(".product-includes-toggle");if(i){i.classList.add("expanded");var s=i.querySelector(".toggle-icon");s&&(s.classList.remove("dashicons-arrow-down-alt2"),s.classList.add("dashicons-arrow-up-alt2"))}else t.log("Adding includes toggle button to product item"),(i=document.createElement("button")).className="product-includes-toggle expanded",i.setAttribute("data-toggle-type","includes"),i.innerHTML="\n        ".concat(t.config.i18n.hideIncludes||"Product Includes",'\n        <span class="toggle-icon dashicons dashicons-arrow-up-alt2"></span>\n      '),e.insertBefore(i,r);r.style.display="block",r.classList.add("visible"),e.classList.add("includes-toggle-processed"),t.log("Product item processed for includes toggle")}else t.log("No includes section found for product item, skipping",e)}}))}},{key:"toggleIncludes",value:function(t){var e=t.closest(this.config.selectors.productItem);if(e){var o=e.querySelector(".includes-container");if(o){var r=t.classList.contains("expanded");this.log("Includes toggle clicked, current expanded state: ".concat(r));var n=t.querySelector(".toggle-icon");r?(o.classList.remove("visible"),o.style.display="none",t.classList.remove("expanded"),n&&(n.classList.remove("dashicons-arrow-up-alt2"),n.classList.add("dashicons-arrow-down-alt2")),this.log("Includes hidden")):(o.classList.add("visible"),o.style.display="block",t.classList.add("expanded"),n&&(n.classList.remove("dashicons-arrow-down-alt2"),n.classList.add("dashicons-arrow-up-alt2")),this.log("Includes shown"))}else this.log("Includes container not found")}else this.log("Product item not found for includes toggle button")}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[ProductDetailsToggle]"]).call(e,r))}}}])}())({debug:(null===(Ht=window.productEstimatorVars)||void 0===Ht?void 0:Ht.debug)||!1,i18n:{showProducts:(null===(Mt=window.productEstimatorVars)||void 0===Mt||null===(Mt=Mt.i18n)||void 0===Mt?void 0:Mt.showSimilarProducts)||"Similar Products",hideProducts:(null===(Vt=window.productEstimatorVars)||void 0===Vt||null===(Vt=Vt.i18n)||void 0===Vt?void 0:Vt.hideSimilarProducts)||"Similar Products",showNotes:(null===(zt=window.productEstimatorVars)||void 0===zt||null===(zt=zt.i18n)||void 0===zt?void 0:zt.showNotes)||"Product Notes",hideNotes:(null===(Ut=window.productEstimatorVars)||void 0===Ut||null===(Ut=Ut.i18n)||void 0===Ut?void 0:Ut.hideNotes)||"Product Notes",loading:(null===(Qt=window.productEstimatorVars)||void 0===Qt||null===(Qt=Qt.i18n)||void 0===Qt?void 0:Qt.loading)||"Loading..."}});function Gt(t,e){var o=Z()(t);if(lt()){var r=lt()(t);e&&(r=dt()(r).call(r,(function(e){return ht()(t,e).enumerable}))),o.push.apply(o,r)}return o}function Jt(t){for(var e=1;e<arguments.length;e++){var o,r,n=null!=arguments[e]?arguments[e]:{};e%2?g()(o=Gt(Object(n),!0)).call(o,(function(e){bt(t,e,n[e])})):pt()?gt()(t,pt()(n)):g()(r=Gt(Object(n))).call(r,(function(e){wt()(t,e,ht()(n,e))}))}return t}var Kt=function(){return h((function t(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.config=p()({debug:!1,selectors:{printButton:".print-estimate",requestContactButton:".request-contact-estimate",requestCopyButton:".request-a-copy",scheduleDesignerButton:".schedule-designer-estimate"},i18n:(null===(e=window.productEstimatorVars)||void 0===e?void 0:e.i18n)||{}},o),this.initialized=!1,this.processing=!1,!1!==o.autoInit&&this.init()}),[{key:"init",value:function(){return this.initialized?(this.log("PrintEstimate already initialized"),this):(this.bindEvents(),this.initialized=!0,this.log("PrintEstimate initialized"),this)}},{key:"bindEvents",value:function(){var t=this;document.addEventListener("click",(function(e){var o=e.target.closest(t.config.selectors.printButton);o&&!t.processing&&(e.preventDefault(),t.handlePrintEstimate(o));var r=e.target.closest(t.config.selectors.requestContactButton);r&&!t.processing&&(e.preventDefault(),t.handleRequestContact(r));var n=e.target.closest(t.config.selectors.requestCopyButton);n&&!t.processing&&(e.preventDefault(),t.handleRequestCopy(n));var i=e.target.closest(t.config.selectors.scheduleDesignerButton);i&&!t.processing&&(e.preventDefault(),t.handleScheduleDesigner(i))})),this.log("Print estimate events bound")}},{key:"handlePrintEstimate",value:function(t){var e,o=this,r=t.dataset.estimateId;null!=r?(this.log(w()(e="Print estimate requested for estimate ID: ".concat(r," (type: ")).call(e,l(r),")")),this.processing=!0,this.setButtonLoading(t,!0),this.checkEstimateStored(r).then((function(e){if(!e.is_stored||!e.db_id)return o.checkCustomerEmail(r).then((function(e){return e?o.saveAndGeneratePdf(r,t):(o.setButtonLoading(t,!1),o.processing=!1,o.showEmailPrompt(r,t,"print"),N().reject(new Error("email_prompt_shown")))}));o.log("Estimate is stored in DB, using direct PDF URL",e),o.openPdfUrl(e.db_id),o.setButtonLoading(t,!1),o.processing=!1})).catch((function(e){"email_prompt_shown"!==e.message&&(o.log("Error in print estimate process:",e),o.setButtonLoading(t,!1),o.processing=!1,o.showError("Error generating PDF. Please try again."))}))):this.showError("No estimate ID provided")}},{key:"checkEstimateStored",value:function(t){var e=this;return new(N())((function(o,r){fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"check_estimate_stored",nonce:productEstimatorVars.nonce,estimate_id:t})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(r){r.success?(e.log("Check estimate stored result:",r.data),o({is_stored:r.data.is_stored||!1,db_id:r.data.db_id||null,estimate_id:t})):o({is_stored:!1,db_id:null,estimate_id:t})})).catch((function(r){e.log("Error checking if estimate is stored:",r),o({is_stored:!1,db_id:null,estimate_id:t})}))}))}},{key:"openPdfUrl",value:function(t){var e=this;if(t){if(productEstimatorVars.is_admin){var o,r=window.location.protocol+"//"+window.location.host,i=w()(o="".concat(r,"/product-estimator/pdf/admin/")).call(o,t);return this.log("Opening admin PDF URL:",i),void window.open(i,"_blank")}fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"get_secure_pdf_url",nonce:productEstimatorVars.nonce,estimate_id:t})}).then((function(t){return t.json()})).then((function(t){var o;if(!t.success||!t.data.url)throw new Error((null===(o=t.data)||void 0===o?void 0:o.message)||"Failed to get secure PDF URL");e.log("Opening secure PDF URL:",t.data.url),window.open(t.data.url,"_blank")})).catch((function(t){e.log("Error getting secure PDF URL:",t),e.showError("Error generating PDF. Please try again.")}))}else this.log("Cannot open PDF URL: No database ID provided")}},{key:"saveAndGeneratePdf",value:function(t,e){var o=this;return this.storeEstimate(t).then((function(r){return r&&r.estimate_id?(o.openPdfUrl(r.estimate_id),N().resolve()):o.generatePdf(t,e)})).finally((function(){o.setButtonLoading(e,!1),o.processing=!1}))}},{key:"handleRequestCopy",value:function(t){var e,o=this,r=t.dataset.estimateId;null!=r?(this.log(w()(e="Request copy requested for estimate ID: ".concat(r," (type: ")).call(e,l(r),")")),this.processing=!0,this.setButtonLoading(t,!0),this.checkCustomerEmail(r).then((function(e){e?o.sendEstimateCopy(r,t):(o.setButtonLoading(t,!1),o.processing=!1,o.showEmailPrompt(r,t,"copy"))})).catch((function(e){o.log("Error checking customer email:",e),o.setButtonLoading(t,!1),o.processing=!1,o.showError("Error checking customer details. Please try again.")}))):this.showError("No estimate ID provided")}},{key:"sendEstimateCopy",value:function(t,e){var o=this;fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"request_copy_estimate",nonce:productEstimatorVars.nonce,estimate_id:t})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(r){if(r.success){o.log("Estimate copy sent successfully",r.data);var n="";r.data&&r.data.email?n=r.data.email:o._customerDetails&&o._customerDetails.email&&(n=o._customerDetails.email),o.showEmailSentConfirmation(n)}else{if(r.data&&"no_email"===r.data.code)return o.setButtonLoading(e,!1),o.processing=!1,void o.showEmailPrompt(t,e,"copy");o.log("Error sending estimate copy",r.data),o.showError(r.data.message||"Error sending estimate. Please try again.")}})).catch((function(t){o.log("AJAX error",t),o.showError("Connection error. Please try again.")})).finally((function(){o.processing=!1,o.setButtonLoading(e,!1)}))}},{key:"checkCustomerEmail",value:function(t){var e=this;return new(N())((function(o,r){var i=String(t);e.log("Checking customer email for estimate: ".concat(i)),fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"check_customer_email",nonce:productEstimatorVars.nonce,estimate_id:i})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(t){var n;t.success?(e.log("Customer email check result: ".concat(t.data.has_email?"Has email":"No email")),t.data.customer_details&&(e._customerDetails=t.data.customer_details),o(t.data.has_email)):r(new Error((null===(n=t.data)||void 0===n?void 0:n.message)||"Error checking customer email"))})).catch((function(t){e.log("AJAX error in checkCustomerEmail:",t),r(t)}))}))}},{key:"showEmailPrompt",value:function(t,o){var r,n,i,s,a,c,l,u,d,m,h=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"print",p=this._customerDetails||{},v=w()(r=w()(n=w()(i=w()(s=w()(a='\n  <div class="email-prompt-overlay"></div>\n  <div class="email-prompt-container">\n    <div class="email-prompt-header">\n      <h3>'.concat((null===(c=productEstimatorVars.i18n)||void 0===c?void 0:c.enter_email)||"Please Enter Your Email",'</h3>\n    </div>\n    <div class="email-prompt-body">\n      <p>')).call(a,(null===(l=productEstimatorVars.i18n)||void 0===l?void 0:l.email_required_message)||"An email address is required to "+("copy"===f?"receive":"print")+" your estimate.",'</p>\n      <div class="form-group">\n        <label for="customer-email-input">')).call(s,(null===(u=productEstimatorVars.i18n)||void 0===u?void 0:u.email_address)||"Email Address",':</label>\n        <input type="email" id="customer-email-input" required\n               value="')).call(i,(null==p?void 0:p.email)||"",'">\n      </div>\n      <div class="email-validation-message"></div>\n    </div>\n    <div class="email-prompt-footer">\n      <button type="button" class="button cancel-email-btn">\n        ')).call(n,(null===(d=productEstimatorVars.i18n)||void 0===d?void 0:d.cancel)||"Cancel",'\n      </button>\n      <button type="button" class="button submit-email-btn">\n        ')).call(r,(null===(m=productEstimatorVars.i18n)||void 0===m?void 0:m.continue)||"Continue","\n      </button>\n    </div>\n  </div>\n"),g=document.createElement("div");g.className="email-prompt-modal",g.innerHTML=v,document.body.appendChild(g);var y=g.querySelector(".cancel-email-btn"),b=g.querySelector(".submit-email-btn"),E=g.querySelector("#customer-email-input"),S=g.querySelector(".email-validation-message");y.addEventListener("click",(function(){g.remove()})),b.addEventListener("click",(function(){var e,r,n,i,s=et()(e=E.value).call(e);s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?(b.disabled=!0,b.textContent=(null===(r=productEstimatorVars.i18n)||void 0===r?void 0:r.saving)||"Saving...",h.log("Submitting email update:",s,"for estimate:",t),h.updateCustomerEmail(t,s).then((function(e){h.log("Email update successful"),g.remove(),h.notifyEmailUpdated(e),"copy"===f?h.sendEstimateCopy(t,o):(h.setButtonLoading(o,!0),h.processing=!0,h.saveAndGeneratePdf(t,o))})).catch((function(t){var e,o;h.log("Error updating customer email:",t);var r="Error saving email. Please try again.";t.message&&(r+=" ("+t.message+")"),S.textContent=(null===(e=productEstimatorVars.i18n)||void 0===e?void 0:e.email_save_error)||r,S.style.color="red",b.disabled=!1,b.textContent=(null===(o=productEstimatorVars.i18n)||void 0===o?void 0:o.continue)||"Continue"}))):S.textContent=(null===(n=productEstimatorVars.i18n)||void 0===n?void 0:n.invalid_email)||"Please enter a valid email address":S.textContent=(null===(i=productEstimatorVars.i18n)||void 0===i?void 0:i.email_required)||"Email address is required"})),e()((function(){E.focus(),E.addEventListener("keypress",(function(t){"Enter"===t.key&&(t.preventDefault(),b.click())}))}),100)}},{key:"notifyEmailUpdated",value:function(t){if(t){this.log("Dispatching customer_details_updated event",t);var e=new CustomEvent("customer_details_updated",{bubbles:!0,detail:{details:t,source:"print_estimate"}});document.dispatchEvent(e);var o=document.querySelector("#new-estimate-form");o&&t.email&&(o.setAttribute("data-has-email","true"),this.log("Updated new-estimate-form data-has-email attribute to true"))}}},{key:"generatePdf",value:function(t,e){var o=this;return new(N())((function(e,r){fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"print_estimate",nonce:productEstimatorVars.nonce,estimate_id:t})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(t){t.success?(o.log("PDF generated successfully",t.data),t.data.pdf_url&&window.open(t.data.pdf_url,"_blank"),t.data.db_id&&o.log("Estimate now stored with DB ID: ".concat(t.data.db_id)),e()):(o.log("Error generating PDF",t.data),o.showError(t.data.message||"Error generating PDF. Please try again."),r(new Error(t.data.message||"Error generating PDF")))})).catch((function(t){o.log("AJAX error",t),o.showError("Connection error. Please try again."),r(t)}))}))}},{key:"handleRequestContact",value:function(t){var e=t.dataset.estimateId;e?(this.log("Request contact requested for estimate ID: ".concat(e)),this.saveEstimateIfNeeded(e,(function(){alert("Request contact feature will be implemented here")}))):this.showError("No estimate ID provided")}},{key:"handleScheduleDesigner",value:function(t){var e=t.dataset.estimateId;e?(this.log("Schedule designer requested for estimate ID: ".concat(e)),this.saveEstimateIfNeeded(e,(function(){alert("Schedule designer feature will be implemented here")}))):this.showError("No estimate ID provided")}},{key:"saveEstimateIfNeeded",value:function(t,e){var o=this;this.processing=!0,this.checkEstimateStored(t).then((function(r){if(!r.is_stored||!r.db_id)return o.storeEstimate(t).then((function(o){"function"==typeof e&&e(o.estimate_id||t)}));"function"==typeof e&&e(r.db_id)})).catch((function(t){o.log("Error checking/storing estimate",t),o.showError("Error preparing estimate. Please try again.")})).finally((function(){o.processing=!1}))}},{key:"storeEstimate",value:function(t){var e=this;return new(N())((function(o,r){var i=e._customerDetails||{};fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"store_single_estimate",nonce:productEstimatorVars.nonce,estimate_id:t,customer_name:i.name||"",customer_email:i.email||"",customer_phone:i.phone||"",customer_postcode:i.postcode||"",notes:""})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(t){var n;t.success?(e.log("Estimate stored successfully",t.data),o(t.data)):r(new Error((null===(n=t.data)||void 0===n?void 0:n.message)||"Error storing estimate"))})).catch((function(t){r(t)}))}))}},{key:"setButtonLoading",value:function(t,e){if(t){var o=t.dataset.originalText||t.textContent;e?(t.dataset.originalText||(t.dataset.originalText=t.textContent),t.classList.add("loading"),t.innerHTML='<span class="loading-dots">Processing...</span>',t.disabled=!0):(t.classList.remove("loading"),t.textContent=o,t.disabled=!1)}}},{key:"showError",value:function(t){window.productEstimator&&window.productEstimator.core&&"function"==typeof window.productEstimator.core.showError?window.productEstimator.core.showError(t):alert(t)}},{key:"showSuccess",value:function(t){window.productEstimator&&window.productEstimator.core&&"function"==typeof window.productEstimator.core.showMessage?window.productEstimator.core.showMessage(t,"success"):alert(t)}},{key:"updateCustomerEmail",value:function(t,e){var o=this;return new(N())((function(r,i){var s=Jt(Jt({},o._customerDetails||{}),{},{email:e});s.name||(s.name="Customer"),s.postcode||(s.postcode=""),o.log("Updating customer email with details:",s),o.log("Using estimate ID:",t,"Type:",l(t)),fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"update_customer_details",nonce:productEstimatorVars.nonce,details:at()(s)})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(e){if(e.success){o.log("Customer details updated successfully",e.data),o._customerDetails=e.data.details||s;var i=String(t);return o.log("Storing estimate with ID:",i),fetch(productEstimatorVars.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new(n())({action:"store_single_estimate",nonce:productEstimatorVars.nonce,estimate_id:i,customer_name:s.name||"Customer",customer_email:s.email,customer_phone:s.phone||"",customer_postcode:s.postcode||"",notes:""})}).then((function(t){if(!t.ok)throw new Error("Network response error: ".concat(t.status));return t.json()})).then((function(t){var e;if(o.log("Estimate stored with updated email response:",t),!t.success)throw new Error((null===(e=t.data)||void 0===e?void 0:e.message)||"Error storing estimate with updated email");r(o._customerDetails)}))}var a;throw new Error((null===(a=e.data)||void 0===a?void 0:a.message)||"Error updating customer details")})).catch((function(t){o.log("Error in updateCustomerEmail:",t),i(t)}))}))}},{key:"showEmailSentConfirmation",value:function(t){var e=this;window.productEstimator&&window.productEstimator.dialog?window.productEstimator.dialog.show({title:this.config.i18n.email_sent_title||"Estimate Sent",message:(this.config.i18n.email_sent_message||"Your estimate has been sent to {email}").replace("{email}",t),type:"success",confirmText:this.config.i18n.ok||"OK",cancelText:"",onConfirm:function(){e.log("Email sent confirmation acknowledged")}}):alert("Your estimate has been sent to "+t)}},{key:"log",value:function(){if(this.config.debug){for(var t,e,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];(t=console).log.apply(t,w()(e=["[PrintEstimate]"]).call(e,r))}}}])}();const Xt=Kt;function $t(){if(console.log("Product Estimator initialization check..."),window._productEstimatorInitialized)console.log("Product Estimator already initialized globally, aborting");else{if(window.productEstimator&&window.productEstimator.initialized)return console.log("Product Estimator initialized property found, aborting"),void(window._productEstimatorInitialized=!0);window._productEstimatorInitialized=!0,console.log("Product Estimator initializing for the first time...");try{Zt?console.log("Global event handlers already added, skipping"):(console.log("Setting up global event handlers..."),window._productEstimatorCloseHandler=function(t){if(t.target.closest(".product-estimator-modal-close")||t.target.classList.contains("product-estimator-modal-overlay")){console.log("Global close handler triggered");var e=document.querySelector("#product-estimator-modal");e&&(e.style.display="none",document.body.classList.remove("modal-open"),window.productEstimator&&window.productEstimator.core&&window.productEstimator.core.closeModal())}},document.removeEventListener("click",window._productEstimatorCloseHandler),document.addEventListener("click",window._productEstimatorCloseHandler),Zt=!0,console.log("Global event handlers added")),"undefined"!=typeof jQuery?(window.productEstimator=window.productEstimator||{},window.productEstimator.jQuery=jQuery):console.warn("jQuery not detected, some features may not work");var t=function(){var t=new(n())(window.location.search);if(t.has("product_estimator_debug")){var e="false"!==t.get("product_estimator_debug");return e?localStorage.setItem("product_estimator_debug","true"):localStorage.removeItem("product_estimator_debug"),e}return"true"===localStorage.getItem("product_estimator_debug")}();"complete"===document.readyState?e()((function(){return Yt(t)}),10):e()((function(){return Yt(t)}),500)}catch(t){console.error("Error in Product Estimator initialization:",t)}}}function Yt(t){try{if(window.productEstimator&&window.productEstimator.initialized)return void console.log("Product Estimator core already initialized, skipping");console.log("Initializing EstimatorCore..."),Bt.init({debug:t}),window.productEstimator=window.productEstimator||{},window.productEstimator.initialized=!0,window.productEstimator.core=Bt,window.productEstimator.dialog=kt;var o=new Xt({debug:t});window.productEstimator.printEstimate=o,window.productEstimator.detailsToggle=Wt,window.initSuggestionsCarousels=Ft,function(){try{document.addEventListener("click",(function(t){t.target.closest(".accordion-header")&&e()((function(){Wt&&"function"==typeof Wt.setup&&(console.log("Accordion clicked, reinitializing product details toggle"),Wt.setup()),Ft()}),300)})),document.body.addEventListener("click",(function(t){if(t.target.closest(".product-details-toggle")){var e=t.target.closest(".product-details-toggle"),o=e.closest(".product-item");if(!o)return;var r=e.classList.contains("expanded"),n=o.querySelector(".similar-products-container");if(!n)return;if(r){e.classList.remove("expanded"),n.style.display="none",n.classList.remove("visible");var i=e.querySelector(".toggle-icon");i&&(i.classList.remove("dashicons-arrow-up-alt2"),i.classList.add("dashicons-arrow-down-alt2"))}else{e.classList.add("expanded"),n.style.display="block",n.classList.add("visible");var s=e.querySelector(".toggle-icon");s&&(s.classList.remove("dashicons-arrow-down-alt2"),s.classList.add("dashicons-arrow-up-alt2")),Ft()}t.preventDefault(),t.stopPropagation()}if(t.target.closest(".product-notes-toggle")){var a=t.target.closest(".product-notes-toggle"),c=a.closest(".product-item");if(!c)return;var l=a.classList.contains("expanded"),u=c.querySelector(".notes-container");if(!u)return;if(l){a.classList.remove("expanded"),u.style.display="none",u.classList.remove("visible");var d=a.querySelector(".toggle-icon");d&&(d.classList.remove("dashicons-arrow-up-alt2"),d.classList.add("dashicons-arrow-down-alt2"))}else{a.classList.add("expanded"),u.style.display="block",u.classList.add("visible");var m=a.querySelector(".toggle-icon");m&&(m.classList.remove("dashicons-arrow-down-alt2"),m.classList.add("dashicons-arrow-up-alt2"))}t.preventDefault(),t.stopPropagation()}if(t.target.closest(".product-includes-toggle")){var h=t.target.closest(".product-includes-toggle"),f=h.closest(".product-item");if(!f)return;var p=h.classList.contains("expanded"),v=f.querySelector(".includes-container");if(!v)return;if(p){h.classList.remove("expanded"),v.style.display="none",v.classList.remove("visible");var g=h.querySelector(".toggle-icon");g&&(g.classList.remove("dashicons-arrow-up-alt2"),g.classList.add("dashicons-arrow-down-alt2"))}else{h.classList.add("expanded"),v.style.display="block",v.classList.add("visible");var y=h.querySelector(".toggle-icon");y&&(y.classList.remove("dashicons-arrow-down-alt2"),y.classList.add("dashicons-arrow-up-alt2"))}t.preventDefault(),t.stopPropagation()}if(t.target.closest(".product-suggestions-toggle")){var w=t.target.closest(".product-suggestions-toggle"),b=w.closest(".accordion-content");if(!b)return;var E=w.classList.contains("expanded"),S=b.querySelector(".suggestions-container");if(!S)return;if(E){w.classList.remove("expanded"),S.style.display="none",S.classList.remove("visible");var x=w.querySelector(".toggle-icon");x&&(x.classList.remove("dashicons-arrow-up-alt2"),x.classList.add("dashicons-arrow-down-alt2"))}else{w.classList.add("expanded"),S.style.display="block",S.classList.add("visible");var k=w.querySelector(".toggle-icon");k&&(k.classList.remove("dashicons-arrow-down-alt2"),k.classList.add("dashicons-arrow-up-alt2")),Ft()}t.preventDefault(),t.stopPropagation()}})),console.log("ProductDetailsToggle initialization complete")}catch(t){console.error("Error initializing ProductDetailsToggle:",t)}}(),console.log("Product Estimator initialized".concat(t?" (debug mode)":"")),document.dispatchEvent(new CustomEvent("product_estimator_initialized"))}catch(t){console.error("Error during EstimatorCore initialization:",t)}}window._productEstimatorInitialized=window._productEstimatorInitialized||!1,window._setupInitDone||(window._setupInitDone=!0,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",$t,{once:!0}):$t());var Zt=!1})()})();